

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11.8. 2017-09-23 nftables &mdash; South Bay WASP 1.0.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.2 documentation" href="../index.html"/>
        <link rel="up" title="11. Pentest Presentations" href="../pentest_presentations.html"/>
        <link rel="next" title="11.9. 2017-09-30 virtualization and bridges" href="20170930_presentation.html"/>
        <link rel="prev" title="11.7. 2017-09-16 “VPN”" href="20170916_presentation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mitm.html">11.1. MitM Presentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_headers.html">11.2. 2017-08-05 Attacking via HTTP Headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170812_presentation.html">11.3. 2017-08-12 VRT, cryptography, TLS 1.3, Broadpwn, cURL, and phishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170819_presentation.html">11.4. 2017-08-19 Forcing HTTPS, HTTP forwarding</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170826_presentation.html">11.5. 2017-08-26 Complexity, Cookies vs Tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170909_presentation.html">11.6. 2017-09-09 Adding IPv6 on the EdgeRouter Lite</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170916_presentation.html">11.7. 2017-09-16 “VPN”</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11.8. 2017-09-23 nftables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#links-and-updates-this-week">11.8.1. Links and updates this week</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">11.8.1.1. <strong class="program">nftables</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bash-complexity-and-ipv6-routing">11.8.1.2. <code class="docutils literal"><span class="pre">bash</span></code> complexity and IPv6 routing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#free-electrons">11.8.1.3. Free Electrons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">11.8.1.4. Lunix Audit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metasploit-unleashed-free-ethical-hacking-course">11.8.1.5. Metasploit Unleashed - Free Ethical Hacking Course</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complexity-links">11.8.1.6. Complexity links</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">11.8.1.7. Penetration Testing Execution Standard</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exploits-this-week">11.8.2. Exploits this week</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ccleanup">11.8.2.1. CCleanup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sec-s-edgar-breaches">11.8.2.2. SEC’s EDGAR breaches</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cve-2017-9798-optionsbleed">11.8.2.3. CVE-2017-9798 Optionsbleed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bashware">11.8.2.4. Bashware</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">11.8.2.5. Pytosquatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">11.8.2.6. BlueBorne</a></li>
<li class="toctree-l4"><a class="reference internal" href="#air-jumper">11.8.2.7. aIR-Jumper</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="20170930_presentation.html">11.9. 2017-09-30 virtualization and bridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171007_presentation.html">11.10. 2017-10-07 QEMU virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171014_presentation.html">11.11. 2017-10-14 Firewalls, building vulnerable hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171021_presentation.html">11.12. 2017-10-21 IPv6 addressing, KRACK, Infineon RSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171028_presentation.html">11.13. 2017-10-28 IPv6 ULA, DHCPv6, /64 prefixes, Bad Rabbit</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171104_presentation.html">11.14. 2017-11-04 Cloud providers other than AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171111_presentation.html">11.15. 2017-11-11 PKP removal, exploits galore</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171118_presentation.html">11.16. 2017-11-18 Privacy, safe languages, Linux networking</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_presentations.html">11. Pentest Presentations</a> &raquo;</li>
        
      <li>11.8. 2017-09-23 nftables</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/presentations/20170923_presentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nftables">
<h1>11.8. 2017-09-23 nftables<a class="headerlink" href="#nftables" title="Permalink to this headline">¶</a></h1>
<div class="section" id="links-and-updates-this-week">
<h2>11.8.1. Links and updates this week<a class="headerlink" href="#links-and-updates-this-week" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>11.8.1.1. <strong class="program">nftables</strong><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="../study/nftables.html#nftables"><span class="std std-ref">nftables</span></a>.</p>
</div>
<div class="section" id="bash-complexity-and-ipv6-routing">
<h3>11.8.1.2. <code class="docutils literal"><span class="pre">bash</span></code> complexity and IPv6 routing<a class="headerlink" href="#bash-complexity-and-ipv6-routing" title="Permalink to this headline">¶</a></h3>
<p>See added sections <a class="reference internal" href="../scripting/bash.html#bash-complexity"><span class="std std-ref">bash complexity</span></a> and <a class="reference internal" href="../study/ipv6.html#ipv6-routing"><span class="std std-ref">IPv6 “on-link” hosts based on RA prefixes, not subnet</span></a>.</p>
</div>
<div class="section" id="free-electrons">
<h3>11.8.1.3. Free Electrons<a class="headerlink" href="#free-electrons" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference external" href="http://free-electrons.com/docs/">Free Electrons Docs</a> for</p>
<blockquote>
<div>Free training materials and conference presentations from Free Electrons, covering kernel, real-time, Android, embedded Linux system and device driver development.</div></blockquote>
<p>You can also browse the Linux kernel source, e.g. <a class="reference external" href="http://elixir.free-electrons.com/linux/v4.13.3/source/include/net/netfilter">Free Electrons linux /include/net/netfilter</a> and <a class="reference external" href="http://elixir.free-electrons.com/linux/v4.13/source/net/netfilter">Free Electrons linux /net/netfilter</a>.</p>
</div>
<div class="section" id="id2">
<h3>11.8.1.4. <a class="reference external" href="https://linux-audit.com/">Lunix Audit</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Besides the <a class="reference external" href="https://linux-audit.com/nftables-beginners-guide-to-traffic-filtering/">Beginners Guide to nftables Traffic Filtering</a> they have <a class="reference external" href="https://linux-audit.com/linux-security/">Linux Security</a> and <a class="reference external" href="https://linux-audit.com/lynis/">Lynis</a> (their open source Linux, Mac OS X, and Unix system and security auditing tool).</p>
</div>
<div class="section" id="metasploit-unleashed-free-ethical-hacking-course">
<h3>11.8.1.5. Metasploit Unleashed - Free Ethical Hacking Course<a class="headerlink" href="#metasploit-unleashed-free-ethical-hacking-course" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference external" href="https://www.offensive-security.com/metasploit-unleashed/">Metasploit Unleashed - Free Ethical Hacking Course</a> (“we ask that you <strong>make a donation</strong> to the Hackers For Charity non-profit 501(c)(3) organization “).</p>
</div>
<div class="section" id="complexity-links">
<h3>11.8.1.6. Complexity links<a class="headerlink" href="#complexity-links" title="Permalink to this headline">¶</a></h3>
<p>In the past we’ve talked about complexity and bad design, especially <a class="reference internal" href="../study/php.html#php-mysql-shortcomings"><span class="std std-ref">PHP &amp; MySQL Shortcomings</span></a>. Note that the PHP language has changed over time, with <a class="reference external" href="http://php.net/supported-versions.php">php Supported Versions</a> showing the last PHP5 version is 5.6 with active support already ended 19 Jan 2017 and security support ending 31 Dec 2018.</p>
<p>Now we’ll add JavaScript to our complexity list:</p>
<ul>
<li><p class="first">PHP</p>
<p><a class="reference external" href="https://eev.ee/blog/2012/04/09/php-a-fractal-of-bad-design/">PHP: a fractal of bad design</a></p>
</li>
<li><p class="first">MySQL</p>
<p><a class="reference external" href="https://grimoire.ca/mysql/choose-something-else">Do Not Pass This Way Again</a></p>
</li>
<li><p class="first">JavaScript</p>
<p><a class="reference external" href="https://hackernoon.com/how-it-feels-to-learn-javascript-in-2016-d3a717dd577f">How it feels to learn JavaScript in 2016</a></p>
<p><a class="reference external" href="http://www.planningforaliens.com/blog/2016/04/11/why-js-development-is-crazy/">Why JavaScript Development is Crazy</a></p>
<p><a class="reference external" href="https://circleci.com/blog/its-the-future/">It’s The Future</a>.</p>
<p>Google <a class="reference external" href="https://www.google.com/search?q=javascript+fatigue">javascript fatigue</a>.</p>
<p>Also see <a class="reference external" href="https://github.com/verekia/js-stack-from-scratch">JavaScript Stack from Scratch</a>, <a class="reference external" href="https://www.quora.com/What-are-examples-of-a-full-stack-web-developer%E2%80%99s-stack">What are examples of a full stack web developer’s “stack”?</a>, comment starting with “Grunt &gt; Gulp &gt; Webpack …” in <a class="reference external" href="https://news.ycombinator.com/item?id=12823937">Hacker News | Step-by-step tutorial to build a modern JavaScript stack from scratch</a></p>
<p>On a more positive note see: <a class="reference external" href="https://www.infoq.com/articles/state-of-javascript-2016">State of the JavaScript Landscape: A Map for Newcomers</a>, <a class="reference external" href="http://reactkungfu.com/2015/07/the-hitchhikers-guide-to-modern-javascript-tooling/">The Hitchhiker’s Guide to Modern JavaScript Tooling</a>, and <a class="reference external" href="https://medium.com/javascript-and-opinions/state-of-the-art-javascript-in-2016-ab67fc68eb0b">State of the Art JavaScript in 2016</a>.</p>
</li>
</ul>
</div>
<div class="section" id="id4">
<h3>11.8.1.7. <a class="reference external" href="http://www.pentest-standard.org/">Penetration Testing Execution Standard</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="http://www.pentest-standard.org/index.php/FAQ">Penetration Testing Execution Standard - the FAQ</a>:</p>
<blockquote>
<div>It is a new standard designed to provide both businesses and security service providers with a common language and scope for performing penetration testing (i.e. Security evaluations). It started early in 2009 following a discussion that sparked between some of the founding members over the value (or lack of) of penetration testing in the industry.</div></blockquote>
<p>They also provide a <a class="reference external" href="http://iamit.org/docs/Penetration_Testing_Execution_Standard.mm">Penetration Testing Execution Standard - mindmap</a> (FreeMind) for the project.</p>
<p>There’s an alternative documentation format at <a class="reference external" href="http://pentest-standard.readthedocs.io/en/latest/">The Penetration Testing Execution Standard - Read the Docs</a>.</p>
</div>
</div>
<div class="section" id="exploits-this-week">
<h2>11.8.2. Exploits this week<a class="headerlink" href="#exploits-this-week" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ccleanup">
<h3>11.8.2.1. CCleanup<a class="headerlink" href="#ccleanup" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html">CCleanup: A Vast Number of Machines at Risk</a>:</p>
<blockquote>
<div><p>For a period of time, the legitimate signed version of CCleaner 5.33 being distributed by Avast also contained a multi-stage malware payload that rode on top of the installation of CCleaner. CCleaner boasted over 2 billion total downloads by November of 2016 with a growth rate of 5 million additional users per week.</p>
<p>…</p>
<p>During the installation of CCleaner 5.33, the 32-bit CCleaner binary that was included also contained a malicious payload that featured a Domain Generation Algorithm (DGA) as well as hardcoded Command and Control (C2) functionality. We confirmed that this malicious version of CCleaner was being hosted directly on CCleaner’s download server as recently as September 11, 2017.</p>
<p>…</p>
<p>In reviewing the Version History page on the CCleaner download site, it appears that the affected version (5.33) was released on August 15, 2017. On September 12, 2017 version 5.34 was released. The version containing the malicious payload (5.33) was being distributed between these dates.</p>
<p>…</p>
<p>Given the presence of this compilation artifact as well as the fact that the binary was digitally signed using a valid certificate issued to the software developer, it is likely that an external attacker compromised a portion of their development or build environment and leveraged that access to insert malware into the CCleaner build that was released and hosted by the organization. It is also possible that an insider with access to either the development or build environments within the organization intentionally included the malicious code or could have had an account (or similar) compromised which allowed an attacker to include the code.</p>
</div></blockquote>
<p>The article goes into detail on how the malware operates. From a follow-up article <a class="reference external" href="http://blog.talosintelligence.com/2017/09/ccleaner-c2-concern.html">CCleaner Command and Control Causes Concern</a>:</p>
<blockquote>
<div><p>In analyzing the delivery code from the C2 server, what immediately stands out is a list of organizations, including Cisco, that were specifically targeted through delivery of a second-stage loader. Based on a review of the C2 tracking database, which only covers four days in September, we can confirm that at least 20 victim machines were served specialized secondary payloads. Below is a list of domains the attackers were attempting to target.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">$DomainList</span> <span class="o">=</span> <span class="nx">array</span><span class="p">(</span>
<span class="s2">&quot;singtel.corp.root&quot;</span><span class="p">,</span>
<span class="s2">&quot;htcgroup.corp&quot;</span><span class="p">,</span>
<span class="s2">&quot;samsung-breda&quot;</span><span class="p">,</span>
<span class="s2">&quot;Samsung&quot;</span><span class="p">,</span>
<span class="s2">&quot;SAMSUNG.SEPM&quot;</span><span class="p">,</span>
<span class="s2">&quot;samsung.sk&quot;</span><span class="p">,</span>
<span class="s2">&quot;jp.sony.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;am.sony.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;gg.gauselmann.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;vmware.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;ger.corp.intel.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;amr.corp.intel.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;ntdev.corp.microsoft.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;cisco.com&quot;</span><span class="p">,</span>

<span class="s2">&quot;uk.pri.o2.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;vf-es.internal.vodafone.com&quot;</span><span class="p">,</span>

<span class="s2">&quot;linksys&quot;</span><span class="p">,</span>
<span class="s2">&quot;apo.epson.net&quot;</span><span class="p">,</span>
<span class="s2">&quot;msi.com.tw&quot;</span><span class="p">,</span>
<span class="s2">&quot;infoview2u.dvrdns.org&quot;</span><span class="p">,</span>
<span class="s2">&quot;dfw01.corp.akamai.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;hq.gmail.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;dlink.com&quot;</span><span class="p">,</span>

<span class="s2">&quot;test.com&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>The article contains more information about the CC server.</p>
</div>
<div class="section" id="sec-s-edgar-breaches">
<h3>11.8.2.2. SEC’s EDGAR breaches<a class="headerlink" href="#sec-s-edgar-breaches" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/EDGAR">EDGAR</a> “the <strong>Electronic Data Gathering, Analysis, and Retrieval</strong> system, performs automated collection, validation, indexing, acceptance, and forwarding of submissions by companies and others who are required by law to file forms with the <a class="reference external" href="https://en.wikipedia.org/wiki/U.S._Securities_and_Exchange_Commission">U.S. Securities and Exchange Commission</a> (the “SEC”). The database is freely available to the public via the Internet (HTTPS).”</p>
<p><a class="reference external" href="https://www.sec.gov/news/public-statement/statement-clayton-2017-09-20">U.S. Securities and Exchange Commission - Public Statement - Statement on Cybersecurity</a> Section <em>I. Collection and Use of Data by the Commision</em> identified the category of data:</p>
<blockquote>
<div><p>The first category of data includes public-facing data that is transmitted to and accessed through Commission systems. … In 2017, on a typical day, investors and other market participants access more than 50 million pages of disclosure documents through the EDGAR system, which receives and processes over 1.7 million electronic filings per year.</p>
<p>…</p>
<p>The second category of data the Commission receives, stores and transmits includes nonpublic information, including personally identifiable information, generally related to our supervisory and enforcement functions.</p>
<p>…</p>
<p>The third category of data includes nonpublic data, including personally identifiable information, related to the Commission’s internal operations.</p>
</div></blockquote>
<p><a class="reference external" href="https://www.sec.gov/news/public-statement/statement-clayton-2017-09-20">U.S. Securities and Exchange Commission - Public Statement - Statement on Cybersecurity</a> Section <em>II. Management of Internal Cybersecurity Risks</em> identified several security breaches:</p>
<blockquote>
<div><p>In August 2017, the Commission learned that an incident previously detected in 2016 may have provided the basis for illicit gain through trading.  Specifically, a software vulnerability in the test filing component of our EDGAR system, which was patched promptly after discovery, was exploited and resulted in access to nonpublic information.  We believe the intrusion did not result in unauthorized access to personally identifiable information, jeopardize the operations of the Commission, or result in systemic risk.  Our investigation of this matter is ongoing, however, and we are coordinating with appropriate authorities.  As another example, our Division of Enforcement has investigated and filed cases against individuals who we allege placed fake SEC filings on our EDGAR system in an effort to profit from the resulting market movements.[<a class="reference external" href="https://www.sec.gov/news/press-release/2017-107">3</a>]</p>
<p>… a 2014 internal review by the SEC’s Office of Inspector General (“OIG”), an independent office within the agency, found that certain SEC laptops that may have contained nonpublic information could not be located.[<a class="reference external" href="https://www.sec.gov/files/524.pdf">4</a>]  The OIG also has found instances in which SEC personnel have transmitted nonpublic information through non-secure personal email accounts.[<a class="reference external" href="https://www.sec.gov/files/Inspector%20General%27s%20Statement%20on%20the%20SEC%27s%20Management%20and%20Performance%20Challenges.pdf">5</a>]  We seek to mitigate this risk by requiring all personnel to complete privacy and security training and we have other relevant risk mitigation controls in place.</p>
</div></blockquote>
</div>
<div class="section" id="cve-2017-9798-optionsbleed">
<h3>11.8.2.3. <a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-9798">CVE-2017-9798</a> Optionsbleed<a class="headerlink" href="#cve-2017-9798-optionsbleed" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html">Optionsbleed - HTTP OPTIONS method can leak Apache’s server memory</a>:</p>
<blockquote>
<div><p><strong>What’s Optionsbleed?</strong></p>
<p>Optionsbleed is a use after free error in Apache HTTP that causes a corrupted Allow header to be constructed in response to HTTP OPTIONS requests. This can leak pieces of arbitrary memory from the server process that may contain secrets. The memory pieces change after multiple requests, so for a vulnerable host an arbitrary number of memory chunks can be leaked.</p>
<p>The bug appears if a webmaster tries to use the “Limit” directive with an invalid HTTP method.</p>
<p>Example .htaccess:</p>
<div class="highlight-apacheconf"><div class="highlight"><pre><span></span><span class="nt">&lt;Limit</span> <span class="s">abcxyz</span><span class="nt">&gt;</span>
<span class="nt">&lt;/Limit&gt;</span>
</pre></div>
</div>
<p><strong>Is this as bad as Heartbleed?</strong></p>
<p>No. Although similar in nature, this bug leaks only small chunks of memory and more importantly only affects a small number of hosts by default.</p>
<p>It’s still a pretty bad bug, particularly for shared hosting environments.</p>
</div></blockquote>
<p>See <a class="reference external" href="https://github.com/hannob/optionsbleed">hannob/optionsbleed</a> for a POC.</p>
</div>
<div class="section" id="bashware">
<h3>11.8.2.4. Bashware<a class="headerlink" href="#bashware" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://research.checkpoint.com/beware-bashware-new-method-malware-bypass-security-solutions/">Beware of the Bashware: A New Method for Any Malware to Bypass Security Solutions</a>:</p>
<blockquote>
<div>Bashware is a generic and cross platform technique that uses WSL in order to allow running both ELF an EXE malicious payloads in a stealthy manner that could bypass most current security solutions.</div></blockquote>
<p>Bashware has 4 steps:</p>
<ol class="arabic">
<li><p class="first">Load WSL (Windows Subsystem for Linux)</p>
</li>
<li><p class="first">Enable developer mode (needs local admin)</p>
</li>
<li><p class="first">Install Linux via <code class="docutils literal"><span class="pre">Lxrun</span> <span class="pre">/install</span></code>.</p>
</li>
<li><p class="first">Run <code class="docutils literal"><span class="pre">wine</span></code>.</p>
<p>This is exactly what we needed in order to make a Windows malware run from the WSL environment, turning it invisible as well. Bashware uses the Winehq project capabilities and installs a pre-optimized wine project into the WSL Linux environment.</p>
</li>
</ol>
<blockquote>
<div><p>Next, EXE formats need to be converted by Wine, turning its NT syscalls to POSIX syscalls. Later on, the Pico provider (lxcore.sys) will convert these POSIX syscalls back to NT syscalls, turning lxcore to the actual caller of this process. This way, a file running on the Windows OS can execute any known malicious payload from the Linux OS, where it remains hidden from most security products.</p>
<p>Bashware does not leverate any logic or implementation flaws in WSL’s design. In fact, WSL seems to be well designed. What allows Bashware to operate the way it does is the lack of awareness by various security vendors, due to the fact that this technology is relatively new and expands the known borders of the Windows operating system.</p>
</div></blockquote>
</div>
<div class="section" id="id9">
<h3>11.8.2.5. <a class="reference external" href="https://www.pytosquatting.org/">Pytosquatting</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Anyone can upload packages to <a class="reference external" href="https://pypi.python.org/pypi">PyPI</a>. While packages can be signed with the uploader’s GPG key (or not - see <a class="reference external" href="https://pypi.python.org/security">PyPI Security</a>), that key is not guaranteed to represent any additional security (without a web of trust to validate that key).</p>
<p>Pytosquating includes two types of uploaded packages:</p>
<dl class="docutils">
<dt>typosquatting</dt>
<dd>Upload packages representing misspellings of common packages.</dd>
<dt>namesquatting</dt>
<dd>Upload packages representing packages included in Python (stdlib).</dd>
</dl>
<p>A fix to this problem is being considered. (See the quoted response at the bottom of <a class="reference external" href="https://arstechnica.com/information-technology/2017/09/devs-unknowingly-use-malicious-modules-put-into-official-python-repository/">Devs unknowingly use “malicious” modules snuck into official Python repository</a>).</p>
</div>
<div class="section" id="id10">
<h3>11.8.2.6. <a class="reference external" href="http://go.armis.com/hubfs/BlueBorne%20Technical%20White%20Paper.pdf">BlueBorne</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>BlueBorne resulted in 8 CVE’s:</p>
<ol class="arabic simple">
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-0781">CVE-2017-0781</a> - Android RCE</li>
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-0782">CVE-2017-0782</a> - Android RCE</li>
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-0783">CVE-2017-0783</a> - Android info disclosure</li>
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-0785">CVE-2017-0785</a> - Android info disclosure</li>
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-8628">CVE-2017-8628</a> - MS Bluetooth Driver spoofing</li>
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-14315">CVE-2017-14315</a> - iOS 7-9 heap overflow</li>
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-1000250">CVE-2017-1000250</a> - Linux info disclosure</li>
<li><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-1000251">CVE-2017-1000251</a> - Linux kernel RCE</li>
</ol>
<p>From <a class="reference external" href="http://go.armis.com/hubfs/BlueBorne%20Technical%20White%20Paper.pdf">BlueBorne</a>:</p>
<blockquote>
<div><p>Bluetooth is complicated. Too complicated. … Just to illustrate this point: while the WiFi specification (802.11) is only 450 pages long, the Bluetooth specification reaches 2822 pages.</p>
<p>Bluetooth’s complexity kept researchers from auditing its implementations at the same level of scrutiny that other highly exposed protocols, and outward-facing interfaces have been treated with.</p>
</div></blockquote>
<p>The article contains detailed code analysis worthy of further study.</p>
<p>From <a class="reference external" href="https://arstechnica.com/information-technology/2017/09/bluetooth-bugs-open-billions-of-devices-to-attacks-no-clicking-required/">Billions of devices imperiled by new clickless Bluetooth attack</a>:</p>
<blockquote>
<div>Virtually any Android, Linux, or Windows device that hasn’t been recently patched and has Bluetooth turned on can be compromised by an attacking device within 32 feet. It doesn’t require device users to click on any links, connect to a rogue Bluetooth device, or take any other action, short of leaving Bluetooth on. The exploit process is generally very fast, requiring no more than 10 seconds to complete, and it works even when the targeted device is already connected to another Bluetooth-enabled device.</div></blockquote>
<p>The Ars Technica article also references 3 attack videos.</p>
</div>
<div class="section" id="air-jumper">
<h3>11.8.2.7. aIR-Jumper<a class="headerlink" href="#air-jumper" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://arxiv.org/pdf/1709.05742.pdf">aIR-Jumper: Covert Air-Gap Exfiltration/Infiltration via Security Cameras &amp; Infrared (IR)</a>:</p>
<blockquote>
<div>In this paper, we show how attackers can use surveillance cameras and infrared light to establish bi-directional covert communication between the internal networks of organizations and remote attackers. We present two scenarios: exfiltration (leaking data out of the network) and infiltration (sending data into the network).</div></blockquote>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="20170930_presentation.html" class="btn btn-neutral float-right" title="11.9. 2017-09-30 virtualization and bridges" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="20170916_presentation.html" class="btn btn-neutral" title="11.7. 2017-09-16 “VPN”" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>