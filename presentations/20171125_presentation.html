

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11.30. 2017-11-25 Not getting hacked, keystrokes, tracking, Fancy Bear, Intel ME &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11.31. 2017-11-18 Privacy, safe languages, Linux networking" href="20171118_presentation.html" />
    <link rel="prev" title="11.29. 2017-12-02 Static websites, IME follow-up" href="20171202_presentation.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="20180630_presentation.html">11.1. 2018-06-30 Links, home routers, PentesterLab SQLi</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180623_presentation.html">11.2. 2018-06-23 Links, PentesterLab, AWS EC2</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180616_presentation.html">11.3. 2018-06-16 Links, VMs/Containers, and AES/SHA</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180609_presentation.html">11.4. 2018-06-09 Links, VMs/Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180602_presentation.html">11.5. 2018-06-02 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180526_presentation.html">11.6. 2018-05-26 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180519_presentation.html">11.7. 2018-05-19 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180512_presentation.html">11.8. 2018-05-12 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180505_presentation.html">11.9. 2018-05-05 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180428_presentation.html">11.10. 2018-04-28 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180421_presentation.html">11.11. 2018-04-21 Links, 2FA, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180414_presentation.html">11.12. 2018-04-14 Links and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180407_presentation.html">11.13. 2018-04-07 Links, nmap, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180331_presentation.html">11.14. 2018-03-31 Links, TLS 1.3, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180303_presentation.html">11.15. 2018-03-03 Links, Cloud VMs, OpenSSL, Metasploit Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180224_presentation.html">11.16. 2018-02-24 Links, Cloud VMs, Let’s Encrypt, Metasploit Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180217_presentation.html">11.17. 2018-02-17 Links, Web frontend, and Malware C2</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180210_presentation.html">11.18. 2018-02-10 Links, memory issues, and WAF</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180203_presentation.html">11.19. 2018-02-03 Links and more ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180127_presentation.html">11.20. 2018-01-27 Links and ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180120_presentation.html">11.21. 2018-01-20 Links and yet more Meltdown/Spectre</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180113_presentation.html">11.22. 2018-01-13 Links and more Meltdown/Spectre</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170812_presentation.html">11.23. 2017-08-12 VRT, cryptography, TLS 1.3, Broadpwn, cURL, and phishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180106_presentation.html">11.24. 2018-01-06 Invisibly fingerprinting text, Samsung no-SOP, Meltdown/Spectre</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171230_presentation.html">11.25. 2017-12-30 gohttp, hardening C/C++, Linux waitid() exploit</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171223_presentation.html">11.26. 2017-12-23 Haven, Observatory, and Janus</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171216_presentation.html">11.27. 2017-12-16 Mozilla Observatory</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171209_presentation.html">11.28. 2017-12-09 Phone tracking, AWS leaks, macOS root, exim</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171202_presentation.html">11.29. 2017-12-02 Static websites, IME follow-up</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11.30. 2017-11-25 Not getting hacked, keystrokes, tracking, Fancy Bear, Intel ME</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#links-and-updates-this-week">11.30.1. Links and updates this week</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#not-getting-hacked">11.30.1.1. Not getting hacked</a></li>
<li class="toctree-l4"><a class="reference internal" href="#websites-record-your-keystrokes">11.30.1.2. Websites record your keystrokes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#google-tracking-user-location">11.30.1.3. Google tracking user location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#replacing-x86-firmware-with-linux-and-go">11.30.1.4. Replacing x86 firmware with Linux and Go</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exploits-this-week">11.30.2. Exploits this week</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fancy-bear-and-ms-word-dde">11.30.2.1. Fancy Bear and MS Word DDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#intel-management-engine-me-exploits">11.30.2.2. Intel Management Engine (ME) exploits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="20171118_presentation.html">11.31. 2017-11-18 Privacy, safe languages, Linux networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171111_presentation.html">11.32. 2017-11-11 PKP removal, exploits galore</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171104_presentation.html">11.33. 2017-11-04 Cloud providers other than AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171028_presentation.html">11.34. 2017-10-28 IPv6 ULA, DHCPv6, /64 prefixes, Bad Rabbit</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171021_presentation.html">11.35. 2017-10-21 IPv6 addressing, KRACK, Infineon RSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171014_presentation.html">11.36. 2017-10-14 Firewalls, building vulnerable hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171007_presentation.html">11.37. 2017-10-07 QEMU virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170930_presentation.html">11.38. 2017-09-30 virtualization and bridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170923_presentation.html">11.39. 2017-09-23 nftables</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170916_presentation.html">11.40. 2017-09-16 “VPN”</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170909_presentation.html">11.41. 2017-09-09 Adding IPv6 on the EdgeRouter Lite</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170826_presentation.html">11.42. 2017-08-26 Complexity, Cookies vs Tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170819_presentation.html">11.43. 2017-08-19 Forcing HTTPS, HTTP forwarding</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_headers.html">11.44. 2017-08-05 Attacking via HTTP Headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="mitm.html">11.45. MitM Presentation</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_presentations.html">11. Pentest Presentations</a> &raquo;</li>
        
      <li>11.30. 2017-11-25 Not getting hacked, keystrokes, tracking, Fancy Bear, Intel ME</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/presentations/20171125_presentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="not-getting-hacked-keystrokes-tracking-fancy-bear-intel-me">
<h1>11.30. 2017-11-25 Not getting hacked, keystrokes, tracking, Fancy Bear, Intel ME<a class="headerlink" href="#not-getting-hacked-keystrokes-tracking-fancy-bear-intel-me" title="Permalink to this headline">¶</a></h1>
<div class="section" id="links-and-updates-this-week">
<h2>11.30.1. Links and updates this week<a class="headerlink" href="#links-and-updates-this-week" title="Permalink to this headline">¶</a></h2>
<div class="section" id="not-getting-hacked">
<h3>11.30.1.1. Not getting hacked<a class="headerlink" href="#not-getting-hacked" title="Permalink to this headline">¶</a></h3>
<p>The section <a class="reference internal" href="../study/not_getting_hacked.html#not-getting-hacked"><span class="std std-ref">Not getting hacked</span></a> has been added.</p>
</div>
<div class="section" id="websites-record-your-keystrokes">
<h3>11.30.1.2. Websites record your keystrokes<a class="headerlink" href="#websites-record-your-keystrokes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="princeton-s-web-transparency-accountability-project">
<h4>11.30.1.2.1. Princeton’s Web Transparency &amp; Accountability Project<a class="headerlink" href="#princeton-s-web-transparency-accountability-project" title="Permalink to this headline">¶</a></h4>
<p>From the <a class="reference external" href="https://webtap.princeton.edu/">Princeton Web Transparency &amp; Accountability Project</a>:</p>
<blockquote>
<div><p><strong>Measure Threats</strong></p>
<p>We monitor websites and services to find out what user data companies collect, how they collect it, and what they do with it.</p>
<p><strong>Create Change</strong></p>
<p>Our external oversight exposes the privacy practices of companies and forces them to make improvements.</p>
<p><strong>Inform the Public</strong></p>
<p>We translate our research into practical information for public consumption.</p>
</div></blockquote>
<p>See these links:</p>
<ul class="simple">
<li><a class="reference external" href="https://webtransparency.cs.princeton.edu/webcensus/#">Princeton Web Census</a><ul>
<li><a class="reference external" href="http://randomwalker.info/publications/OpenWPM_1_million_site_tracking_measurement.pdf">Online Tracking: A 1-million-site Measurement and Analysis</a></li>
<li><a class="reference external" href="https://github.com/citp/OpenWPM">citp/OpenWPM</a></li>
</ul>
</li>
<li><a class="reference external" href="https://securehomes.esat.kuleuven.be/~gacar/persistent/index.html">The Web Never Forgets</a>.</li>
</ul>
</div>
<div class="section" id="no-boundaries-exfiltration-of-personal-data-by-session-replay-scripts">
<h4>11.30.1.2.2. No boundaries: Exfiltration of personal data by session-replay scripts<a class="headerlink" href="#no-boundaries-exfiltration-of-personal-data-by-session-replay-scripts" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://freedom-to-tinker.com/2017/11/15/no-boundaries-exfiltration-of-personal-data-by-session-replay-scripts/">No boundaries: Exfiltration of personal data by session-replay scripts</a>:</p>
<blockquote>
<div><p>This is the first post in our “No Boundaries” series, in which we reveal how third-party scripts on websites have been extracting personal information in increasingly intrusive ways.</p>
<p><strong>Update</strong>: we’ve released our <a class="reference external" href="https://webtransparency.cs.princeton.edu/no_boundaries/session_replay_sites.html">data</a> — the list of sites with session-replay scripts, and the sites where we’ve confirmed recording by third parties.</p>
<p>You may know that most websites have third-party analytics scripts that record which pages you visit and the searches you make.  But lately, more and more sites use “session replay” scripts. These scripts record your keystrokes, mouse movements, and scrolling behavior, along with the entire contents of the pages you visit, and send them to third-party servers. Unlike typical analytics services that provide aggregate statistics, these scripts are intended for the recording and playback of individual browsing sessions, as if someone is looking over your shoulder.</p>
<p>The stated purpose of this data collection includes gathering insights into how users interact with websites and discovering broken or confusing pages. However the extent of data collected by these services far exceeds user expectations [1]; text typed into forms is collected before the user submits the form, and precise mouse movements are saved, all without any visual indication to the user. This data can’t reasonably be expected to be kept anonymous. In fact, some companies allow publishers to <a class="reference external" href="https://web.archive.org/web/20170623160320/http://help.fullstory.com/develop-js/identify">explicitly</a> <a class="reference external" href="https://web.archive.org/web/20171114004942/https://www.smartlook.com/docs/identify-visitors">link</a> recordings to a user’s real identity.</p>
<p><strong>What can go wrong?</strong> In short, a lot.</p>
<p>Collection of page content by third-party replay scripts may cause sensitive information such as medical conditions, credit card details and other personal information displayed on a page to leak to the third-party as part of the recording. This may expose users to identity theft, online scams, and other unwanted behavior. The same is true for the collection of user inputs during checkout and registration processes.</p>
<p>The replay services offer a combination of manual and automatic redaction tools that allow publishers to exclude sensitive information from recordings. However, in order for leaks to be avoided, publishers would need to diligently check and scrub all pages which display or accept user information. For dynamically generated sites, this process would involve inspecting the underlying web application’s server-side code. Further, this process would need to be repeated every time a site is updated or the web application that powers the site is changed.</p>
<p>From the results of these tests, as well as an analysis of a number of live sites, we highlight four types of vulnerabilities below:</p>
<ol class="arabic simple">
<li><strong>Passwords are included in session recordings.</strong></li>
<li><strong>Sensitive user inputs are redacted in a partial and imperfect way.</strong></li>
<li><strong>Manual redaction of personally identifying information displayed on a page is a fundamentally insecure model.</strong></li>
<li><strong>Recording services may fail to protect user data.</strong></li>
</ol>
</div></blockquote>
<p>For a summary see <a class="reference external" href="https://arstechnica.com/tech-policy/2017/11/an-alarming-number-of-sites-employ-privacy-invading-session-replay-scripts/">No, you’re not being paranoid. Sites really are watching your every move</a>, <a class="reference external" href="https://motherboard.vice.com/en_us/article/59yexk/princeton-study-session-replay-scripts-tracking-you">Over 400 of the World’s Most Popular Websites Record Your Every Keystroke, Princeton Researchers Find</a>, and <a class="reference external" href="https://www.wired.com/story/the-dark-side-of-replay-sessions-that-record-your-every-move-online/">The Dark Side of ‘Replay Sessions’ That Record Your Every Move Online</a>.</p>
</div>
</div>
<div class="section" id="google-tracking-user-location">
<h3>11.30.1.3. Google tracking user location<a class="headerlink" href="#google-tracking-user-location" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://qz.com/1131515/google-collects-android-users-locations-even-when-location-services-are-disabled/">Google collects Android users’ locations even when location services are disabled</a>:</p>
<blockquote>
<div><p>Many people realize that smartphones track their locations. But what if you actively turn off location services, haven’t used any apps, and haven’t even inserted a carrier SIM card?</p>
<p>Even if you take all of those precautions, phones running Android software gather data about your location and send it back to Google when they’re connected to the internet, a Quartz investigation has revealed.</p>
<p>Since the beginning of 2017, Android phones have been collecting the addresses of nearby cellular towers—even when location services are disabled—and sending that data back to Google. The result is that Google, the unit of Alphabet behind Android, has access to data about individuals’ locations and their movements that go far beyond a reasonable consumer expectation of privacy.</p>
<p>The cell tower addresses have been included in information sent to the system Google uses to manage push notifications and messages on Android phones for the past 11 months, according to a Google spokesperson. They were never used or stored, the spokesperson said, and the company is now taking steps to end the practice after being contacted by Quartz. By the end of November, the company said, Android phones will no longer send cell-tower location data to Google, at least as part of this particular service, which consumers cannot disable.</p>
<p>“It is really a mystery as to why this is not optional,” said Matthew Hickey, a security expert and researcher at Hacker House, a security firm based in London. “It seems quite intrusive for Google to be collecting such information that is only relevant to carrier networks when there are no SIM card or enabled services.”</p>
<p>While Google says it doesn’t use the location data it collects using this service, its does allow advertisers to target consumers using location data, an approach that has obvious commercial value. The company can tell using precise location tracking, for example, whether an individual with an Android phone or running Google apps has set foot in a specific store, and use that to <a class="reference external" href="https://support.google.com/adwords/answer/2453995?hl=en">target the advertising</a> a user subsequently sees.</p>
</div></blockquote>
<p>Also see <a class="reference external" href="http://money.cnn.com/2017/11/24/technology/google-location-data-regulators/index.html">Regulators question Google over location data</a>.</p>
</div>
<div class="section" id="replacing-x86-firmware-with-linux-and-go">
<h3>11.30.1.4. Replacing x86 firmware with Linux and Go<a class="headerlink" href="#replacing-x86-firmware-with-linux-and-go" title="Permalink to this headline">¶</a></h3>
<p>The Youtube video <a class="reference external" href="https://www.youtube.com/watch?v=iffTJ1vPCSo">Replace Your Exploit-Ridden Firmware with Linux - Ronald Minnich, Google</a> and the presentation <a class="reference external" href="https://schd.ws/hosted_files/osseu17/84/Replace%20UEFI%20with%20Linux.pdf">Replace your exploit-ridden firmware with a Linux kernel</a> are discussed in the article <a class="reference external" href="https://lwn.net/SubscriberLink/738649/81007748bf15c1e5/">Replacing x86 firmware with Linux and Go</a>:</p>
<blockquote>
<div>The <a class="reference external" href="https://en.wikipedia.org/wiki/Intel_Management_Engine">Intel Management Engine</a> (ME), which is a separate processor and operating system running outside of user control on most x86 systems, has long been of concern to users who are security and privacy conscious. Google and others have been working on ways to eliminate as much of that functionality as possible (while still being able to boot and run the system). Ronald Minnich from Google came to Prague to talk about those efforts at the 2017 Embedded Linux Conference Europe.</div></blockquote>
<p>This becomes important when considering the recent security problems associated with the IME.</p>
</div>
</div>
<div class="section" id="exploits-this-week">
<h2>11.30.2. Exploits this week<a class="headerlink" href="#exploits-this-week" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fancy-bear-and-ms-word-dde">
<h3>11.30.2.1. Fancy Bear and MS Word DDE<a class="headerlink" href="#fancy-bear-and-ms-word-dde" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://securingtomorrow.mcafee.com/mcafee-labs/apt28-threat-group-adopts-dde-technique-nyc-attack-theme-in-latest-campaign/">Threat Group APT28 Slips Office Malware into Doc Citing NYC Terror Attack</a>:</p>
<blockquote>
<div><p>McAfee Advanced Threat Research analysts identified a malicious Word document that appears to leverage the Microsoft Office Dynamic Data Exchange (DDE) technique that has been previously reported by Advanced Threat Research. … The use of DDE with PowerShell allows an attacker to execute arbitrary code on a victim’s system regardless whether macros are enabled.</p>
<p>…</p>
<p>The document itself is blank. Once opened, the document contacts a control server to drop the first stage of the malware, Seduploader, onto a victim’s system.</p>
<p>…</p>
<p>The document we examined for this post:</p>
<ul class="simple">
<li>Filename: IsisAttackInNewYork.docx</li>
</ul>
</div></blockquote>
<p>This exploit is based on <a class="reference external" href="https://sensepost.com/blog/2017/macro-less-code-exec-in-msword/">Macro-less Code Exec in MSWord</a>:</p>
<blockquote>
<div>Windows provides several methods for transferring data between applications. One method is to use the Dynamic Data Exchange (DDE) protocol. The DDE protocol is a set of messages and guidelines. It sends messages between applications that share data and uses shared memory to exchange data between applications. Applications can use the DDE protocol for one-time data transfers and for continuous exchanges in which applications send updates to one another as new data becomes available.</div></blockquote>
</div>
<div class="section" id="intel-management-engine-me-exploits">
<h3>11.30.2.2. Intel Management Engine (ME) exploits<a class="headerlink" href="#intel-management-engine-me-exploits" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-is-ime">
<h4>11.30.2.2.1. What is IME?<a class="headerlink" href="#what-is-ime" title="Permalink to this headline">¶</a></h4>
<p>The Intel ME is the gift that keeps on giving security exploits.</p>
<p>For some background on the Intel Management Engine see:</p>
<ul class="simple">
<li><a class="reference external" href="https://www.symantec.com/connect/articles/why-must-intel-amt-be-configured-and-what-required">Why Must Intel AMT Be Configured, and What is Required?</a></li>
<li>Links in <a class="reference external" href="https://www.ssh.com/vulnerability/intel-amt/#sec-More-Technical-Background">More Technical Background</a></li>
<li><a class="reference external" href="https://www.troopers.de/downloads/troopers17/TR17_ME11_Static.pdf">Intel ME: The Way of the Static Analysis</a></li>
<li><a class="reference external" href="https://security.stackexchange.com/questions/128619/what-are-the-privacy-and-security-risks-associated-with-intels-management-engin#">What are the privacy and security risks associated with Intel’s Management Engine and AMD’s Platform Security Processor?</a></li>
<li><a class="reference external" href="https://hardenedlinux.github.io/firmware/2016/11/17/neutralize_ME_firmware_on_sandybridge_and_ivybridge.html">Neutralize ME firmware on SandyBridge and IvyBridge platforms</a></li>
<li><a class="reference external" href="https://github.com/ptresearch/me-disablement/blob/master/How%20to%20become%20the%20sole%20owner%20of%20your%20PC.pdf">How to become the sole owner of your PC</a></li>
<li><a class="reference external" href="https://archive.org/details/33C3-Tapping_into_the_core">33C3: Tapping into the core</a>.</li>
</ul>
</div>
<div class="section" id="silent-bob-is-silent-vulnerability-or-backdoor">
<h4>11.30.2.2.2. Silent Bob is Silent - vulnerability or backdoor<a class="headerlink" href="#silent-bob-is-silent-vulnerability-or-backdoor" title="Permalink to this headline">¶</a></h4>
<p>See <a class="reference external" href="https://www.ssh.com/vulnerability/intel-amt/">Intel AMT Vulnerability Tracking Page</a> for a great overview of the IME exploit. The section <a class="reference external" href="https://www.ssh.com/vulnerability/intel-amt/#sec-Details-of-the-Exploit-Now-called-q-Silent-Bob-is-Silent-q">Slient Bob is Silent</a> references the <a class="reference external" href="https://embedi.com/files/white-papers/Silent-Bob-is-Silent.pdf">Embedi white paper on the Intel AMT Vulnerability Exploitation detail</a> which describes the exploit using an <em>empty</em> password (justifying the CVSS v2 Base Score of 10.0 HIGH). From the section <a class="reference external" href="https://www.ssh.com/vulnerability/intel-amt/#sec-Vulnerability-or-Backdoor">Vulnerability or Backdoor</a>:</p>
<blockquote>
<div><p>One is left wondering if Intel only released the vulnerability now because it had leaked and port scans for it had escalated in a way that forced its hand. This kind of vulnerability is extremely valuable for intelligence and cyberwarfare operations, and various conspiracy theories abound. In any case, if it is true that Intel has known of the vulnerability for years, then it can only be considered <strong>an intentional backdoor</strong>.</p>
<p>This is exactly the kind of vulnerability one could imagine intelligence agencies trying to push vendors to leave in their code. In any case, we may see immeasurable damanage as malware starts utilizing this on a large scale on internal networks.</p>
</div></blockquote>
<p>Intel provided the <a class="reference external" href="https://downloadcenter.intel.com/download/26755">INTEL-SA-00075 Detection and Mitigation Tool</a> to fix the issue with <a class="reference external" href="https://downloadcenter.intel.com/product/23549/Intel-Active-Management-Technology-Intel-AMT-">Intel® Active Management Technology (Intel® AMT)</a> and <a class="reference external" href="https://downloadcenter.intel.com/product/66622/Intel-Small-Business-Advantage">Intel® Small Business Advantage</a>. The corresponding CVE is <a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-5689">CVE-2017-5689</a>.</p>
<p>Also see <a class="reference external" href="https://mattermedia.com/blog/disabling-intel-amt/">Disabling Intel AMT on Windows (and a simpler CVE-2017-5689 Mitigation Guide)</a>.</p>
</div>
<div class="section" id="ime-secret-kill-switch">
<h4>11.30.2.2.3. IME secret kill switch<a class="headerlink" href="#ime-secret-kill-switch" title="Permalink to this headline">¶</a></h4>
<p>The EFF stated <a class="reference external" href="https://www.eff.org/deeplinks/2017/05/intels-management-engine-security-hazard-and-users-need-way-disable-it">Intel’s Management Engine is a security hazard, and users need a way to disable it</a>. Apparently there is a way to mostly disable IME. From <a class="reference external" href="http://blog.ptsecurity.com/2017/08/disabling-intel-me.html">Disabling Intel ME 11 via undocumented mode</a>:</p>
<blockquote>
<div><p>We see increasing interest in Intel ME internals from researchers all over the world. One of the reasons is the transition of this subsystem to new hardware (x86) and software (modified MINIX as an operating system).</p>
<p>Unfortunately, analysis of Intel ME 11 was previously impossible because the executable modules are compressed by Huffman codes with unknown tables. Nonetheless, our research team (Dmitry Sklyarov, Mark Ermolov, and Maxim Goryachy) managed to recover these tables and created a utility for unpacking images. The utility is available <a class="reference external" href="https://github.com/ptresearch/unME11">on our GitHub page</a>.</p>
<p><strong>How to disable ME</strong></p>
<p>Some users of x86 computers have asked the question: how can one disable Intel ME? The issue has been <a class="reference external" href="https://github.com/ptresearch/me-disablement/blob/master/How%20to%20become%20the%20sole%20owner%20of%20your%20PC.pdf">raised</a> by many, <a class="reference external" href="https://hardenedlinux.github.io/firmware/2016/11/17/neutralize_ME_firmware_on_sandybridge_and_ivybridge.html">including Positive Technologies experts</a>. [, ]. And with the recently discovered critical (9.8/10) <a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-5689">vulnerability in Intel Active Management Technology</a> (AMT), which is based on Intel ME, the question has taken on new urgency.</p>
<p>The disappointing fact is that on modern computers, it is impossible to completely disable ME. This is primarily due to the fact that this technology is responsible for initialization, power management, and launch of the main processor. Another complication lies in the fact that some data is hard-coded inside the PCH chip functioning as the southbridge on modern motherboards. The main method used by enthusiasts trying to disable ME is to remove everything “redundant” from the image while maintaining the computer’s operability. But this is not so easy, because if built-in PCH code does not find ME modules in the flash memory or detects that they are damaged, the system will not start.</p>
<p>The <a class="reference external" href="https://github.com/corna/me_cleaner">me_cleaner project</a>, in development for several years, has created a special utility for deleting most of the image and leaving only the components vital for the main system. But even if the system starts, the joy is short-lived—after about 30 minutes, the system may shut down automatically. The reason is that, after some failures, ME enters Recovery Mode, in which it can operate only for a certain period of time. As a result, the cleaning process becomes more complicated. For example, with earlier versions of Intel ME, it was possible to reduce the image size to 90 KB but the Intel ME 11 image can only be reduced to 650 KB.</p>
<p>These files contain a lot of interesting information: the structure of ME firmware and description of the PCH strap, as well as special configuration bits for various subsystems integrated into the PCH chip. One of the fields, called “reserve_hap”, drew our attention because there was a comment next to it: “High Assurance Platform (HAP) enable”.</p>
<p>The second search result said that the name belongs to a trusted platform program linked to the U.S. National Security Agency (NSA). A graphics-rich presentation describing the program can be found <a class="reference external" href="http://fm.csl.sri.com/LAW/2009/dobry-law09-HAP-Challenges.pdf">here</a>. Our first impulse was to set this bit and see what happens. Anyone with an SPI programmer or access to the Flash Descriptor can do this (on many motherboards, access rights to flash memory regions are set incorrectly). After the platform is loaded, the MEInfo utility reports a strange status: “Alt Disable Mode.” Quick checks showed that ME did not respond to commands or react to requests from the operating system.</p>
<p><strong>Setting the HAP bit</strong></p>
<p>The aforementioned facts help to reveal the second method of disabling Intel ME:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Set the HAP bit.</li>
<li>In the CPD section of the FTPR, remove or damage all modules except those required by BUP for startup:<ul>
<li>RBE</li>
<li>KERNEL</li>
<li>SYSLIB</li>
<li>dBUP</li>
</ul>
</li>
<li>Fix the checksum of the CPD header (for more details on the structure of ME firmware, see this paper).</li>
</ol>
</div></blockquote>
<p>So how can we set the HAP bit? We can use the FIT configuration files and determine the location of the bit in the image, but there is a simpler way. In the ME Kernel section of FIT, you can find a Reserved parameter. This is the particular bit that enables HAP mode.</p>
<p><strong>Closing thoughts</strong></p>
<p>So we have found an undocumented PCH strap that can be used to switch on a special mode disabling the main Intel ME functionality at an early stage. We can prove this by the following facts:</p>
<ol class="arabic simple">
<li>Binary analysis of Intel ME firmware, as described in this paper.</li>
<li>If we remove some critical ME modules and enable HAP mode, Intel ME does not crash. This proves that HAP disables ME at an early stage.</li>
<li>We are quite sure that Intel ME is unable to exit this mode because we have not found code capable of doing so in the RBE, KERNEL, and SYSLIB modules.</li>
</ol>
<p>Similarly, we are sure that the ROM integrated into the PCH is practically the same as ROMB, which also does not contain any code allowing an exit from HAP mode.</p>
<p>Hence HAP protects against vulnerabilities present in all modules except RBE, KERNEL, SYSLIB, ROM, and BUP. However, unfortunately this mode does not protect against exploitation of errors at earlier stages.</p>
<p>Intel representatives have been informed about the details of our research. Their response has confirmed our hypothesis about the connection of the undocumented mode with the High Assurance Platform program. With their permission, we quote Intel’s answer below:</p>
<blockquote>
<div><p><em>Mark/Maxim,</em></p>
<p><em>In response to requests from customers with specialized requirements we sometimes explore the modification or disabling of certain features. In this case, the modifications were made at the request of equipment manufacturers in support of their customer’s evaluation of the US government’s “High Assurance Platform” program. These modifications underwent a limited validation cycle and are not an officially supported configuration.</em></p>
</div></blockquote>
<p>We believe that this mechanism is designed to meet a typical requirement of government agencies, which want to reduce the possibility of side-channel leaks. But the main question remains: how does HAP affect Boot Guard? Due to the closed nature of this technology, it is not possible to answer this question yet, but we hope to do so soon.</p>
</div></blockquote>
</div>
<div class="section" id="another-positive-technologies-ime-hack">
<h4>11.30.2.2.4. Another Positive Technologies IME hack<a class="headerlink" href="#another-positive-technologies-ime-hack" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://www.theregister.co.uk/2017/09/26/intel_management_engine_exploit/">Researchers promise demo of ‘God-mode’ pwnage of Intel mobos</a>:</p>
<blockquote>
<div><p>The Positive Technologies researchers say they’ll demonstrate a pwn-everything exploit for Management Engine.</p>
<p>The company’s researchers Mark Ermolov and Maxim Goryachy discovered is that when Intel switched Management Engine to a modified Minix operating system, it introduced a vulnerability in an unspecified subsystem.</p>
<p>Because ME runs independently of the operating system, a victim’s got no way to know they were compromised, and infection is “resistant” to an OS re-install and BIOS update, Ermolov and Goryachy say.</p>
</div></blockquote>
<p>From a later article <a class="reference external" href="https://www.theregister.co.uk/2017/11/09/chipzilla_come_closer_closer_listen_dump_ime/">Intel’s super-secret Management Engine firmware now glimpsed, fingered via USB</a>:</p>
<p>For some details, we’ll have to wait, but what’s known now is bad enough: Positive has confirmed that recent revisions of Intel’s Management Engine (IME) feature Joint Test Action Group (<a class="reference external" href="https://www.xjtag.com/about-jtag/jtag-high-level-guide/">JTAG</a>) debugging ports that can be reached over USB. JTAG grants you pretty low-level access to code running on a chip, and thus we can now delve into the firmware driving the Management Engine.</p>
<blockquote>
<div><p>With knowledge of the firmware internals, security vulnerabilities can be found and potentially remotely exploited at a later date. Alternatively, an attacker can slip into the USB port and meddle the engine as required right there and then.</p>
<p>The IME is able to control a computer because it runs an OS of its own, namely <a class="reference external" href="http://www.minix3.org/">MINIX</a>: a small and simple microkernel system designed to teach computer-science students how hardware and operating systems work. And it turns out that while Intel talked to MINIX’s creator about using it, the tech giant never got around to saying it had put it into recent CPU chipsets it makes.</p>
</div></blockquote>
<p>MINIX was, it appears, discovered in IME by Positive Technologies, as <a class="reference external" href="https://www.troopers.de/downloads/troopers17/TR17_ME11_Static.pdf">documented here</a>. Meanwhile, Google engineer Ronald Minnich earlier <a class="reference external" href="https://www.youtube.com/watch?v=iffTJ1vPCSo">advocated</a> removing IME software from Open Compute <a class="reference external" href="http://www.opencompute.org/wiki/Specs_and_Designs_Page">Winterfell</a> nodes – Google being a <a class="reference external" href="https://www.theregister.co.uk/2016/03/09/google_ocp/">big believer</a> in Open Compute hardware.</p>
<p>See <a class="reference external" href="https://www.blackhat.com/eu-17/briefings/schedule/#how-to-hack-a-turned-off-computer-or-running-unsigned-code-in-intel-management-engine-8668">How to Hack a Turned-Off Computer, or Running Unsigned Code in Intel Management Engine</a> for the upcoming BlackHat talk.</p>
</div>
<div class="section" id="more-ime-exploits">
<h4>11.30.2.2.5. More IME exploits<a class="headerlink" href="#more-ime-exploits" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://arstechnica.com/information-technology/2017/11/intel-warns-of-widespread-vulnerability-in-pc-server-device-firmware/">PC vendors scramble as Intel announces vulnerability in firmware [Updated]</a> overviews the most recent IME exploit.</p>
<p>Intel released the <a class="reference external" href="https://downloadcenter.intel.com/download/27150">Intel-SA-00086 Detection Tool</a> in response to <a class="reference external" href="https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00086&amp;languageid=en-fr">INTEL SA-00086</a>:</p>
<blockquote>
<div><p>In response to issues identified by external researchers, Intel has performed an in-depth comprehensive security review of its Intel® Management Engine (ME), Intel® Trusted Execution Engine (TXE), and Intel® Server Platform Services (SPS) with the objective of enhancing firmware resilience.</p>
<p>Based on the items identified through the comprehensive security review, an attacker could gain unauthorized access to platform, Intel® ME feature, and 3rd party secrets protected by the Intel® Management Engine (ME), Intel® Server Platform Service (SPS), or Intel® Trusted Execution Engine (TXE).</p>
<p>This includes scenarios where a successful attacker could:</p>
<blockquote>
<div><ul class="simple">
<li>Impersonate the ME/SPS/TXE, thereby impacting local security feature attestation validity.</li>
<li>Load and execute arbitrary code outside the visibility of the user and operating system.</li>
<li>Cause a system crash or system instability.</li>
<li>For more information, please see this Intel <a class="reference external" href="http://www.intel.com/SA-00086-Support">Support article</a></li>
</ul>
</div></blockquote>
<p><strong>If the INTEL-SA-00086 Detection Tool reported your system being vulnerable, please check with your system manufacturer for updated firmware.</strong></p>
</div></blockquote>
<p>The corresponding CVE’s are:</p>
<dl class="docutils">
<dt><a class="reference external" href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5705">CVE-2017-5705</a></dt>
<dd>Multiple buffer overflows in kernel in Intel Manageability Engine Firmware 11.0/11.5/11.6/11.7/11.10/11.20 allow attacker with local access to the system to execute arbitrary code.</dd>
<dt><a class="reference external" href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5706">CVE-2017-5706</a></dt>
<dd>Multiple buffer overflows in kernel in Intel Server Platform Services Firmware 4.0 allow attacker with local access to the system to execute arbitrary code.</dd>
<dt><a class="reference external" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5707">CVE-2017-5707</a></dt>
<dd>Multiple buffer overflows in kernel in Intel Trusted Execution Engine Firmware 3.0 allow attacker with local access to the system to execute arbitrary code.</dd>
<dt><a class="reference external" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5708">CVE-2017-5708</a></dt>
<dd>Multiple privilege escalations in kernel in Intel Manageability Engine Firmware 11.0/11.5/11.6/11.7/11.10/11.20 allow unauthorized process to access privileged content via unspecified vector.</dd>
<dt><a class="reference external" href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5709">CVE-2017-5709</a></dt>
<dd>Multiple privilege escalations in kernel in Intel Server Platform Services Firmware 4.0 allows unauthorized process to access privileged content via unspecified vector.</dd>
<dt><a class="reference external" href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5710">CVE-2017-5710</a></dt>
<dd>Multiple privilege escalations in kernel in Intel Trusted Execution Engine Firmware 3.0 allows unauthorized process to access privileged content via unspecified vector.</dd>
<dt><a class="reference external" href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5711">CVE-2017-5711</a></dt>
<dd>Multiple buffer overflows in Active Management Technology (AMT) in Intel Manageability Engine Firmware 8.x/9.x/10.x/11.0/11.5/11.6/11.7/11.10/11.20 allow attacker with local access to the system to execute arbitrary code with AMT execution privilege.</dd>
<dt><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-5712">CVE-2017-5712</a></dt>
<dd>Buffer overflow in Active Management Technology (AMT) in Intel Manageability Engine Firmware 8.x/9.x/10.x/11.0/11.5/11.6/11.7/11.10/11.20 allows attacker with remote Admin access to the system to execute arbitrary code with AMT execution privilege.</dd>
</dl>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="20171118_presentation.html" class="btn btn-neutral float-right" title="11.31. 2017-11-18 Privacy, safe languages, Linux networking" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="20171202_presentation.html" class="btn btn-neutral" title="11.29. 2017-12-02 Static websites, IME follow-up" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>