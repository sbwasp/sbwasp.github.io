

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.1. Finding and running challenges &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.2. flaws" href="flaws.html" />
    <link rel="prev" title="3. Pentest Challenges" href="../pentest_challenges.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.1. Finding and running challenges</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#owasp-vulnerable-web-applications-directory-project">3.1.1. OWASP Vulnerable Web Applications Directory Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-challenges">3.1.2. Running challenges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#challenge-setup-advancing">3.1.2.1. Challenge setup advancing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23">3.1.2.2. OWASP Juice Shop Project</a></li>
<li class="toctree-l4"><a class="reference internal" href="#traditional-vm-challenge-setup">3.1.2.3. Traditional VM challenge setup</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flaws.html">3.2. flaws</a></li>
<li class="toctree-l2"><a class="reference internal" href="moinmoin.html">3.3. MoinMoin</a></li>
<li class="toctree-l2"><a class="reference internal" href="owlnest.html">3.4. OwlNest</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice6.html">3.5. De-ICE Level 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice5.html">3.6. De-ICE Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice4.html">3.7. De-ICE Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice3.html">3.8. De-ICE Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice2.html">3.9. De-ICE Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice1.html">3.10. De-ICE Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="underdist3.html">3.11. Underdist: 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix5.html">3.12. Kioptrix Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix4.html">3.13. Kioptrix Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix3.html">3.14. Kioptrix Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix2.html">3.15. Kioptrix Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix1.html">3.16. Kioptrix Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_shepherd.html">3.17. Security Shepherd Web App Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix2.html">3.18. Holynix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix1.html">3.19. Holynix1</a></li>
<li class="toctree-l2"><a class="reference internal" href="freshly.html">3.20. Freshly</a></li>
<li class="toctree-l2"><a class="reference internal" href="zorz.html">3.21. ZorZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnix.html">3.22. Vulnix</a></li>
<li class="toctree-l2"><a class="reference internal" href="googles_xss_game.html">3.23. Google’s XSS Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="owning_database_with_sqlmap.html">3.24. Owning the Database with SQLMap</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell_II.html">3.25. PentesterLab From SQL injection to Shell II</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell.html">3.26. PentesterLab From SQL injection to Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="skytower1.html">3.27. SkyTower1</a></li>
<li class="toctree-l2"><a class="reference internal" href="nebula.html">3.28. Exploit Exercises Nebula</a></li>
<li class="toctree-l2"><a class="reference internal" href="natas.html">3.29. Natas</a></li>
<li class="toctree-l2"><a class="reference internal" href="try2hack.nl.html">3.30. try2hack.nl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_challenges.html">3. Pentest Challenges</a> &raquo;</li>
        
      <li>3.1. Finding and running challenges</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/challenges/VWADP.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="finding-and-running-challenges">
<h1>3.1. Finding and running challenges<a class="headerlink" href="#finding-and-running-challenges" title="Permalink to this headline">¶</a></h1>
<div class="section" id="owasp-vulnerable-web-applications-directory-project">
<span id="vwad"></span><h2>3.1.1. OWASP Vulnerable Web Applications Directory Project<a class="headerlink" href="#owasp-vulnerable-web-applications-directory-project" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project">OWASP Vulnerable Web Applications Directory Project</a> (VWAD) “is a comprehensive and well maintained registry of all known vulnerable web applications currently available for legal security and vulnerability testing of various kinds.” The GitHub site <a class="reference external" href="https://github.com/OWASP/OWASP-VWAD">OWASP/OWASP-VWAD</a> contains links to the 3 classes of web apps:</p>
<ul class="simple">
<li><a class="reference external" href="https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project/Pages/Online">VWAD Online</a></li>
<li><a class="reference external" href="https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project/Pages/Offline">VWAD Offline</a></li>
<li><a class="reference external" href="https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project/Pages/VMs">VWAD VMs</a></li>
</ul>
</div>
<div class="section" id="running-challenges">
<h2>3.1.2. Running challenges<a class="headerlink" href="#running-challenges" title="Permalink to this headline">¶</a></h2>
<div class="section" id="challenge-setup-advancing">
<span id="id22"></span><h3>3.1.2.1. Challenge setup advancing<a class="headerlink" href="#challenge-setup-advancing" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://www.owasp.org/index.php/OWASP_Juice_Shop_Project">OWASP Juice Shop Project</a> illustrates the changing technology being used for challenges. The previously VM images, usually VMware, have expanded to running in the cloud, Docker containers, packaged distributions, Amazon EC2 instances, or build instructions. GitHub code repositories encourage community participation in challenge development.</p>
</div>
<div class="section" id="id23">
<h3>3.1.2.2. OWASP Juice Shop Project<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://www.owasp.org/index.php/OWASP_Juice_Shop_Project">OWASP Juice Shop Project</a> is an example of this changing technology.</p>
<p>GitHub <a class="reference external" href="https://github.com/bkimminich/juice-shop/">bkimminich/juice-shop</a> contains the <a class="reference external" href="https://github.com/bkimminich/juice-shop#setup">Juice Shop - Setup</a> instructions (Heroku, Docker Container, Packaged Distributions, Amazone EC2 Instance, and Vagrant setup. We’ll walk through a few of these.</p>
<div class="section" id="manual-install">
<h4>3.1.2.2.1. Manual install<a class="headerlink" href="#manual-install" title="Permalink to this headline">¶</a></h4>
<p>Using GitHub, installing Juice Shop on Kali Linux is actually quite easy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Install/configure git</span>
</span>sudo apt install git -y
<span class="nv">GIT_NAME</span><span class="o">=</span><span class="s1">&#39;bitbender&#39;</span>
<span class="nv">GIT_EMAIL</span><span class="o">=</span><span class="s1">&#39;bitbender@bitbender.org&#39;</span>
git config --global user.name <span class="s2">&quot;</span><span class="si">${</span><span class="nv">GIT_NAME</span><span class="si">}</span><span class="s2">&quot;</span>
git config --global user.email <span class="s2">&quot;</span><span class="si">${</span><span class="nv">GIT_EMAIL</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="hll"><span class="c1"># Install nodejs</span>
</span>curl -sL https://deb.nodesource.com/setup_8.x <span class="p">|</span> sudo -E bash -
sudo apt install -y nodejs

<span class="hll"><span class="c1"># Install juice-shop app</span>
</span>git clone https://github.com/bkimminich/juice-shop.git
<span class="nb">cd</span> juice-shop
<span class="c1"># Following needs TCP port 9418 open</span>
npm install
npm start
<span class="hll"><span class="c1"># firefox via http://localhost:3000</span>
</span></pre></div>
</div>
<p>So the complete process involves creating a Kali VM and running the install. The GitHub repository really simplifies this installation process.</p>
</div>
<div class="section" id="heroku-install">
<h4>3.1.2.2.2. Heroku install<a class="headerlink" href="#heroku-install" title="Permalink to this headline">¶</a></h4>
<p>Currently, verified Heroku accounts (provide a credit card) get 1000 free dyno hours (over 41 days) while unverified accounts get 550 free dyno hours (over 22 days). The Juice Store app only needs 1 dyno to run, so there are many hours of testing available.</p>
<p>First, log into Heroku then visit <a class="reference external" href="https://github.com/bkimminich/juice-shop#setup">Juice Shop - Setup</a> a click on <span class="guilabel">Deploy to Heroku</span> then:</p>
<ol class="arabic">
<li><p class="first">On <span class="guilabel">Create New App</span></p>
<p><span class="guilabel">Provide App name</span>: sbwasp-juice-shop</p>
<p><span class="guilabel">Choose a region</span>: United States</p>
<p><span class="guilabel">Add to pipeline…</span>: N/A</p>
<p>then click <span class="guilabel">Deploy app</span></p>
</li>
<li><p class="first">When app is successfully deployed, select ether</p>
<p><span class="guilabel">Manage App</span> (<a class="reference external" href="https://dashboard.heroku.com/apps/sbwasp-juice-shop">https://dashboard.heroku.com/apps/sbwasp-juice-shop</a>)</p>
<p>or <span class="guilabel">View</span> (<a class="reference external" href="https://sbwasp-juice-shop.herokuapp.com/">https://sbwasp-juice-shop.herokuapp.com/</a>).</p>
</li>
<li><p class="first">To stop the application</p>
<p>visit <a class="reference external" href="https://dashboard.heroku.com/apps/sbwasp-juice-shop">Manage App</a></p>
<p>select <span class="guilabel">Resources</span></p>
<p>then click the pencil icon in <span class="guilabel">Web Dyno Autoscaling</span></p>
<p>move the slider to the left, then select <span class="guilabel">Confirm</span></p>
</li>
<li><p class="first">To delete the application</p>
<p>visit <a class="reference external" href="https://dashboard.heroku.com/apps/sbwasp-juice-shop">Manage App</a></p>
<p>select <span class="guilabel">Settings</span></p>
<p>then scroll down and select <span class="guilabel">Delete app…</span></p>
</li>
</ol>
</div>
<div class="section" id="docker-container-install">
<h4>3.1.2.2.3. Docker container install<a class="headerlink" href="#docker-container-install" title="Permalink to this headline">¶</a></h4>
<p>The local container approach uses <a class="reference external" href="https://docs.docker.com/engine/installation/linux/docker-ce/debian/">Get Docker CE for Debian</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Remove existing docker installation</span>
</span>sudo apt-get remove docker docker-engine docker.io -y

<span class="hll"><span class="c1"># Set up repository</span>
</span>sudo apt update
sudo apt-get install <span class="se">\</span>
     apt-transport-https <span class="se">\</span>
     ca-certificates <span class="se">\</span>
     curl <span class="se">\</span>
     gnupg2 <span class="se">\</span>
     software-properties-common <span class="se">\</span>
     -y

<span class="hll"><span class="c1"># Add Docker GPG key</span>
</span><span class="c1"># On debian (not kali) add the GPG key:</span>
curl -fsSL https://download.docker.com/linux/<span class="k">$(</span>. /etc/os-release<span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$ID</span><span class="s2">&quot;</span><span class="k">)</span>/gpg <span class="p">|</span> sudo apt-key add -
<span class="c1"># On kali add the GPG key:</span>
curl -fsSL https://download.docker.com/linux/debian/gpg <span class="p">|</span> sudo apt-key add -
<span class="c1"># Verify key fingerprint matched website page:</span>
sudo apt-key fingerprint 0EBFCD88

<span class="c1"># On debian (not kali) add docker repo:</span>
sudo add-apt-repository <span class="se">\</span>
   <span class="s2">&quot;deb [arch=amd64] https://download.docker.com/linux/</span><span class="k">$(</span>. /etc/os-release<span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$ID</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2"> \</span>
<span class="s2">   </span><span class="k">$(</span>lsb_release -cs<span class="k">)</span><span class="s2"> \</span>
<span class="s2">   stable&quot;</span>
<span class="hll"><span class="c1"># On kali add docker repo:</span>
</span><span class="nb">echo</span> <span class="s2">&quot;deb https://download.docker.com/linux/debian stretch stable&quot;</span> <span class="p">|</span> <span class="se">\</span>
    sudo tee  /etc/apt/sources.list.d/docker.list

<span class="hll"><span class="c1"># Install the package</span>
</span>sudo apt update
sudo apt install docker-ce -y

<span class="hll"><span class="c1"># Verify correct install</span>
</span>sudo docker run hello-world
</pre></div>
</div>
<p id="juice-shop-docker-setup">Then to run Juice Shop:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Download then run container</span>
</span>sudo docker pull bkimminich/juice-shop
sudo docker run -d -p <span class="m">3000</span>:3000 bkimminich/juice-shop
<span class="hll"><span class="c1"># firefox http://localhost:3000/</span>
</span>
<span class="hll"><span class="c1"># Stop container</span>
</span>sudo docker stop <span class="se">\</span>
    <span class="k">$(</span>sudo docker ps <span class="p">|</span> grep <span class="s1">&#39;juice-shop&#39;</span> <span class="p">|</span> cut -d<span class="s1">&#39; &#39;</span> -f1<span class="k">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="traditional-vm-challenge-setup">
<span id="vmsetup"></span><h3>3.1.2.3. Traditional VM challenge setup<a class="headerlink" href="#traditional-vm-challenge-setup" title="Permalink to this headline">¶</a></h3>
<p>Many of the challenges provide a VM as either an ISO image, a VMware VM, or a VirtualBox VM. How can these be run on <a class="reference external" href="https://my.vmware.com/web/vmware/free#desktop_end_user_computing/vmware_workstation_player/12_0">VMware Player</a>, <a class="reference external" href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a>, and <a class="reference external" href="http://libvirt.org/">libvirt</a>/<a class="reference external" href="http://www.linux-kvm.org/page/Main_Page">KVM</a>?</p>
<div class="section" id="iso">
<h4>3.1.2.3.1. ISO<a class="headerlink" href="#iso" title="Permalink to this headline">¶</a></h4>
<p>The easiest is an ISO image: using any of VMware, VirtualBox, or KVM, create a VM like you normally would using an ISO (specifying the OS type). The VM will boot into the vulnerable target host much like if you were running a “live” ISO directly on your PC. That’s it.</p>
</div>
<div class="section" id="vmware-vm">
<h4>3.1.2.3.2. VMware VM<a class="headerlink" href="#vmware-vm" title="Permalink to this headline">¶</a></h4>
<p>Next consider the VMware VM. Of course it should run easily using VMware.</p>
<p>Using the VMware VM’s vmdk file in VirtualBox is quite easy: create a new VM with the option “Use an existing virtual hard drive file” using the vmdk file. Alternatively, you can convert the VMware vmdk to a VirtualBox vdi file one of two ways: (1) use the VirtualBox utility <code class="docutils literal notranslate"><span class="pre">VBoxManage</span></code> via <code class="docutils literal notranslate"><span class="pre">VBoxManage</span> <span class="pre">clonehd</span> <span class="pre">--format</span> <span class="pre">VDI</span> <span class="pre">target.vmdk</span> <span class="pre">target.vdi</span></code>; (2) use <code class="docutils literal notranslate"><span class="pre">qemu-img</span></code> via <code class="docutils literal notranslate"><span class="pre">qemu-img</span> <span class="pre">convert</span> <span class="pre">-f</span> <span class="pre">vmdk</span> <span class="pre">target.vmdk</span> <span class="pre">-O</span> <span class="pre">vdi</span> <span class="pre">target.vdi</span></code>.</p>
<p>KVM can directly use the vmdk file or convert it to qemu format via <code class="docutils literal notranslate"><span class="pre">qemu-img</span> <span class="pre">convert</span> <span class="pre">-f</span> <span class="pre">vmdk</span> <span class="pre">target.vmdk</span> <span class="pre">-O</span> <span class="pre">qcow2</span> <span class="pre">target.qcow2</span></code>. Then create a new VM importing an exising disk image; use either of 2 disk images (vmdk or qcow2).</p>
<p>If you’d like to use a backing store to allow easy rollback to the original, you can use the vmdk or it’s converted qcow2/raw image as the backing store as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">USE_VMDK</span><span class="o">=</span><span class="m">1</span>
<span class="nv">VM_DISK</span><span class="o">=</span>vm-changes.qcow2

<span class="hll"><span class="c1"># Use vmdk or create a qcow2 backing file</span>
</span><span class="hll"><span class="nv">BACKING</span><span class="o">=</span>target.vmdk
</span><span class="k">if</span> <span class="o">[[</span> <span class="nv">$USE_VMDK</span> !<span class="o">=</span> <span class="s2">&quot;1&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
<span class="hll">  sudo qemu-img convert -f vmdk target.vmdk -O qcow2 target.qcow2
</span><span class="hll">  <span class="nv">BACKING</span><span class="o">=</span>target.qcow2
</span><span class="k">fi</span>

<span class="hll"><span class="c1"># Create disk for VM backed by backing file</span>
</span><span class="hll">sudo qemu-img create -f qcow2 -o <span class="nv">backing_file</span><span class="o">=</span><span class="nv">$BACKING</span>  <span class="nv">$VM_DISK</span>
</span>sudo qemu-img info <span class="nv">$BACKING</span>
sudo qemu-img info <span class="nv">$VM_DISK</span>
</pre></div>
</div>
<p>Then you can create a new VM as above, selecting the VM_DISK image. To revert to the original target, the VM_DISK image can simply be recreated.</p>
</div>
<div class="section" id="virtualbox-vm">
<h4>3.1.2.3.3. VirtualBox VM<a class="headerlink" href="#virtualbox-vm" title="Permalink to this headline">¶</a></h4>
<p>Next consider the VirtualBox VM. Of course it should run easily using VirtualBox.</p>
<p>Using the VirtualBox VM’s vdi file in VMware is quite easy: convert the VirtualBox vdi to a VMware vmdk file using <code class="docutils literal notranslate"><span class="pre">qemu-img</span></code> via <code class="docutils literal notranslate"><span class="pre">qemu-img</span> <span class="pre">convert</span> <span class="pre">-f</span> <span class="pre">vdi</span> <span class="pre">target.vdi</span> <span class="pre">-O</span> <span class="pre">vmdk</span> <span class="pre">target.vmdk</span></code>.</p>
<p>KVM can directly use the vmdk file or convert it to qemu format via <code class="docutils literal notranslate"><span class="pre">qemu-img</span> <span class="pre">convert</span> <span class="pre">-f</span> <span class="pre">vdi</span> <span class="pre">target.vdi</span> <span class="pre">-O</span> <span class="pre">qcow2</span> <span class="pre">target.qcow2</span></code>. Then create a new VM importing an exising disk image; use either of 2 disk images (vdi or qcow2).</p>
</div>
<div class="section" id="metasploitable2-setup-vmware-vmdk-to-virtualbox-and-kvm">
<span id="metasploitable2setup"></span><h4>3.1.2.3.4. Metasploitable2 Setup - VMware vmdk to VirtualBox and KVM<a class="headerlink" href="#metasploitable2-setup-vmware-vmdk-to-virtualbox-and-kvm" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://sourceforge.net/projects/metasploitable/files/Metasploitable2/">Metasploitable</a>’s 64-bit Ubuntu 8.04 LTS (Hardy Heron) intentionally insecure VMware VM. <a class="reference external" href="http://r-7.co/Metasploitable2">Metasploitable 2 Exploitability Guide</a> describes the vulnerable services. Remember you can login using msfadmin/msfadmin, then <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">-i</span></code> to become root. The DVWA Security page at <a class="reference external" href="http://VULNERABLE/dvwa/security.php">http://VULNERABLE/dvwa/security.php</a> can set the security level to one of low (no protection), medium (inadequate protection), or high (secure).</p>
<p>From the above you can see that no conversion of the VMware vmdk file is necessary to run the vmdk in all three of VMware (obviously), VirtualBox, or KVM. But we can use <code class="docutils literal notranslate"><span class="pre">qemu-img</span></code> to convert if we’d like to: <code class="docutils literal notranslate"><span class="pre">qemu-img</span></code> via <code class="docutils literal notranslate"><span class="pre">qemu-img</span> <span class="pre">convert</span> <span class="pre">-f</span> <span class="pre">vmdk</span> <span class="pre">Metasploitable2.vmdk</span> <span class="pre">-O</span> <span class="pre">vdi</span> <span class="pre">Metasploitable2.vdi</span></code> or <code class="docutils literal notranslate"><span class="pre">qemu-img</span> <span class="pre">convert</span> <span class="pre">-f</span> <span class="pre">vmdk</span> <span class="pre">Metasploitable2.vmdk</span> <span class="pre">-O</span> <span class="pre">qcow2</span> <span class="pre">Metasploitable2.qcow2</span></code>.</p>
<p>We’ll illustrate the conversion to KVM using a backing store (keeping the original disk image intact and recording changes to a separate, erasable disk), and solving a powerdown problem. First convert the VMware VM to a qcow2 backing file, then create the writable main disk:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll">sudo qemu-img convert -f vmdk Metasploitable.vmdk -O qcow2 Metasploitable.qcow2
</span><span class="hll">sudo qemu-img create -f qcow2 -o <span class="nv">backing_file</span><span class="o">=</span>Metasploitable.qcow2 meta-changes.qcow2
</span>sudo qemu-img info Metasploitable.qcow2
sudo qemu-img info meta-changes.qcow2
</pre></div>
</div>
<p>Next create a new 64-bit VM importing an exising disk image; use the disk meta-changes.qcow2, OS type Linux, Version “Show all OS options”, again select OS type Linux, then Version Ubuntu 8.04 LTS (Hardy Heron); take default memory &amp; CPU; customize configuration before install, making sure the “Disk bus” is SCSI. The KVM VM does not completely power off; to fix this, boot up the VM and as root execute <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">&quot;apm</span> <span class="pre">power_off=1&quot;</span> <span class="pre">&gt;&gt;</span> <span class="pre">/etc/modules;</span> <span class="pre">modprobe</span> <span class="pre">apm</span> <span class="pre">power_off=1</span></code>.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="flaws.html" class="btn btn-neutral float-right" title="3.2. flaws" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../pentest_challenges.html" class="btn btn-neutral" title="3. Pentest Challenges" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>