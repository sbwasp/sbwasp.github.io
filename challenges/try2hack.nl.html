

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.28. try2hack.nl &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.3 documentation" href="../index.html"/>
        <link rel="up" title="3. Pentest Challenges" href="../pentest_challenges.html"/>
        <link rel="next" title="4. Encryption" href="../pentest_encryption.html"/>
        <link rel="prev" title="3.27. Natas" href="natas.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="VWADP.html">3.1. Finding and running challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="owlnest.html">3.2. OwlNest</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice6.html">3.3. De-ICE Level 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice5.html">3.4. De-ICE Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice4.html">3.5. De-ICE Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice3.html">3.6. De-ICE Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice2.html">3.7. De-ICE Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="de-ice1.html">3.8. De-ICE Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="underdist3.html">3.9. Underdist: 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix5.html">3.10. Kioptrix Level 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix4.html">3.11. Kioptrix Level 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix3.html">3.12. Kioptrix Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix2.html">3.13. Kioptrix Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="kioptrix1.html">3.14. Kioptrix Level 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="security_shepherd.html">3.15. Security Shepherd Web App Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix2.html">3.16. Holynix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="holynix1.html">3.17. Holynix1</a></li>
<li class="toctree-l2"><a class="reference internal" href="freshly.html">3.18. Freshly</a></li>
<li class="toctree-l2"><a class="reference internal" href="zorz.html">3.19. ZorZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnix.html">3.20. Vulnix</a></li>
<li class="toctree-l2"><a class="reference internal" href="googles_xss_game.html">3.21. Google’s XSS Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="owning_database_with_sqlmap.html">3.22. Owning the Database with SQLMap</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell_II.html">3.23. PentesterLab From SQL injection to Shell II</a></li>
<li class="toctree-l2"><a class="reference internal" href="from_sql_injection_to_shell.html">3.24. PentesterLab From SQL injection to Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="skytower1.html">3.25. SkyTower1</a></li>
<li class="toctree-l2"><a class="reference internal" href="nebula.html">3.26. Exploit Exercises Nebula</a></li>
<li class="toctree-l2"><a class="reference internal" href="natas.html">3.27. Natas</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.28. try2hack.nl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id22">3.28.1. Level 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">3.28.2. Level 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">3.28.3. Level 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">3.28.4. Level 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">3.28.5. Level 5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">3.28.6. Level 6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">3.28.7. Level 7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">3.28.8. Level 8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id31">3.28.9. Level 9</a></li>
<li class="toctree-l3"><a class="reference internal" href="#level-10-with-key-yu0aertehbomb">3.28.10. Level 10 (with key “yu0aertehbomb”)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id32">3.28.11. Level 11</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id33">3.28.12. Level 12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">3.28.13. Level 13</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">3.28.14. Level 14</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_challenges.html">3. Pentest Challenges</a> &raquo;</li>
        
      <li>3.28. try2hack.nl</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/challenges/try2hack.nl.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="try2hack-nl">
<span id="id21"></span><h1>3.28. try2hack.nl<a class="headerlink" href="#try2hack-nl" title="Permalink to this headline">¶</a></h1>
<p>This is to document the meetup’s efforts responding to the challenge <a class="reference external" href="http://try2hack.nl/">TRY2HACK</a>. <a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl">dsolstad/walkthrough-try2hack.nl</a> already has a good writeup of the solutions, so we only provide each level’s URL &amp; answers. In a few cases we mention alternate solutions and provide some missing detail.</p>
<p>Before starting, review the <a class="reference external" href="http://try2hack.nl/rules/">rules</a>, then <a class="reference external" href="http://try2hack.nl/levels/">start</a>.</p>
<div class="section" id="id22">
<h2>3.28.1. <a class="reference external" href="http://try2hack.nl/levels/">Level 1</a><a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level01.md">Level 1 hint</a></div>
<div class="line">Level 1 Password = “h4x0r”</div>
</div>
</div>
<div class="section" id="id23">
<h2>3.28.2. <a class="reference external" href="http://try2hack.nl/levels/level2-xfdgnh.xhtml">Level 2</a><a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level02.md">Level 2 hint</a></div>
<div class="line">Level 2 Username = “try2hack”</div>
<div class="line">Level 2 Password = “irtehh4x0r!”</div>
</div>
<p>Level 2 doesn’t actually require having flash. You can just download the flash file and use <code class="docutils literal"><span class="pre">strings</span> <span class="pre">level2.swf</span></code> to view all 3 of Username/Password/NextLevelURL.</p>
</div>
<div class="section" id="id24">
<h2>3.28.3. <a class="reference external" href="http://try2hack.nl/levels/level3-.xhtml">Level 3</a><a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level03.md">Level 3 hint</a></div>
<div class="line">Level 3 Password = “try2hackrawks”</div>
</div>
</div>
<div class="section" id="id25">
<h2>3.28.4. <a class="reference external" href="http://try2hack.nl/levels/level4-kdnvxs.xhtml">Level 4</a><a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level04.md">Level 4 hint</a></div>
<div class="line">Level 4 Username = “appletking”</div>
<div class="line">Level 4 Password = “pieceofcake”</div>
</div>
<p>Level 4 attempts to run a java applet, though you don’t need to with the method in the <a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level04.md">Level 4 hint</a>. Instead of using the suggested java decompiler, Kali Linux has the java decompiler <code class="docutils literal"><span class="pre">jad</span></code> already installed.</p>
<p>Alternatively, if you do have java installed, you could run <code class="docutils literal"><span class="pre">ngrep</span></code> while the requested page loaded to look at http GET and POST URLs. Just after the PasswdLevel4.class is loaded the file “/levels/level4” is downloaded. A simple <cite>wget</cite> command to retrieve that file would reveal the answer.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~#</span> ngrep -l -p -d eth0 <span class="s2">&quot;^GET |^POST &quot;</span> <span class="se">\</span>
    tcp and port <span class="m">80</span> and host try2hack.nl

<span class="go">T 192.168.1.28:35277 -&gt; 217.195.122.51:80 [AP]</span>
<span class="go">  GET /levels/PasswdLevel4.class HTTP/1.1..User-Agent: Java(tm) 2 SDK, Standa</span>
<span class="go">  rd Edition v1.7.0_55 Java/1.7.0_55..Host: try2hack.nl..Accept: text/html, i</span>
<span class="go">  mage/gif, image/jpeg, *; q=.2, */*; q=.2..Connection: keep-alive....</span>
<span class="gp">#</span><span class="c1">######</span>
<span class="go">T 192.168.1.28:35277 -&gt; 217.195.122.51:80 [AP]</span>
<span class="go">  GET /levels/level4 HTTP/1.1..User-Agent: Java(tm) 2 SDK, Standard Edition v</span>
<span class="go">  1.7.0_55 Java/1.7.0_55..Host: try2hack.nl..Accept: text/html, image/gif, im</span>
<span class="go">  age/jpeg, *; q=.2, */*; q=.2..Connection: keep-alive....</span>
<span class="gp">#</span><span class="c1">#####^Cexit</span>
<span class="go">120 received, 0 dropped</span>

<span class="gp">me@myhost:~#</span> wget http://try2hack.nl/levels/level4
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>

<span class="gp">me@myhost:~#</span> cat level4
<span class="go">level5-fdvbdf.xhtml</span>
<span class="go">appletking</span>
<span class="go">pieceofcake</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h2>3.28.5. <a class="reference external" href="http://try2hack.nl/levels/level5-fdvbdf.xhtml">Level 5</a><a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level05.md">Level 5 hint</a></div>
<div class="line">Level 5 Username = “Try2Hack”</div>
<div class="line">Level 5 Password = “ILoveDodi”</div>
</div>
<p>This one only requires decompiling (but not running) the VB3 program LEVEL5.EXE. And it can be run on Kali Linux using <code class="docutils literal"><span class="pre">winetricks</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>apt-get install winetricks
winetricks vb6run
<span class="c1">###################### SNIP ######################</span>
cp VB6*.exe /root/.cache/winetricks/vb6run/
winetricks vb6run
<span class="c1">###################### SNIP ######################</span>
<span class="c1"># Now download and run the disassembler (ignoring the error messages)</span>
</pre></div>
</div>
<p>And of course the exploit continues on as described in the hint.</p>
</div>
<div class="section" id="id28">
<h2>3.28.6. <a class="reference external" href="http://www.try2hack.nl/levels/level6-kdsvbd.xhtml">Level 6</a><a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level06.md">Level 6 hint</a></div>
<div class="line">Level 6 Username = “dabomb”</div>
<div class="line">Level 6 Password = “encryptionrawks”</div>
</div>
<p>Instead of <code class="docutils literal"><span class="pre">wireshark</span></code> the easier <code class="docutils literal"><span class="pre">ngrep</span></code> can be used for network traffic capture. This one can also be run on Kali Linux using <code class="docutils literal"><span class="pre">winetricks</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># If not already done for Level 5 ...</span>
apt-get install winetricks
winetricks vb6run
<span class="c1">###################### SNIP ######################</span>
cp VB6*.exe /root/.cache/winetricks/vb6run/
winetricks vb6run
<span class="c1">###################### SNIP ######################</span>

<span class="c1"># Now continue on ...</span>
<span class="c1"># Now go online and download RICHTX32.OCX, MSWINSCK.OCX in LEVEL6.EXE dir</span>
wine LEVEL6.EXE
<span class="c1">###################### SNIP ######################</span>
</pre></div>
</div>
<p>In a separate terminal window open up:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~#</span> ngrep -l -p -d eth0 <span class="s2">&quot;^GET |^POST &quot;</span> <span class="se">\</span>
    tcp and port <span class="m">80</span> and host try2hack.nl

<span class="go"> T 192.168.1.28:35277 -&gt; 217.195.122.51:80 [AP]</span>
<span class="go">   GET /levels/levels/level6.data HTTP/1.1..Host: try2hack.nl..Connection: close. .User-Agent: Try2Hack level 6 client..Accept: */*....</span>
<span class="gp"> #</span><span class="c1">#####^Cexit</span>
<span class="go"> 16 received, 0 dropped</span>

<span class="go"> me@myhost:~# wget http://try2hack.nl/levels/level6.data</span>
<span class="gp"> #</span><span class="c1">##################### SNIP ######################</span>

<span class="go"> me@myhost:~# cat level6.data</span>
<span class="go"> (ENCRYPTION TYPE)</span>
<span class="go"> B*C*N**N</span>

<span class="go"> (USERNAME)</span>
<span class="go"> aaabb aaaaa aaaab abbab ababb aaaab</span>

<span class="go"> (PASSWORD)</span>
<span class="go"> aabaa abbaa aaaba baaaa babba abbba baaba abaaa abbab abbaa baaaa aaaaa babaa abaab baaab</span>

<span class="go"> (PAGE)</span>
<span class="go"> babab aabab abaab abbab aabbb aaabame@myhost:~#</span>
</pre></div>
</div>
<p>And of course the exploit continues on as described in the hint.</p>
</div>
<div class="section" id="id29">
<h2>3.28.7. <a class="reference external" href="http://www.try2hack.nl/levels/level7-xfkohc.php">Level 7</a><a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level07.md">Level 7 hint</a></div>
<div class="line">Only answer is the Level 8 url below</div>
</div>
<p>The hint ignores the much simpler <code class="docutils literal"><span class="pre">wget</span></code> solution:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~#</span> wget http://www.try2hack.nl/levels/level7-xfkohc.php <span class="se">\</span>
    --header<span class="o">=</span><span class="s1">&#39;User-agent: MSIE 7.66;Unix&#39;</span> <span class="se">\</span>
    --header<span class="o">=</span><span class="s1">&#39;Referer: http://www.microsoft.com/ms.htm&#39;</span>
<span class="go">--2014-07-09 09:57:54--  http://www.try2hack.nl/levels/level7-xfkohc.php</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">Saving to: ‘level7-xfkohc.php’</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>

<span class="gp">me@myhost:~#</span> cat level7-xfkohc.php
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">&lt;a href=&quot;level8-balnrg.xhtml&quot;&gt;Level 8&lt;/a&gt;</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="gp">me@myhost:~#</span>
</pre></div>
</div>
</div>
<div class="section" id="id30">
<h2>3.28.8. <a class="reference external" href="http://www.try2hack.nl/levels/level8-balnrg.xhtml">Level 8</a><a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level08.md">Level 8 hint</a></div>
<div class="line">Level 9 Username = “root”</div>
<div class="line">Level 9 Password = “arse”</div>
</div>
</div>
<div class="section" id="id31">
<h2>3.28.9. <a class="reference external" href="http://www.try2hack.nl/levels/level9-gnapei.xhtml">Level 9</a><a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level09.md">Level 9 hint</a></div>
<div class="line">Level 10 irc node = “irc.efnet.org”</div>
<div class="line">Level 10 irc channel = “#try2hack.level10”</div>
<div class="line">Level 10 Password = “yu0aertehbomb”</div>
</div>
<p><a class="reference external" href="http://sp4hack.blogspot.com/2012/11/try2hack-level-9.html">Here</a> is the simplest solution, involving only using the Chrome browser’s ability to modify a cookie.</p>
<p>Alternatively, using <code class="docutils literal"><span class="pre">ngrep</span></code> and <code class="docutils literal"><span class="pre">wget</span></code> gives us another simple solution illustrating the use of these 2 utilities. First open up a window to snoop just prior to submitting your first password request:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~#</span> ngrep -lpd eth0 <span class="s2">&quot;^GET |^POST &quot;</span> tcp and port <span class="m">80</span> and host try2hack.nl
<span class="go">eth0: no IPv4 address assigned: Cannot assign requested address</span>
<span class="go">interface: eth0</span>
<span class="go">filter: (ip or ip6) and ( tcp and port 80 and host try2hack.nl )</span>
<span class="go">match: ^GET |^POST</span>
</pre></div>
</div>
<p>Then try a password and you’ll see this in the capture:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span><span class="c1">###</span>
<span class="go">T 192.168.1.23:44840 -&gt; 217.195.122.51:80 [AP]</span>
<span class="go">  POST /levels/level9-gnapei.xhtml HTTP/1.1..Host: www.try2hack.nl..Connection:</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">  ,en;q=0.8..Cookie: str_username=admin; str_password=yu0aertehbomb; auth=no....</span>
<span class="go">  username=anyuser&amp;password=anypassword&amp;submit=Enter</span>
<span class="gp">#</span><span class="c1">#######</span>
</pre></div>
</div>
<p>This is where you display your html-fu skills and notice there is a cookie with “auth=no” and decide to try setting “auth=yes” for the cookie (after unsuccessfully trying to enter the cookie username &amp; password).</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~#</span> wget --no-cookies <span class="se">\</span>
  --header <span class="s2">&quot;Cookie: str_username=admin; str_password=yu0aertehbomb; auth=yes&quot;</span> <span class="se">\</span>
  --post-data<span class="o">=</span><span class="s2">&quot;username=admin&amp;password=yu0aertehbomb&amp;submit=Enter&quot;</span>  <span class="se">\</span>
  http://www.try2hack.nl/levels/level9-gnapei.xhtml
<span class="go">--2014-07-09 11:16:09--  http://www.try2hack.nl/levels/level9-gnapei.xhtml</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">2014-07-09 11:16:10 (25.4 KB/s) - ‘level9-gnapei.xhtml’ saved [4120/4120]</span>

<span class="gp">me@myhost:~#</span> cat level9-gnapei.xhtml
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">Good job! You can find Level 10 at our IRC channels. Go to #try2hack.level10 on irc.efnet.org and use &#39;yu0aertehbomb&#39; as key to continue. See the &lt;a href=&quot;../chat/&quot;&gt;chat&lt;/a&gt; page for more information.</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="gp">me@myhost:~#</span>
</pre></div>
</div>
</div>
<div class="section" id="level-10-with-key-yu0aertehbomb">
<h2>3.28.10. <a class="reference external" href="irc://irc.efnet.org/try2hack.level10,needkey">Level 10</a> (with key “yu0aertehbomb”)<a class="headerlink" href="#level-10-with-key-yu0aertehbomb" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level10.md">Level 10 hint</a></div>
<div class="line">Only answer is the Level 11 url below</div>
</div>
<p>Remember, the <a class="reference external" href="http://www.try2hack.nl/rules/">level 10 rules</a> say:</p>
<blockquote>
<div>The goal of level 10 is to create your own account on the bot and gain +n (owner) by exploiting an intentional bug in the bot.</div></blockquote>
<p>So in the following, watch for an exploit on the irc server, allowing you to gain +n (owner) via a bug in the bot.</p>
<p>At irc server irc.efnet.org, join #try2hack.level10 with password ‘yu0aertehbomb’ and receive this message:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">(12:22:28 PM) LVL10-049: (notice) [#try2hack.level10] Welcome, I am try2hack Level10! Decode the following line to proceed:</span>
<span class="go">(12:22:30 PM) LVL10-049: (notice)      010011100110100101100011011001010010000001101010011011110110001000101110001000000100111001101111011101110010000001110100011110010111000001100101001000000010011100101111011011010111001101100111001000000101010001010010010110010011001001001000010000010100001101001011001000000111001101101000011011110111011101100010011101010110011100100111001000000111010001101111001000000111001101100101011001010010000001110100011010000110010100100000011000100111010101100111</span>
</pre></div>
</div>
<p><a class="reference external" href="http://encodertool.com/binary">encodertool</a> translates this binary mess to:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Nice job. Now type &#39;/msg TRY2HACK showbug&#39; to see the bug</span>
</pre></div>
</div>
<p>Go back to irc to enter ‘/msg TRY2HACK showbug’ and get this reponse:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">(12:45:04 PM) TRY2HACK: (notice) [#try2hack.level10] I am the try2hack servicebot. I&#39;m not part of the challenges so don&#39;t try to h4x0r me.</span>
<span class="go">(12:45:32 PM) TRY2HACK: (notice) ovaq pgpe - CVAT pgpe:cvatercyl</span>
<span class="go">(12:45:34 PM) TRY2HACK: (notice) cebp pgpe:cvatercyl {avpx hubfg unaq qrfg xrl net} {</span>
<span class="go">(12:45:36 PM) TRY2HACK: (notice) frg qhe [rkce [havkgvzr] - $net]</span>
<span class="go">(12:45:38 PM) TRY2HACK: (notice) chgfrei &quot;ABGVPR $avpx :Lbhe cvat ercyl gbbx $qhe frpbaqf&quot;}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">echo</span> <span class="pre">&quot;STRING&quot;</span> <span class="pre">|</span> <span class="pre">tr</span> <span class="pre">a-zA-Z</span> <span class="pre">n-za-mN-ZA-M</span></code> rot13 translates this to:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">bind ctcr - PING ctcr:pingreply</span>
<span class="go">proc ctcr:pingreply {nick uhost hand dest key arg} {</span>
<span class="go">    set dur [expr [unixtime] - $arg]</span>
<span class="go">    putserv &quot;NOTICE $nick :Your ping reply took $dur seconds&quot;}</span>
</pre></div>
</div>
<p>So this must be the exploit. A little google-fu and we see that it’s <a class="reference external" href="http://eggtcl.github.io/">eggtcl</a> Tcl code for an <a class="reference external" href="http://www.eggheads.org/">Eggdrop</a> IRC bot. The <a class="reference external" href="http://www.eggheads.org/support/egghtml/1.6.15/tcl-commands.html">Eggdrop Tcl Commands</a> defines the commands we have available. Our goal is to add a user and make them an owner. Looking at the list of commands we need <code class="docutils literal"><span class="pre">adduser</span> <span class="pre">HANDLE</span></code> and <code class="docutils literal"><span class="pre">chattr</span> <span class="pre">HANDLE</span> <span class="pre">+n</span></code> (as given in the original rule instructions).</p>
<p>Apparently, using the script can exploit the IRC bot LVL10-xxx (not the try2hack bot in #try2hack.level10 - hands off). Note that the bot name changes periodically (xxx is a 3 digit number).</p>
<p>First, where’s the exploit? Well, the script evaluates $arg with no checks, so we can make $arg be arbitrary commands (the ones we outlined above). Of course the computed time duration would be wildly off given that we’re not sending in a time :)</p>
<p>Second, we must get the script to execute. It binds to the ctcr PING event, so we choose between the CTCP and NCTCP commands, either one sending a PING with an argument of a command.</p>
<p>So fire up your irc chat client and send the following commands:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">/JOIN #try2hack.level10 yu0aertehbomb</span>
<span class="go">/NCTCP LVL10-055 PING [adduser virt *!virt@*]</span>
<span class="go">/NCTCP LVL10-055 PING [chattr virt +n]</span>
<span class="go">/MSG LVL10-055 pass abcdef</span>
<span class="go">... your humble writer could not get dcc chat going due to firewall issues ...</span>
<span class="go">/DCC CHAT LVL10-055</span>
</pre></div>
</div>
<p>After doing so, you are an owner (grand poo-bah). From the hint a DCC chat with the bot to get the next challenge information. Your cub pentest reporter was not able to get DCC going through the home firewall. Maybe it will work better at the meetup.</p>
</div>
<div class="section" id="id32">
<h2>3.28.11. <a class="reference external" href="http://www.try2hack.nl/levels/level11-vmituh.xhtml">Level 11</a><a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level11.md">Level 11 hint</a></div>
<div class="line">Only answer is the Level 12 url below</div>
</div>
<p>Here is a python version:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span>

<span class="c1"># Read the level11 page</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.try2hack.nl/levels/level11-vmituh.xhtml&#39;</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Pick out the positions</span>
<span class="n">csl</span> <span class="o">=</span> <span class="n">page</span><span class="p">[</span><span class="n">page</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;at positions &quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">13</span> <span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot; of your randomly&quot;</span><span class="p">)]</span>
<span class="n">csl</span> <span class="o">=</span> <span class="n">csl</span><span class="p">[:</span><span class="n">csl</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot; and&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">csl</span><span class="p">[</span><span class="n">csl</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot; and&quot;</span><span class="p">)</span><span class="o">+</span> <span class="mi">5</span><span class="p">:]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">csl</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>

<span class="c1"># Pick out the random string</span>
<span class="n">rstring</span> <span class="o">=</span> <span class="n">page</span><span class="p">[</span><span class="n">page</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Your random string:&lt;br /&gt;&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">:]</span>
<span class="n">rands</span> <span class="o">=</span> <span class="n">rstring</span><span class="p">[:</span><span class="n">rstring</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;&lt;hr /&gt;&quot;</span><span class="p">)]</span>

<span class="c1"># Compute the answer</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">rands</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
<span class="n">product</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)</span>
<span class="n">answer</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">product</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

<span class="c1"># http POST the answer</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;answer&#39;</span> <span class="p">:</span> <span class="n">answer</span><span class="p">,</span>
          <span class="s1">&#39;submit&#39;</span> <span class="p">:</span> <span class="s1">&#39;click here to continue&#39;</span><span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="n">req</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># Get response with level 12 page location</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">level12</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;level12&#39;</span><span class="p">):]</span>
<span class="n">level12</span> <span class="o">=</span> <span class="n">level12</span><span class="p">[:</span><span class="n">level12</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)]</span>
<span class="k">print</span><span class="p">(</span><span class="n">level12</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a bash version:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Read the level 11 page</span>
<span class="nv">resp</span><span class="o">=</span><span class="k">$(</span>wget -q -O - http://www.try2hack.nl/levels/level11-vmituh.xhtml<span class="k">)</span>

<span class="c1"># Pick out the positions</span>
<span class="nv">bytes</span><span class="o">=</span><span class="si">${</span><span class="nv">resp</span><span class="p">#*characters at positions </span><span class="si">}</span>
<span class="nv">bytes</span><span class="o">=</span><span class="si">${</span><span class="nv">bytes</span><span class="p">%% of your *</span><span class="si">}</span>
<span class="nv">bytes</span><span class="o">=</span><span class="si">${</span><span class="nv">bytes</span><span class="p">/ and/,</span><span class="si">}</span>
<span class="nv">bytes</span><span class="o">=</span><span class="si">${</span><span class="nv">bytes</span><span class="p">//,/ </span><span class="si">}</span>

<span class="c1"># Pick out the random string</span>
<span class="nv">random</span><span class="o">=</span><span class="si">${</span><span class="nv">resp</span><span class="p">#*string:&lt;br /&gt;</span><span class="si">}</span>
<span class="nv">random</span><span class="o">=</span><span class="si">${</span><span class="nv">random</span><span class="p">%%&lt;*</span><span class="si">}</span>

<span class="c1"># Compute the answer</span>
<span class="nv">mult</span><span class="o">=</span><span class="k">$((</span> <span class="m">1</span> <span class="k">))</span>
<span class="k">for</span> i in <span class="nv">$bytes</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">p</span><span class="o">=</span><span class="k">$((</span> i <span class="o">-</span> <span class="m">1</span><span class="k">))</span>
  <span class="nv">c</span><span class="o">=</span><span class="si">${</span><span class="nv">random</span><span class="p">:</span><span class="nv">$p</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span>
  <span class="nb">printf</span> -v n <span class="s2">&quot;%d&quot;</span> <span class="se">\&#39;</span><span class="nv">$c</span>
  <span class="nv">mult</span><span class="o">=</span><span class="k">$(</span>bc <span class="o">&lt;&lt;&lt;</span> <span class="nv">$mult</span>*<span class="nv">$n</span><span class="k">)</span>
<span class="k">done</span>
<span class="nv">answer</span><span class="o">=</span><span class="si">${</span><span class="nv">mult</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">5</span><span class="si">}</span>

<span class="c1"># http POST the answer</span>
<span class="nv">resp</span><span class="o">=</span><span class="k">$(</span>wget -q -O - http://www.try2hack.nl/levels/level11-vmituh.xhtml <span class="se">\</span>
     --post-data <span class="s2">&quot;answer=</span><span class="si">${</span><span class="nv">answer</span><span class="si">}</span><span class="s2">&amp;submit=click+here+to+continue&quot;</span><span class="k">)</span>

<span class="c1"># Get response with level 12 page location</span>
<span class="nv">level12</span><span class="o">=</span><span class="si">${</span><span class="nv">resp</span><span class="p">#*passed Level 11.&lt;br /&gt;&lt;br /&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="si">}</span>
<span class="nv">level12</span><span class="o">=</span><span class="si">${</span><span class="nv">level12</span><span class="p">%%</span><span class="se">\&quot;</span><span class="p">*</span><span class="si">}</span>
<span class="nb">echo</span> <span class="nv">$level12</span>
</pre></div>
</div>
</div>
<div class="section" id="id33">
<h2>3.28.12. <a class="reference external" href="http://www.try2hack.nl/levels/level12-kvdsju.xhtml">Level 12</a><a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level12.md">Level 12 hint</a></div>
<div class="line">Level 12 Username = “lamer”</div>
<div class="line">Level 12 Password = “648tryharder”</div>
</div>
<p>The instructions lead one to get a python decompiler. A quick search comes up with : <a class="reference external" href="http://sourceforge.net/projects/easypythondecompiler/files/latest/download?source=files">Easy Python Decompiler</a> for Windows, <a class="reference external" href="https://github.com/gstarnberger/uncompyle">uncompyle</a>, and <a class="reference external" href="https://github.com/zrax/pycdc">Decompiler++</a>. Once installed, the resulting source is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Source Generated with Decompyle++</span>
<span class="c1"># File: level12.pyc (Python 2.7)</span>

<span class="kn">from</span> <span class="nn">md5</span> <span class="kn">import</span> <span class="n">new</span>
<span class="k">print</span> <span class="s1">&#39;Enter username:&#39;</span>
<span class="n">username</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">()</span>
<span class="k">print</span> <span class="s1">&#39;Enter password:&#39;</span>
<span class="n">password</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">700</span><span class="p">)</span> <span class="o">+</span> <span class="mi">173</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">148</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">21</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">327</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">534</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(((</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="mi">52</span><span class="p">)</span> <span class="o">/</span> <span class="mi">70</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">640</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">5083</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">-</span> <span class="mi">3126</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="k">pass</span>


<span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">new</span><span class="p">(</span><span class="n">username</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> \
            <span class="s1">&#39;3e3a378c63aa1&#39;</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;55e3e9&#39;</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;e9d2bdcd6a1&#39;</span> \
            <span class="ow">and</span> <span class="n">password</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;Well done. Enter the valid username and password on the form online.&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;Wrong username and/or password&#39;</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Wrong username and/or password&#39;</span>
</pre></div>
</div>
<p>To save some time, the <code class="docutils literal"><span class="pre">hexdigest()</span></code> returns a length 32 hex string. In the comparison to <code class="docutils literal"><span class="pre">new(username).hexdigest()</span></code> there are 30 in the string constants meaning 1 each are needed from <code class="docutils literal"><span class="pre">x[7:8]</span></code> and <code class="docutils literal"><span class="pre">x[4:5]</span></code>, meaning string <code class="docutils literal"><span class="pre">x</span></code> must be at least 8 characters long. Looking at the 8th character computation, the only <code class="docutils literal"><span class="pre">password[0:3]</span></code> that could not throw an exception is 648. And for 648 the value of <code class="docutils literal"><span class="pre">x</span></code> is “tryharder”. So then the password is ‘648tryharder’ and the username hash is ‘3e3a378c63aa1e55e3e9ae9d2bdcd6a1’. Looking up the hash at a <a class="reference external" href="https://www.google.com/search?q=python+add+2+chr&amp;oq=python+add+2+chr&amp;aqs=chrome..69i57.9137j0j4&amp;sourceid=chrome&amp;es_sm=122&amp;ie=UTF-8#q=reverse+md5+hash">reverse hash calculator</a> the username is revealed to be ‘lamer’.</p>
</div>
<div class="section" id="id34">
<h2>3.28.13. <a class="reference external" href="http://www.try2hack.nl/levels/level13-olwehfdow.xhtml">Level 13</a><a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/dsolstad/walkthrough-try2hack.nl/blob/master/level13.md">Level 13 hint</a></div>
<div class="line">Last Password = “f1ff950850ac2f1f51fa82d839f0bd1b”</div>
</div>
<p>The downloaded file is a Linux ext3 filesystem copy needing journal recovery. Since the recovery would potentially remove some data, mount the filesystem using a backup superblock (after having located the alternate superblocks using <code class="docutils literal"><span class="pre">mkfs</span> <span class="pre">-n</span></code>.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~$ #</span> We have an ext3 filesystem with errors
<span class="gp">me@myhost:~$</span> file level13
<span class="go">level13: Linux rev 1.0 ext3 filesystem data, UUID=568b6779-f529-4164-8526-c1053a745272 (needs journal recovery)</span>

<span class="gp">me@myhost:~$ #</span> Get the superblock locations in <span class="k">case</span> bad sb
<span class="gp">me@myhost:~$</span> sudo /sbin/mkfs -n level13
<span class="go">mke2fs 1.42.10 (18-May-2014)</span>
<span class="go">level13 contains a ext3 file system</span>
<span class="go">  last mounted on Sat Jul 13 05:34:57 2013</span>
<span class="go">Proceed anyway? (y,n) y</span>
<span class="go">Creating filesystem with 70584 1k blocks and 17712 inodes</span>
<span class="go">Filesystem UUID: 062393d9-a4bb-4a1d-94f0-28f27052dd3e</span>
<span class="go">Superblock backups stored on blocks:</span>
<span class="go">  8193, 24577, 40961, 57345</span>

<span class="gp">me@myhost:~$ #</span> Mount it using alternate sb <span class="o">(</span>just to show how<span class="o">)</span>
<span class="gp">me@myhost:~$ #</span>   <span class="s2">&quot;ro,noload&quot;</span> stops journal replay
<span class="gp">me@myhost:~$</span> sudo mount  -o loop,ro,sb<span class="o">=</span><span class="m">40961</span>,noload     level13 /mnt

<span class="gp">me@myhost:/mnt/home/lamer$ #</span> Now look around
<span class="gp">me@myhost:/mnt/home/lamer$</span> <span class="nb">cd</span> /mnt/home/lamer
<span class="gp">me@myhost:/mnt/home/lamer$</span> ls -al
<span class="go">total 1076</span>
<span class="go">drwxr-xr-x 2 root root    1024 Jul 13  2013 .</span>
<span class="go">drwxr-xr-x 3 root root    1024 Jul 13  2013 ..</span>
<span class="go">-rwxr-xr-x 1 root root      10 Jul 13  2013 .password_part1.txt</span>
<span class="go">-rwxr-xr-x 1 root root     738 Jul 13  2013 .password_part3.gif</span>
<span class="go">-rw-r--r-- 1 root root 1091321 Jul 13  2013 tlk-0.8-3.pdf</span>
<span class="gp">me@myhost:/mnt/home/lamer$</span>
<span class="gp">me@myhost:/mnt/home/lamer$</span> cat .password_part1.txt
<span class="go">f1ff95085</span>
<span class="gp">me@myhost:/mnt/home/lamer$</span> sudo umount /mnt
</pre></div>
</div>
<p>So the first (“f1ff95085”) of 3 parts to the password with only the first part being easy. No amount of looking at .password_part3.gif (even with a hex viewer like <code class="docutils literal"><span class="pre">dhex</span></code>) revealed any hidden data: no appended zip file, no embedded text. At this level it’s just an ordinary GIF89a file. Since the filesystem has corruption, perhaps that’s where we can find the missing .password_part2.???.</p>
<p>Use <code class="docutils literal"><span class="pre">debugfs</span></code> to analyze “level13”. First get <code class="docutils literal"><span class="pre">ls</span> <span class="pre">-l</span> <span class="pre">/home/lamer</span></code> to get the inodes and blocks for the files.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">me@myhost:~$</span> /sbin/debugfs level13
<span class="go">debugfs 1.42.10 (18-May-2014)</span>
<span class="go">debugfs:  ls -l /home/lamer</span>
<span class="go">  11810   40755 (2)      0      0    1024 13-Jul-2013 05:43 .</span>
<span class="go">  11809   40755 (2)      0      0    1024 13-Jul-2013 05:40 ..</span>
<span class="go">  11811  100644 (1)      0      0   1091321 13-Jul-2013 05:41 tlk-0.8-3.pdf</span>
<span class="go">  11812  100755 (1)      0      0     738 13-Jul-2013 05:42 .password_part3.gif</span>
<span class="go">  11813  100755 (1)      0      0      10 13-Jul-2013 05:43 .password_part1.txt</span>

<span class="go">debugfs:  blocks &lt;11810&gt;</span>
<span class="go">51713</span>
<span class="go">debugfs:  blocks &lt;11812&gt;</span>
<span class="go">56321</span>
<span class="go">debugfs:  blocks &lt;11813&gt;</span>
<span class="go">49401</span>
</pre></div>
</div>
<p>We’re not interested in <code class="docutils literal"><span class="pre">.password_part1.txt</span></code> so dump out the blocks for <code class="docutils literal"><span class="pre">.password_part3.gif</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">debugfs:  bd 56321</span>
<span class="go">0000  4749 4638 3961 7800 2d00 a500 00ff ffff  GIF89ax.-.......</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">1360  0000 0000 0000 0000 0000 0000 0000 0000  ................</span>
<span class="go">*</span>
<span class="go">1520  0000 6138 3264 3833 3966 3062 6431 620a  ..a82d839f0bd1b.</span>
<span class="go">1540  0000 0000 0000 0000 0000 0000 0000 0000  ................</span>
<span class="go">*</span>
</pre></div>
</div>
<p>There’s some new data (“a82d839f0bd1b”) at the end of <code class="docutils literal"><span class="pre">.password_part3.gif</span></code> which we’ll assume is part 3 of the password. So where is part 2? Let’s dump out the /home/lamer directory to look for a lost/deleted part2:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">debugfs:  bd 51713</span>
<span class="go">0000  222e 0000 0c00 0102 2e00 0000 212e 0000  &quot;...........!...</span>
<span class="go">0020  0c00 0202 2e2e 0000 232e 0000 1800 0d01  ........#.......</span>
<span class="go">0040  746c 6b2d 302e 382d 332e 7064 6600 0000  tlk-0.8-3.pdf...</span>
<span class="go">0060  242e 0000 1c00 1301 2e70 6173 7377 6f72  $........passwor</span>
<span class="go">0100  645f 7061 7274 332e 6769 6600 252e 0000  d_part3.gif.%...</span>
<span class="go">0120  b403 1301 2e70 6173 7377 6f72 645f 7061  .....password_pa</span>
<span class="go">0140  7274 312e 7478 7400 dd2e 0000 9803 1301  rt1.txt.........</span>
<span class="go">0160  2e70 6173 7377 6f72 645f 7061 7274 322e  .password_part2.</span>
<span class="go">0200  7478 7400 0000 0000 0000 0000 0000 0000  txt.............</span>
<span class="go">0220  0000 0000 0000 0000 0000 0000 0000 0000  ................</span>
<span class="go">*</span>

<span class="go">debugfs:  blocks &lt;11997&gt;</span>
</pre></div>
</div>
<p>There goes <code class="docutils literal"><span class="pre">.password_part2.txt</span></code> preceded by its little-endian inode, here dd2e = 0x2edd = 11997. However <code class="docutils literal"><span class="pre">blocks</span> <span class="pre">&lt;11997&gt;</span></code> shows there are no data blocks associated with inode 11997. So let’s look at the journal log to see if there is anything to help with indoe 11997.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">debugfs:  logdump -i &lt;11997&gt;</span>
<span class="go">Inode 11997 is at group 6, block 49178, offset 512</span>
<span class="go">Journal starts at block 1, transaction 2</span>
<span class="go">  FS block 49178 logged at sequence 11, journal block 1306 (flags 0x2)</span>
<span class="go">    (inode block for inode 11997):</span>
<span class="go">    Inode: 11997   Type: bad type        Mode:  0000   Flags: 0x0</span>
<span class="go">    Generation: 0    Version: 0x00000000</span>
<span class="go">    User:     0   Group:     0   Size: 0</span>
<span class="go">    File ACL: 0    Directory ACL: 0</span>
<span class="go">    Links: 0   Blockcount: 0</span>
<span class="go">    Fragment:  Address: 0    Number: 0    Size: 0</span>
<span class="go">    ctime: 0x00000000 -- Wed Dec 31 16:00:00 1969</span>
<span class="go">    atime: 0x00000000 -- Wed Dec 31 16:00:00 1969</span>
<span class="go">    mtime: 0x00000000 -- Wed Dec 31 16:00:00 1969</span>
<span class="go">    Blocks:</span>
<span class="go">  FS block 49178 logged at sequence 12, journal block 1312 (flags 0x2)</span>
<span class="go">    (inode block for inode 11997):</span>
<span class="go">    Inode: 11997   Type: regular        Mode:  0644   Flags: 0x0</span>
<span class="go">    Generation: 1644872278    Version: 0x00000000</span>
<span class="go">    User:     0   Group:     0   Size: 11</span>
<span class="go">    File ACL: 0    Directory ACL: 0</span>
<span class="go">    Links: 1   Blockcount: 2</span>
<span class="go">    Fragment:  Address: 0    Number: 0    Size: 0</span>
<span class="go">    ctime: 0x51e14b6d -- Sat Jul 13 05:43:25 2013</span>
<span class="go">    atime: 0x51e14b6d -- Sat Jul 13 05:43:25 2013</span>
<span class="go">    mtime: 0x51e14b6d -- Sat Jul 13 05:43:25 2013</span>
<span class="go">    Blocks:  (0+1): 60582</span>
<span class="go">  FS block 49178 logged at sequence 13, journal block 1319 (flags 0xa)</span>
<span class="go">    (inode block for inode 11997):</span>
<span class="go">    Inode: 11997   Type: regular        Mode:  0644   Flags: 0x0</span>
<span class="go">    Generation: 1644872278    Version: 0x00000000</span>
<span class="go">    User:     0   Group:     0   Size: 11</span>
<span class="go">    File ACL: 0    Directory ACL: 0</span>
<span class="go">    Links: 1   Blockcount: 2</span>
<span class="go">    Fragment:  Address: 0    Number: 0    Size: 0</span>
<span class="go">    ctime: 0x51e14b6d -- Sat Jul 13 05:43:25 2013</span>
<span class="go">    atime: 0x51e14b73 -- Sat Jul 13 05:43:31 2013</span>
<span class="go">    mtime: 0x51e14b6d -- Sat Jul 13 05:43:25 2013</span>
<span class="go">    Blocks:  (0+1): 60582</span>
<span class="go">  FS block 49178 logged at sequence 14, journal block 1326 (flags 0x2)</span>
<span class="go">    (inode block for inode 11997):</span>
<span class="go">    Inode: 11997   Type: regular        Mode:  0644   Flags: 0x0</span>
<span class="go">    Generation: 1644872278    Version: 0x00000000</span>
<span class="go">    User:     0   Group:     0   Size: 0</span>
<span class="go">    File ACL: 0    Directory ACL: 0</span>
<span class="go">    Links: 0   Blockcount: 0</span>
<span class="go">    Fragment:  Address: 0    Number: 0    Size: 0</span>
<span class="go">    ctime: 0x51e14b88 -- Sat Jul 13 05:43:52 2013</span>
<span class="go">    atime: 0x51e14b73 -- Sat Jul 13 05:43:31 2013</span>
<span class="go">    mtime: 0x51e14b88 -- Sat Jul 13 05:43:52 2013</span>
<span class="go">    dtime: 0x51e14b88 -- Sat Jul 13 05:43:52 2013</span>
<span class="go">    Blocks:</span>
<span class="go">No magic number at block 1331: end of journal.</span>
</pre></div>
</div>
<p>Key are the “Blocks:  (0+1): 60582” lines above in the 2nd &amp; 3rd journal records. If we dump that block we’ll see our lost data.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">debugfs:  bd 60582</span>
<span class="go">0000  3061 6332 6631 6635 3166 0a00 0000 0000  0ac2f1f51f......</span>
<span class="go">0020  0000 0000 0000 0000 0000 0000 0000 0000  ................</span>
<span class="go">*</span>
</pre></div>
</div>
<p>So part 2 of our password is “0ac2f1f51f”. Combining the three parts we get “f1ff950850ac2f1f51fa82d839f0bd1b” which is the desired password. It is a 32 character hex number which looks suspiciously like an MD5 hashcode, which we look up at an online MD5 decrypter site to get “forthelulz”.</p>
<p>Note that you’re not reduced to reading directory bits, and an alternative to this last bit of bit-picking is to simply recover the lost file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ext3grep level13 --restore-file home/lamer/.password_part2.txt
cat RESTORED_FILES/home/lamer/.password_part2.txt
</pre></div>
</div>
</div>
<div class="section" id="id35">
<h2>3.28.14. <a class="reference external" href="http://www.try2hack.nl/levels/level14-f5c1db.xhtml">Level 14</a><a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h2>
<p>Our last link says Level 14 is not finished yet, come <a class="reference external" href="http://www.try2hack.nl/chat/">chat</a> with us in the meanwhile.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pentest_encryption.html" class="btn btn-neutral float-right" title="4. Encryption" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="natas.html" class="btn btn-neutral" title="3.27. Natas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>