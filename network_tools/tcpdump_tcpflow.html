

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.15. tcpdump &amp; tcpflow &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.3 documentation" href="../index.html"/>
        <link rel="up" title="6. Pentest Network Tools" href="../pentest_network_tools.html"/>
        <link rel="next" title="6.16. Tunneling Traffic" href="tunneling_traffic.html"/>
        <link rel="prev" title="6.14. sqlmap" href="sqlmap.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aircrack-ng.html">6.1. aircrack-ng</a></li>
<li class="toctree-l2"><a class="reference internal" href="beef.html">6.2. BeEF</a></li>
<li class="toctree-l2"><a class="reference internal" href="burp_suite.html">6.3. Burp Suite and ZAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="curl.html">6.4. curl</a></li>
<li class="toctree-l2"><a class="reference internal" href="drive_droid_kon-boot.html">6.5. DriveDroid &amp; Kon-Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="mana.html">6.6. mana</a></li>
<li class="toctree-l2"><a class="reference internal" href="nmap.html">6.7. nmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="openvas.html">6.8. OpenVAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="pcredz.html">6.9. Pcredz pcap credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="hak5_pineapple.html">6.10. Hak5 Pineapple</a></li>
<li class="toctree-l2"><a class="reference internal" href="proxychains.html">6.11. Proxy Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="responder.html">6.12. Responder</a></li>
<li class="toctree-l2"><a class="reference internal" href="socat.html">6.13. <code class="docutils literal"><span class="pre">socat</span></code> vs (<code class="docutils literal"><span class="pre">nc</span></code> vs <code class="docutils literal"><span class="pre">ncat</span></code> vs <code class="docutils literal"><span class="pre">netcat</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqlmap.html">6.14. sqlmap</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.15. tcpdump &amp; tcpflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="tunneling_traffic.html">6.16. Tunneling Traffic</a></li>
<li class="toctree-l2"><a class="reference internal" href="webgoat.html">6.17. Web Goat</a></li>
<li class="toctree-l2"><a class="reference internal" href="wireshark.html">6.18. Wireshark</a></li>
<li class="toctree-l2"><a class="reference internal" href="xsscrapy.html">6.19. xsscrapy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_network_tools.html">6. Pentest Network Tools</a> &raquo;</li>
        
      <li>6.15. tcpdump &amp; tcpflow</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/network_tools/tcpdump_tcpflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tcpdump-tcpflow">
<h1>6.15. <a class="reference external" href="http://www.tcpdump.org/">tcpdump</a> &amp; <a class="reference external" href="https://github.com/simsong/tcpflow">tcpflow</a><a class="headerlink" href="#tcpdump-tcpflow" title="Permalink to this headline">Â¶</a></h1>
<p>From the <a class="reference external" href="http://wiki.wireshark.org/TcpDump">tcpdump Wireshark wiki entry</a>:</p>
<blockquote>
<div><p>TcpDump lives at www.tcpdump.org</p>
<p>TcpDump is also the place where LibPcap lives; LibPcap is the standard API and CaptureFile format used by Wireshark and TShark as well as many many other tools.</p>
<p>If you do a lot of network capturing it is well worth the effort to learn all the command line switches to TcpDump for the same reason learning VI is useful. This tool will be there for almost all Un*xen you will find, TShark might not.</p>
</div></blockquote>
<p><a class="reference external" href="https://www.wireshark.org/docs/man-pages/tshark.html">tshark</a> is the command line version of <a class="reference external" href="https://www.wireshark.org/docs/wsug_html_chunked/">Wireshark</a>, and is well worth learning in its own right.</p>
<p>Here are a few key points to remember about <code class="docutils literal"><span class="pre">tcpdump</span></code>:</p>
<ul>
<li><p class="first">Capture to file (<strong>-w file</strong>) and replay from file (<strong>-r file</strong>)</p>
<p><code class="docutils literal"><span class="pre">tcpdump</span></code> can capture packets to a file in standard pcap format for later replay by any pcap-compliant network analyzer. That includes not only <code class="docutils literal"><span class="pre">tcpdump</span></code> but also <code class="docutils literal"><span class="pre">tcpflow</span></code>, <code class="docutils literal"><span class="pre">tcpjoin</span></code>, <code class="docutils literal"><span class="pre">tcpslice</span></code>, and more.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">tcpdump</span></code> option <strong>-s 0</strong> insures that captured packets are not truncated.</p>
</li>
</ul>
<p>Here are a few examples:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Capture all DNS traffic</span>
tcpdump -s <span class="m">0</span> -w dns.pcap port <span class="m">53</span>

<span class="c1"># Playback requests going to Google DNS</span>
tcpdump -X -r dns.pcap host <span class="m">8</span>.8.8.8 or host <span class="m">8</span>.8.4.4

<span class="c1"># Capture all IPv4 HTTP packets to a file</span>
tcpdump -s <span class="m">0</span> -w http.pcap tcp port <span class="m">80</span>

<span class="c1"># Playback only IPv4 HTTP packets containing data (not SYN, FIN, ACK-only).</span>
<span class="c1"># Check for data by taking IP packet total length - IP header - TCP header &gt; 0.</span>
<span class="c1">#   tcpdump expressions can have PROTO[OFFSET:SIZE]</span>
<span class="c1">#     PROTO = protocol from IP, TCP, UDP, or ICMP</span>
<span class="c1">#     OFFSET = octet (byte) offset in PROTO part of packet</span>
<span class="c1">#     SIZE = number of octets</span>
<span class="c1">#  ip[2:2] = IP header total length</span>
<span class="c1">#  ip[0]&amp;0xf = IP header 4 bit IHL (IP header length)</span>
<span class="c1">#  So the difference of the above 2 is the IP packet size without the header</span>
<span class="c1">#  tcp[12] &amp; 0xf0 = offset &gt;&gt;2</span>
<span class="c1">#  So (tcp[12] &amp; 0xf0) &lt;&lt; 2 = offset = header length</span>
<span class="c1">#  So the end result is the amount of data bytes.</span>
<span class="c1"># NOTE - single quotes mean to escaping needed</span>
tcpdump -X -r http.pcap <span class="s1">&#39;(((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)&#39;</span>

<span class="c1"># Break http.pcap into flows in subdirectory flows</span>
tcpflow -r http.pcap -o flows -a
<span class="c1"># Look at the report</span>
evince flows/report.pdf <span class="p">&amp;</span>
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tunneling_traffic.html" class="btn btn-neutral float-right" title="6.16. Tunneling Traffic" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sqlmap.html" class="btn btn-neutral" title="6.14. sqlmap" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>