

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7.3. recon-ng &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.3 documentation" href="../index.html"/>
        <link rel="up" title="7. Pentest Reconnaisance" href="../pentest_recon.html"/>
        <link rel="next" title="8. Pentest Study" href="../pentest_study.html"/>
        <link rel="prev" title="7.2. one-off tools" href="one-off.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_html.html">5. HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hackback.html">7.1. HackBack!</a></li>
<li class="toctree-l2"><a class="reference internal" href="one-off.html">7.2. one-off tools</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">7.3. recon-ng</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#recon-ng-overview">7.3.1. recon-ng overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#before-using-recon-ng">7.3.2. Before using recon-ng</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#getting-used-recon-ng">7.3.2.1. Getting used <code class="docutils literal"><span class="pre">recon-ng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modules-tables-keys">7.3.2.2. Modules, tables, keys, …</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-recon-ng-global-data">7.3.2.3. Setting up <code class="docutils literal"><span class="pre">recon-ng</span></code> global data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-seed-data-for-recon-ng">7.3.2.4. Getting seed data for <code class="docutils literal"><span class="pre">recon-ng</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#leverage-known-netblocks">7.3.2.5. Leverage known netblocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-brute-forcing-tlds-and-slds">7.3.2.6. DNS brute forcing TLDs and SLDs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-host-gathering-modules">7.3.2.7. Run host gathering modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resolve-host-ips">7.3.2.8. Resolve host IPs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-vhost-enumeration-modules">7.3.2.9. Run vhost enumeration modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-port-scans">7.3.2.10. Run port scans</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-vulnerability-harvesting-modules">7.3.2.11. Run vulnerability harvesting modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resolve-geolocations-of-harvested-locations">7.3.2.12. Resolve geolocations of harvested locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-distinct-locations-to-the-db">7.3.2.13. Add distinct locations to the db</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-contact-harvesting-modules">7.3.2.14. Run contact harvesting modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mangle-contacts-into-email-addresses">7.3.2.15. Mangle contacts into email addresses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-modules-that-convert-email-addresses-into-full-contacts">7.3.2.16. Run modules that convert email addresses into full contacts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-credential-harvesting-modules">7.3.2.17. Run credential harvesting modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-pushpins">7.3.2.18. Generate pushpins</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-reports">7.3.2.19. Generate reports</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tables-needing-seed-updated-missing">7.3.3. Tables needing seed, updated, missing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_recon.html">7. Pentest Reconnaisance</a> &raquo;</li>
        
      <li>7.3. recon-ng</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/recon/recon-ng.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="recon-ng-example">
<span id="id21"></span><h1>7.3. recon-ng<a class="headerlink" href="#recon-ng-example" title="Permalink to this headline">¶</a></h1>
<div class="section" id="recon-ng-overview">
<h2>7.3.1. recon-ng overview<a class="headerlink" href="#recon-ng-overview" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://bitbucket.org/LaNMaSteR53/recon-ng/wiki/Usage%20Guide">recon-ng</a> performs web-based reconnaisance and information gathering as a precursor to using <a class="reference external" href="http://www.metasploit.com/">Metasploit</a> and the <a class="reference external" href="https://www.trustedsec.com/downloads/social-engineer-toolkit/">Social-Engineering Toolkit</a>. It can fit into and expand the information gathering part of the <a class="reference external" href="https://www.owasp.org/index.php/Web_Application_Penetration_Testing">OWASP Web Application Penetration Testing Guide</a>. It requires some prior manual reconnaisance for seed data: companies, domains, locations, and netblocks. From there it can be used to expand the domains; provide contacts, hosts, and ports; limited leaks and vulnerabilites; and pushpins (geographically tagged data such as tweets and photos).</p>
<p>recon-ng’s interface has radically changed with v4.0.0. All users should review <a class="reference external" href="http://www.lanmaster53.com/2014/05/recon-ng-update/">Recon-ng Update</a> to understand the new interface and how to use <code class="docutils literal"><span class="pre">recon-ng</span></code>. Since <code class="docutils literal"><span class="pre">recon-ng</span></code> does lots of screen-scraping you can expect it to be unstable due to web site changes.</p>
<p>It comes installed with Kali linux and can easily be installed on Debian via:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/local/bin
sudo git clone https://bitbucket.org/LaNMaSteR53/recon-ng.git git.recon-ng
sudo ln -s git.recon-ng/recon-ng .
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">recon-ng</span></code> is designed to facilitate working on several distinct, simultaneous pentest projects. It has both global (per-pentester) data and per-workspace (aka per-project) data.</p>
<blockquote>
<div><p>The global data consists of keys (authentication information) for online api’s required by some of <code class="docutils literal"><span class="pre">recon-ng</span></code>’s modules. These are unique for each pentester and don’t change between projects. They are stored in the SQLite database <strong>$HOME/.recon-ng/keys.db</strong> and viewed via <code class="docutils literal"><span class="pre">show</span> <span class="pre">keys</span></code>.</p>
<blockquote>
<div><p>See <code class="docutils literal"><span class="pre">help</span> <span class="pre">keys</span></code>, <code class="docutils literal"><span class="pre">show</span> <span class="pre">keys</span></code>, and <a class="reference external" href="https://bitbucket.org/LaNMaSteR53/recon-ng/wiki/Usage%20Guide#!acquiring-api-keys">recon-ng Wiki Acquiring API Keys</a> for details. Currently the following keys are free:</p>
<div class="line-block">
<div class="line"><a class="reference external" href="http://datamarket.azure.com/dataset/bing/search">bing API</a></div>
<div class="line"><a class="reference external" href="https://developers.facebook.com">facebook API</a> <strong>NOTE</strong> currently only the <strong>facebook_username</strong> and <strong>facebook_password</strong> keys are used (<strong>facebook_api</strong> and <strong>facebook_secret</strong> are ignored)</div>
<div class="line"><a class="reference external" href="https://dev.twitter.com/apps">twitter API</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference external" href="https://console.developers.google.com/">google API</a> - create project, enable custom search API, add search with bogus site, edit site by selecting “Search the entier web …” along with deleting bogus site. Under “Credentials”, “Create new Key” (client key allowed from <em>/</em>) and enter via <strong>keys add google_api KEY</strong>. For your custom search, get its custom url and enter the “cx” value via <strong>keys add google_cse CX</strong>.</div>
</div>
<p>And the following keys are not free or require vetting/contact:</p>
<div class="line-block">
<div class="line"><a class="reference external" href="https://builtwith.com/plans">built with</a></div>
<div class="line"><a class="reference external" href="https://www.flickr.com/services/api/misc.api_keys.html">flickr</a> requires approval</div>
<div class="line"><a class="reference external" href="https://connect.data.com/registration/signup">jigsaw API - salesforce data.com</a></div>
<div class="line">Linked-in requires vetting</div>
<div class="line"><a class="reference external" href="https://pwnedlist.com/contact">PwnedList</a> requires contact for API access</div>
<div class="line"><a class="reference external" href="https://developer.shodan.io/pricing">shodan</a></div>
</div>
</div></blockquote>
<p>The per-workspace data are stored in a SQLite database <strong>$HOME/.recon-ng/workspaces/WORKSPACENAME/data.db</strong>: tables for companies, contacts, credentials, domains, hosts, leaks, locations, netblocks, options, ports, pushpins, and vulnderabilites. Workspaces allow simultaneously performing several distinct recon efforts on the same computer. At the start of each <code class="docutils literal"><span class="pre">recon-ng</span></code> project, create &amp; use a new project workspace via <code class="docutils literal"><span class="pre">workspaces</span> <span class="pre">add</span> <span class="pre">PROJECT</span></code> then <code class="docutils literal"><span class="pre">workspaces</span> <span class="pre">select</span> <span class="pre">PROJECT</span></code>. Use <code class="docutils literal"><span class="pre">help</span></code> to show the <code class="docutils literal"><span class="pre">recon-ng</span></code> commands and <code class="docutils literal"><span class="pre">show</span> <span class="pre">modules</span></code> for the <code class="docutils literal"><span class="pre">recon-ng</span></code> modules available.</p>
</div></blockquote>
</div>
<div class="section" id="before-using-recon-ng">
<h2>7.3.2. Before using recon-ng<a class="headerlink" href="#before-using-recon-ng" title="Permalink to this headline">¶</a></h2>
<div class="section" id="getting-used-recon-ng">
<h3>7.3.2.1. Getting used <code class="docutils literal"><span class="pre">recon-ng</span></code><a class="headerlink" href="#getting-used-recon-ng" title="Permalink to this headline">¶</a></h3>
<p>Module names reflect the python module directory structure:</p>
<ul>
<li><p class="first">Module category:</p>
<p>The first directory selects one of these categories of modules: discovery, exploitation, import, recon (the bulk of modules), and reporting.</p>
</li>
<li><p class="first">Input-Output (only recon category):</p>
<p>The second directory for recon category shows the input and output tables. So “recon/domains-hosts/…” inputs the domains table to update the hosts table. The other categories skip this level.</p>
</li>
<li><p class="first">Source (recon-only category):</p>
<p>The third level reflects the information source, for example “recon/domains-hosts/netcraft”.</p>
</li>
</ul>
<p><code class="docutils literal"><span class="pre">recon-ng</span></code> has tab-completion and allows short names or searching for names. For example, to find commands that recon for hosts, enter <code class="docutils literal"><span class="pre">search</span> <span class="pre">-hosts</span></code>. And <code class="docutils literal"><span class="pre">use</span> <span class="pre">netcraft</span></code> is equivalent to <code class="docutils literal"><span class="pre">use</span> <span class="pre">recon/domains-hosts/netcraft</span></code>.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -hosts</span>
<span class="go">[*] Searching for &#39;-hosts&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/domains-hosts/baidu_site</span>
<span class="go">    recon/domains-hosts/bing_domain_api</span>
<span class="go">    recon/domains-hosts/bing_domain_web</span>
<span class="go">    recon/domains-hosts/brute_hosts</span>
<span class="go">    recon/domains-hosts/google_site_api</span>
<span class="go">    recon/domains-hosts/google_site_web</span>
<span class="go">    recon/domains-hosts/netcraft</span>
<span class="go">    recon/domains-hosts/shodan_hostname</span>
<span class="go">    recon/domains-hosts/ssl_san</span>
<span class="go">    recon/domains-hosts/vpnhunter</span>
<span class="go">    recon/domains-hosts/yahoo_site</span>
<span class="go">    recon/hosts-hosts/bing_ip</span>
<span class="go">    recon/hosts-hosts/ip_neighbor</span>
<span class="go">    recon/hosts-hosts/ipinfodb</span>
<span class="go">    recon/hosts-hosts/resolve</span>
<span class="go">    recon/hosts-hosts/reverse_resolve</span>
<span class="go">    recon/netblocks-hosts/reverse_resolve</span>
<span class="go">    recon/netblocks-hosts/shodan_net</span>
<span class="go">[recon-ng][example.com] &gt; use netcraft</span>
<span class="go">[recon-ng][example.com][netcraft] &gt;</span>
</pre></div>
</div>
<p>The typical module usage pattern is <code class="docutils literal"><span class="pre">use</span> <span class="pre">MODULE</span></code>, <code class="docutils literal"><span class="pre">show</span> <span class="pre">info</span></code>, <code class="docutils literal"><span class="pre">set</span> <span class="pre">PARM</span> <span class="pre">VALUE</span></code>, <code class="docutils literal"><span class="pre">run</span></code>, then <code class="docutils literal"><span class="pre">back</span></code> to get to the global scope.</p>
<p>And you can run shell commands via <code class="docutils literal"><span class="pre">shell</span></code> or when it doesn’t match an existing <code class="docutils literal"><span class="pre">recon-ng</span></code> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example2.org][netcraft] &gt; shell ls -l /usr/local/bin</span>
<span class="go">[*] Command: ls -l /usr/local/bin</span>
<span class="go">total 1084</span>
<span class="go">drwxr-sr-x 1 root staff     188 Aug  4 23:40 git.recon-ng</span>
<span class="go">lrwxrwxrwx 1 root staff      21 Aug  4 23:49 recon-ng -&gt; git.recon-ng/recon-ng</span>
<span class="go">[recon-ng][example2.org][netcraft] &gt; ls -laR ~/.recon-ng</span>
<span class="go">[*] Command: ls -laR ~/.recon-ng</span>
<span class="go">/home/me/.recon-ng:</span>
<span class="go">total 8</span>
<span class="go">drwxr-xr-x 1 me  me    34 Aug  7 12:01 .</span>
<span class="go">drwxr-xr-x 1 me  me  1092 Aug  9 09:09 ..</span>
<span class="go">-rw-r--r-- 1 me  me  5120 Aug  7 12:01 keys.db</span>
<span class="go">drwxr-xr-x 1 me  me    84 Aug  8 21:17 workspaces</span>

<span class="go">/home/me/.recon-ng/workspaces:</span>
<span class="go">total 0</span>
<span class="go">drwxr-xr-x 1 me  me  84 Aug  8 21:17 .</span>
<span class="go">drwxr-xr-x 1 me  me  34 Aug  7 12:01 ..</span>
<span class="go">drwxr-xr-x 1 me  me  14 Aug  6 12:09 default</span>
<span class="go">drwxr-xr-x 1 me  me  14 Aug  8 23:22 example.com</span>

<span class="go">/home/me/.recon-ng/workspaces/default:</span>
<span class="go">total 16</span>
<span class="go">drwxr-xr-x 1 me  me     14 Aug  6 12:09 .</span>
<span class="go">drwxr-xr-x 1 me  me     84 Aug  8 21:17 ..</span>
<span class="go">-rw-r--r-- 1 me  me  16384 Aug  6 12:09 data.db</span>

<span class="go">/home/me/.recon-ng/workspaces/example.com:</span>
<span class="go">total 16</span>
<span class="go">drwxr-xr-x 1 me  me     14 Aug  8 23:22 .</span>
<span class="go">drwxr-xr-x 1 me  me     84 Aug  8 21:17 ..</span>
<span class="go">-rw-r--r-- 1 me  me  16384 Aug  8 23:22 data.db</span>
</pre></div>
</div>
<p>And you can save commands to a file and rerun them:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example2.org][netcraft] &gt; back</span>
<span class="go">[recon-ng][example2.org] &gt; record start saveme.txt</span>
<span class="go">[*] Recording commands to &#39;saveme.txt&#39;.</span>
<span class="go">[recon-ng][example2.org] &gt; use netcraft</span>
<span class="go">[recon-ng][example2.org][netcraft] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example2.org][netcraft] &gt; back</span>
<span class="go">[recon-ng][example2.org] &gt; record stop</span>
<span class="go">[*] Recording stopped. Commands saved to &#39;saveme.txt&#39;.</span>
<span class="go">[recon-ng][example2.org] &gt; cat saveme.txt</span>
<span class="go">[*] Command: cat saveme.txt</span>
<span class="go">use netcraft</span>
<span class="go">run</span>
<span class="go">back</span>
<span class="go">record stop</span>
<span class="go">[recon-ng][example2.org] &gt; resource saveme.txt</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example2.org][netcraft] &gt; back</span>
<span class="go">[recon-ng][example2.org] &gt; record stop</span>
<span class="go">[*] Recording is already stopped.</span>
<span class="go">[recon-ng][example2.org] &gt; EOF</span>
</pre></div>
</div>
</div>
<div class="section" id="modules-tables-keys">
<h3>7.3.2.2. Modules, tables, keys, …<a class="headerlink" href="#modules-tables-keys" title="Permalink to this headline">¶</a></h3>
<p>Run <code class="docutils literal"><span class="pre">help</span></code> and <code class="docutils literal"><span class="pre">show</span></code>, followed by running most of the listed commands to get used to the interface.</p>
</div>
<div class="section" id="setting-up-recon-ng-global-data">
<h3>7.3.2.3. Setting up <code class="docutils literal"><span class="pre">recon-ng</span></code> global data<a class="headerlink" href="#setting-up-recon-ng-global-data" title="Permalink to this headline">¶</a></h3>
<p>Run the <code class="docutils literal"><span class="pre">recon-ng</span></code> command <strong>show keys</strong> to list <code class="docutils literal"><span class="pre">recon-ng</span></code>’s global web API accounts. They are (or should be) described in <a class="reference external" href="https://bitbucket.org/LaNMaSteR53/recon-ng/wiki/Usage%20Guide#!acquiring-api-keys">recon-ng Wiki Acquiring API Keys</a>. Not all the accounts are freely available: some charge or go through an approval process. The following keys are currently free and available without an approval cycle: bing_api, facebook_password/facebook_username, google_api/google-cse, rapportive_token (automatically saved by <code class="docutils literal"><span class="pre">recon-ng</span></code>), and twitter_api/twitter_secret/twitter_token. Here is an example of setting up the facebook_username/facebook_password:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][default] &gt; show keys</span>
<span class="go">[recon-ng][default] &gt; keys add facebook_username FACEBOOKUSER</span>
<span class="go">[recon-ng][default] &gt; keys add facebook_password FACEBOOKPW</span>
<span class="go">[recon-ng][default] &gt; show keys</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-seed-data-for-recon-ng">
<h3>7.3.2.4. Getting seed data for <code class="docutils literal"><span class="pre">recon-ng</span></code><a class="headerlink" href="#getting-seed-data-for-recon-ng" title="Permalink to this headline">¶</a></h3>
<p>Google search for company “Sample Company” finds <strong>www.example.com</strong> along with the company name and locations and “Sample Company Europe” at <strong>www.exampleeurope.com</strong>. Start by updating the <strong>companies</strong> and <strong>locations</strong> tables.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][default] &gt; workspaces add example.com</span>
<span class="go">[recon-ng][example.com] &gt; add companies Sample Company~100 employees</span>
<span class="go">[recon-ng][example.com] &gt; add locations ~~123 Maple Street, Anytown, CA 12345</span>
<span class="go">[recon-ng][example.com] &gt; add locations ~~456 Elm Ave, Anothertown, CA 67890</span>
<span class="go">[recon-ng][example.com] &gt; add companies Sample Company Europe~Registration number: 1234567</span>
<span class="go">[recon-ng][example.com] &gt; add locations ~~Someplace in Europe, A Street, A City, A Country, 1234 5678</span>
</pre></div>
</div>
<p>Now search for more domains to add to <code class="docutils literal"><span class="pre">recon-ng</span></code> via Google searches for <strong>site:example.com -site:www.example.com</strong> and <strong>site:exampleeurope.com -site:www.exampleeurope.com</strong>. Note that some tables require specification of columns which are separated by the <a class="reference external" href="http://en.wikipedia.org/wiki/Tilde">tilde</a> “~” character.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; add domains example.com</span>
<span class="go">[recon-ng][example.com] &gt; add domains exampleeurope.com</span>
<span class="go">[recon-ng][example.com] &gt; add hosts www.example.com~~~~~</span>
<span class="go">[recon-ng][example.com] &gt; add hosts blog.example.com~~~~~</span>
<span class="go">[recon-ng][example.com] &gt; add hosts mail.example.com~~~~~</span>
<span class="go">[recon-ng][example.com] &gt; add hosts web.example.com~~~~~</span>
<span class="go">[recon-ng][example.com] &gt; add hosts example.com~~~~~</span>
<span class="go">[recon-ng][example.com] &gt; add hosts www.exampleeurope.com~~~~~</span>
</pre></div>
</div>
<p>As for netblocks, a quick visit to <a class="reference external" href="http://www.arin.net/">ARIN - American NIC</a> for <strong>Sample Company</strong> provides 2 netblocks and <a class="reference external" href="http://www.ripe.net/">RIPE NNC - Europe NIC</a> for <strong>Sample Company Europe</strong> provides no IPv4 netblocks.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">whois -h whois.arin.net -- &quot;Sample Company&quot;</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">Sample Company (C02345678) UU-1-2-3-4-D5 (NET-1-2-3-4-1) 1.2.3.0 - 1.2.3.31</span>
<span class="go">Sample Company (C03456789) example (NET-2-3-4-5-1) 2.3.4.0 - 2.3.4.7</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; add netblocks 1.2.3.0/27</span>
<span class="go">[recon-ng][example.com] &gt; add netblocks 2.3.4.10/29</span>
</pre></div>
</div>
</div>
<div class="section" id="leverage-known-netblocks">
<h3>7.3.2.5. Leverage known netblocks<a class="headerlink" href="#leverage-known-netblocks" title="Permalink to this headline">¶</a></h3>
<p>Try to get more information based on the known netblocks. Here we illustrate <code class="docutils literal"><span class="pre">show</span> <span class="pre">info</span></code> for a module to show the required input arguments. In the first case there are no more arguments to set.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search netblocks-</span>
<span class="go">[*] Searching for &#39;netblocks-&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/netblocks-hosts/reverse_resolve</span>
<span class="go">    recon/netblocks-hosts/shodan_net</span>
<span class="go">    recon/netblocks-ports/census_2012</span>

<span class="go">[recon-ng][example.com] &gt; use recon/netblocks-hosts/reverse_resolve</span>
<span class="go">[recon-ng][example.com][reverse_resolve] &gt; show info</span>

<span class="go">      Name: Reverse Resolver</span>
<span class="go">      Path: modules/recon/netblocks-hosts/reverse_resolve.py</span>
<span class="go">    Author: John Babio (@3vi1john)</span>

<span class="go">Description:</span>
<span class="go">  Conducts a reverse lookup for each of a netblock&#39;s IP addresses to resolve the hostname. Updates the</span>
<span class="go">  &#39;hosts&#39; table with the results.</span>

<span class="go">Options:</span>
<span class="go">  Name    Current Value  Req  Description</span>
<span class="go">  ------  -------------  ---  -----------</span>
<span class="go">  SOURCE  default        yes  source of input (see &#39;show info&#39; for details)</span>

<span class="go">Source Options:</span>
<span class="go">  default        SELECT DISTINCT netblock FROM netblocks WHERE netblock IS NOT NULL</span>
<span class="go">  &lt;string&gt;       string representing a single input</span>
<span class="go">  &lt;path&gt;         path to a file containing a list of inputs</span>
<span class="go">  query &lt;sql&gt;    database query returning one column of inputs</span>

<span class="go">[recon-ng][example.com][reverse_resolve] &gt; run</span>

<span class="go">----------</span>
<span class="go">1.2.3.0/27</span>
<span class="go">----------</span>
<span class="go">[*] 1.2.3.0 =&gt; No record found.</span>
<span class="go">[*] 1.2.3.1 =&gt; gateway.somethingelse.com</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[*] 1.2.3.31 =&gt; No record found.</span>

<span class="go">----------</span>
<span class="go">2.3.4.0/29</span>
<span class="go">----------</span>
<span class="go">[*] 2.3.4.0 =&gt; 2-3-4-0-isp.net</span>
<span class="go">[*] 2.3.4.7 =&gt; 2-3-4-7-isp.net</span>

<span class="go">-------</span>
<span class="go">SUMMARY</span>
<span class="go">-------</span>
<span class="go">[*] 38 total (38 new) items found.</span>
<span class="go">[recon-ng][example.com][reverse_resolve] &gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-brute-forcing-tlds-and-slds">
<h3>7.3.2.6. DNS brute forcing TLDs and SLDs<a class="headerlink" href="#dns-brute-forcing-tlds-and-slds" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -domains</span>
<span class="go">[*] Searching for &#39;-domains&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/domains-domains/brute_suffix</span>

<span class="go">[recon-ng][example.com] &gt; use brute_suffix</span>
<span class="go">[recon-ng][example.com][brute_suffix] &gt; show options</span>

<span class="go">  Name      Current Value                                  Req  Description</span>
<span class="go">  --------  -------------                                  ---  -----------</span>
<span class="go">  SOURCE    default                                        yes  source of input (see &#39;show info&#39; for details)</span>
<span class="go">  SUFFIXES  /usr/local/bin/git.recon-ng/data/suffixes.txt  yes  path to public suffix wordlist</span>
<span class="go">[recon-ng][example.com][brute_suffix] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>

<span class="go">-------</span>
<span class="go">SUMMARY</span>
<span class="go">-------</span>
<span class="go">[*] 19 total (16 new) items found.</span>

<span class="go">[recon-ng][example.com][brute_suffix] &gt; show domains</span>

<span class="go">  +----------------------------------------+</span>
<span class="go">  | rowid |             domain             |</span>
<span class="go">  +----------------------------------------+</span>
<span class="go">  | 3     | example.biz         |</span>
<span class="go">  | 13    | example.co.in       |</span>
<span class="go">  | 15    | example.co.uk       |</span>
<span class="go">  | 1     | example.com         |</span>
<span class="go">  | 12    | example.com.br      |</span>
<span class="go">  | 4     | example.de          |</span>
<span class="go">  | 14    | example.de.ki       |</span>
<span class="go">  | 5     | example.eu          |</span>
<span class="go">  | 6     | example.in          |</span>
<span class="go">  | 7     | example.info        |</span>
<span class="go">  | 8     | example.net         |</span>
<span class="go">  | 9     | example.org         |</span>
<span class="go">  | 10    | example.ro          |</span>
<span class="go">  | 11    | example.us          |</span>
<span class="go">  | 18    | exampleeurope.co.uk |</span>
<span class="go">  | 2     | exampleeurope.com   |</span>
<span class="go">  | 17    | exampleeurope.de.ki |</span>
<span class="go">  | 16    | exampleeurope.net   |</span>
<span class="go">  +----------------------------------------+</span>

<span class="go">[*] 18 rows returned</span>

<span class="go">[recon-ng][example.com][brute_suffix] &gt; back</span>
<span class="go">[recon-ng][example.com] &gt;</span>
</pre></div>
</div>
<p>Of the 16 domains added 5 are redirects back to the original 2: <strong>http://example.biz/.net/.org</strong> are redirects to <strong>http://example.com/…</strong> and <strong>exampleeurope.net/.co.uk</strong> are redirects to <strong>exampleeurope.com</strong>. The rest appear to be unrelated and are deleted via <code class="docutils literal"><span class="pre">del</span> <span class="pre">domains</span> <span class="pre">ROWID</span></code> for each ROWID:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; del domains 12</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
<div class="section" id="run-host-gathering-modules">
<h3>7.3.2.7. Run host gathering modules<a class="headerlink" href="#run-host-gathering-modules" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -hosts</span>
<span class="go">[*] Searching for &#39;-hosts&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/domains-hosts/baidu_site</span>
<span class="go">    recon/domains-hosts/bing_domain_api</span>
<span class="go">    recon/domains-hosts/bing_domain_web</span>
<span class="go">    recon/domains-hosts/brute_hosts</span>
<span class="go">    recon/domains-hosts/google_site_api</span>
<span class="go">    recon/domains-hosts/google_site_web</span>
<span class="go">    recon/domains-hosts/netcraft</span>
<span class="go">    recon/domains-hosts/shodan_hostname</span>
<span class="go">    recon/domains-hosts/ssl_san</span>
<span class="go">    recon/domains-hosts/vpnhunter</span>
<span class="go">    recon/domains-hosts/yahoo_site</span>
<span class="go">    recon/hosts-hosts/bing_ip</span>
<span class="go">    recon/hosts-hosts/ip_neighbor</span>
<span class="go">    recon/hosts-hosts/ipinfodb</span>
<span class="go">    recon/hosts-hosts/resolve</span>
<span class="go">    recon/hosts-hosts/reverse_resolve</span>
<span class="go">    recon/netblocks-hosts/reverse_resolve</span>
<span class="go">    recon/netblocks-hosts/shodan_net</span>

<span class="go">[recon-ng][example.com] &gt; use brute_hosts</span>
<span class="go">[recon-ng][example.com][brute_hosts] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][brute_hosts] &gt; use baidu_site</span>
<span class="go">[recon-ng][example.com][baidu_site] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][baidu_site] &gt; use bing_domain_api</span>
<span class="go">[recon-ng][example.com][bing_domain_api] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][bing_domain_api] &gt; use bing_domain_web</span>
<span class="go">[recon-ng][example.com][bing_domain_web] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][bing_domain_web] &gt; use google_site_api</span>
<span class="go">[recon-ng][example.com][google_site_api] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][google_site_api] &gt; use google_site_web</span>
<span class="go">[recon-ng][example.com][google_site_web] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][google_site_web] &gt; use netcraft</span>
<span class="go">[recon-ng][example.com][netcraft] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][netcraft] &gt; back</span>
<span class="go">[recon-ng][example.com] &gt; set TIMEOUT 20</span>
<span class="go">[recon-ng][example.com] &gt; use ssl_san</span>
<span class="go">[recon-ng][example.com][ssl_san] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][ssl_san] &gt; back</span>
<span class="go">[recon-ng][example.com] &gt; set TIMEOUT 30</span>
<span class="go">[recon-ng][example.com] &gt; use vpnhunter</span>
<span class="go">[recon-ng][example.com][vpnhunter] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][vpnhunter] &gt; use yahoo_site</span>
<span class="go">[recon-ng][example.com][yahoo_site] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][yahoo_site] &gt; use bing_ip</span>
<span class="go">[recon-ng][example.com][bing_ip] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][bing_ip] &gt; use ip_neighbor</span>
<span class="go">[recon-ng][example.com][ip_neighbor] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][ip_neighbor] &gt; use /resolve</span>
<span class="go">[recon-ng][example.com][resolve] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][resolve] &gt; use recon/hosts-hosts/reverse_resolve</span>
<span class="go">[recon-ng][example.com][reverse_resolve] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][reverse_resolve] &gt; use recon/netblocks-hosts/reverse_resolve</span>
<span class="go">[recon-ng][example.com][reverse_resolve] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][reverse_resolve] &gt; use /resolve</span>
<span class="go">[recon-ng][example.com][resolve] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
<p>Note that mobilemail.exampleeurope.co.uk was redirected to <a class="reference external" href="https://login.secureserver.net/index.php?app=wbe&amp;domain=mobilemail.exampleeurope.co.uk">workspace email login</a> which in the US is the defaul email server for GoDaddy-provided domains.</p>
</div>
<div class="section" id="resolve-host-ips">
<h3>7.3.2.8. Resolve host IPs<a class="headerlink" href="#resolve-host-ips" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com][reverse_resolve] &gt; use /resolve</span>
<span class="go">[recon-ng][example.com][resolve] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
<div class="section" id="run-vhost-enumeration-modules">
<h3>7.3.2.9. Run vhost enumeration modules<a class="headerlink" href="#run-vhost-enumeration-modules" title="Permalink to this headline">¶</a></h3>
<p>No vhost enumeration modules available.</p>
</div>
<div class="section" id="run-port-scans">
<h3>7.3.2.10. Run port scans<a class="headerlink" href="#run-port-scans" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -ports</span>
<span class="go">[*] Searching for &#39;-ports&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/netblocks-ports/census_2012</span>

<span class="go">[recon-ng][example.com] &gt; use census_2012</span>
<span class="go">[recon-ng][example.com][census_2012] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">... site http://exfiltrated.com/ is not available ...</span>
</pre></div>
</div>
</div>
<div class="section" id="run-vulnerability-harvesting-modules">
<h3>7.3.2.11. Run vulnerability harvesting modules<a class="headerlink" href="#run-vulnerability-harvesting-modules" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -vul</span>
<span class="go">[*] Searching for &#39;-vul&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/domains-vulnerabilities/punkspider</span>
<span class="go">    recon/domains-vulnerabilities/xssed</span>

<span class="go">[recon-ng][example.com] &gt; use punkspider</span>
<span class="go">[recon-ng][example.com][punkspider] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][punkspider] &gt; use xssed</span>
<span class="go">[recon-ng][example.com][xssed] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
<div class="section" id="resolve-geolocations-of-harvested-locations">
<h3>7.3.2.12. Resolve geolocations of harvested locations<a class="headerlink" href="#resolve-geolocations-of-harvested-locations" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -loc</span>
<span class="go">[*] Searching for &#39;-loc&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/locations-locations/geocode</span>
<span class="go">    recon/locations-locations/reverse_geocode</span>

<span class="go">[recon-ng][example.com] &gt; /geocode</span>
<span class="go">[*] Geocoding &#39;123 Maple Street, Anytown, CA 12345&#39;...</span>
<span class="go">[*] Latitude: 40, Longitude: -80</span>
<span class="go">[*] Geocoding &#39;456 Elm Ave, Anothertown, CA 67890&#39;...</span>
<span class="go">[*] Latitude: 30, Longitude: -100</span>
<span class="go">[*] Geocoding &#39;Someplace in Europe, A Street, A City, A Country, 1234 5678&#39;...</span>
<span class="go">[*] Latitude: 45, Longitude: 20</span>
</pre></div>
</div>
</div>
<div class="section" id="add-distinct-locations-to-the-db">
<h3>7.3.2.13. Add distinct locations to the db<a class="headerlink" href="#add-distinct-locations-to-the-db" title="Permalink to this headline">¶</a></h3>
<p>N/A for this workspace.</p>
</div>
<div class="section" id="run-contact-harvesting-modules">
<h3>7.3.2.14. Run contact harvesting modules<a class="headerlink" href="#run-contact-harvesting-modules" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -contacts</span>
<span class="go">[*] Searching for &#39;-contacts&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/companies-contacts/facebook</span>
<span class="go">    recon/companies-contacts/jigsaw</span>
<span class="go">    recon/companies-contacts/jigsaw/point_usage</span>
<span class="go">    recon/companies-contacts/jigsaw/purchase_contact</span>
<span class="go">    recon/companies-contacts/jigsaw/search_contacts</span>
<span class="go">    recon/companies-contacts/linkedin_auth</span>
<span class="go">    recon/companies-contacts/linkedin_crawl</span>
<span class="go">    recon/contacts-contacts/mangle</span>
<span class="go">    recon/contacts-contacts/namechk</span>
<span class="go">    recon/contacts-contacts/rapportive</span>
<span class="go">    recon/domains-contacts/builtwith</span>
<span class="go">    recon/domains-contacts/pgp_search</span>
<span class="go">    recon/domains-contacts/whois_pocs</span>

<span class="go">[recon-ng][example.com] &gt; use facebook</span>
<span class="go">[recon-ng][example.com][facebook] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][facebook] &gt; use pgp_search</span>
<span class="go">[recon-ng][example.com][pgp_search] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][pgp_search] &gt; use whois_pocs</span>
<span class="go">[recon-ng][example.com][whois_pocs] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][pgp_search] &gt; use mangle</span>
<span class="go">[recon-ng][example.com][mangle] &gt; set PATTERN &lt;fi&gt;&lt;ln&gt;@example.com</span>
<span class="go">[recon-ng][example.com][mangle] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][mangle] &gt; use rapportive</span>
<span class="go">[recon-ng][example.com][rapportive] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
<div class="section" id="mangle-contacts-into-email-addresses">
<h3>7.3.2.15. Mangle contacts into email addresses<a class="headerlink" href="#mangle-contacts-into-email-addresses" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; use mangle</span>
<span class="go">[recon-ng][example.com][mangle] &gt; set PATTERN &lt;fi&gt;&lt;ln&gt;@example.com</span>
<span class="go">[recon-ng][example.com][mangle] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
<div class="section" id="run-modules-that-convert-email-addresses-into-full-contacts">
<h3>7.3.2.16. Run modules that convert email addresses into full contacts<a class="headerlink" href="#run-modules-that-convert-email-addresses-into-full-contacts" title="Permalink to this headline">¶</a></h3>
<p>No such modules found.</p>
</div>
<div class="section" id="run-credential-harvesting-modules">
<h3>7.3.2.17. Run credential harvesting modules<a class="headerlink" href="#run-credential-harvesting-modules" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -creds</span>
<span class="go">[*] Searching for &#39;-creds&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/contacts-creds/breachalarm</span>
<span class="go">    recon/contacts-creds/haveibeenpwned</span>
<span class="go">    recon/contacts-creds/pwnedlist</span>
<span class="go">    recon/creds-creds/adobe</span>
<span class="go">    recon/creds-creds/bozocrack</span>
<span class="go">    recon/creds-creds/hashes_org</span>
<span class="go">    recon/creds-creds/leakdb</span>
<span class="go">    recon/domains-creds/pwnedlist/account_creds</span>
<span class="go">    recon/domains-creds/pwnedlist/api_usage</span>
<span class="go">    recon/domains-creds/pwnedlist/domain_creds</span>
<span class="go">    recon/domains-creds/pwnedlist/domain_ispwned</span>
<span class="go">    recon/domains-creds/pwnedlist/leak_lookup</span>
<span class="go">    recon/domains-creds/pwnedlist/leaks_dump</span>

<span class="go">[recon-ng][example.com] &gt; use breachalarm</span>
<span class="go">[recon-ng][example.com][breachalarm] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[*] 5 total (5 new) items found.</span>
<span class="go">[recon-ng][example.com][breachalarm] &gt; show credentials</span>

<span class="go">  +-----------------------------------------------------------------------------+</span>
<span class="go">  | rowid |               username              | password | hash | type | leak |</span>
<span class="go">  +-----------------------------------------------------------------------------+</span>
<span class="go">  | 1     | user1@example.com        |          |          |      |      |</span>
<span class="go">  | 2     | user2@example.com        |          |          |      |      |</span>
<span class="go">  | 3     | user3@example.com        |          |          |      |      |</span>
<span class="go">  | 4     | user4@example.com        |          |          |      |      |</span>
<span class="go">  | 5     | user5@example.com        |          |          |      |      |</span>
<span class="go">  +-----------------------------------------------------------------------------+</span>

<span class="go">[*] 5 rows returned</span>


<span class="go">[recon-ng][example.com] &gt; use haveibeenpwned</span>
<span class="go">[recon-ng][example.com][haveibeenpwned] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][haveibeenpwned] &gt; use recon/contacts-creds/pwnedlist</span>
<span class="go">[recon-ng][example.com][pwnedlist] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-pushpins">
<h3>7.3.2.18. Generate pushpins<a class="headerlink" href="#generate-pushpins" title="Permalink to this headline">¶</a></h3>
<p>Here we’ll be targeting the</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; search -pushpins</span>
<span class="go">[*] Searching for &#39;-pushpins&#39;...</span>

<span class="go">  Recon</span>
<span class="go">  -----</span>
<span class="go">    recon/locations-pushpins/flickr</span>
<span class="go">    recon/locations-pushpins/picasa</span>
<span class="go">    recon/locations-pushpins/shodan</span>
<span class="go">    recon/locations-pushpins/twitter</span>
<span class="go">    recon/locations-pushpins/youtube</span>
<span class="go">[recon-ng][example.com] &gt; use picasa</span>
<span class="go">[recon-ng][example.com][picasa] &gt; set RADIUS 1</span>
<span class="go">[recon-ng][example.com][picasa] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][picasa] &gt; use pushpins/twitter</span>
<span class="go">[recon-ng][example.com][twitter] &gt; set RADIUS 1</span>
<span class="go">[recon-ng][example.com][twitter] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
<span class="go">[recon-ng][example.com][twitter] &gt; use youtube</span>
<span class="go">[recon-ng][example.com][youtube] &gt; set RADIUS 1</span>
<span class="go">[recon-ng][example.com][youtube] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-reports">
<h3>7.3.2.19. Generate reports<a class="headerlink" href="#generate-reports" title="Permalink to this headline">¶</a></h3>
<p>We start with a pushpin report near corporate headquarters:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; use reporting/pushpin</span>
<span class="go">[recon-ng][example.com] &gt; show locations</span>

<span class="go">  +------------------------------------------------------------------------------------------------------------+</span>
<span class="go">  | rowid |  latitude  |  longitude   |                             street_address                             |</span>
<span class="go">  +------------------------------------------------------------------------------------------------------------+</span>
<span class="gp">  #</span><span class="c1">##################### SNIP ######################</span>
<span class="go">  +------------------------------------------------------------------------------------------------------------+</span>

<span class="go">[*] 3 rows returned</span>
<span class="go">[recon-ng][example.com][pushpin] &gt; set LATITUDE 40</span>
<span class="go">[recon-ng][example.com][pushpin] &gt; set LONGITUDE -80</span>
<span class="go">[recon-ng][example.com][pushpin] &gt; set MAP_FILENAME pushpin_map.html</span>
<span class="go">[recon-ng][example.com][pushpin] &gt; set MEDIA_FILENAME pushpin_media.html</span>
<span class="go">[recon-ng][example.com][pushpin] &gt; set RADIUS 0.25</span>
<span class="go">[recon-ng][example.com][pushpin] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
<p>Then an html report:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[recon-ng][example.com] &gt; use html</span>
<span class="go">[recon-ng][example.com][html] &gt; set CREATOR Pentest Meetup</span>
<span class="go">[recon-ng][example.com][html] &gt; set CUSTOMER Pentest Meetup</span>
<span class="go">[recon-ng][example.com][html] &gt; set FILENAME results.html</span>
<span class="go">[recon-ng][example.com][html] &gt; set SANITIZE False</span>
<span class="go">[recon-ng][example.com][html] &gt; run</span>
<span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tables-needing-seed-updated-missing">
<h2>7.3.3. Tables needing seed, updated, missing<a class="headerlink" href="#tables-needing-seed-updated-missing" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">TABLE</th>
<th class="head">SEED NEEDED?</th>
<th class="head">DATA PROVIDED?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>companies</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>locations</td>
<td>YES</td>
<td>PARTIAL</td>
</tr>
<tr class="row-even"><td>domains</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>netblocks</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>hosts</td>
<td>NO</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>ports</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>contacts</td>
<td>NO</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>credentials</td>
<td>NO</td>
<td>PARTIAL</td>
</tr>
<tr class="row-even"><td>leaks</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>vulnerabilities</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>pushpins</td>
<td>NO</td>
<td>YES</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pentest_study.html" class="btn btn-neutral float-right" title="8. Pentest Study" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="one-off.html" class="btn btn-neutral" title="7.2. one-off tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>