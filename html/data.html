

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.5. Data &mdash; South Bay WASP 1.0.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="South Bay WASP 1.0.2 documentation" href="../index.html"/>
        <link rel="up" title="5. HTML" href="../pentest_html.html"/>
        <link rel="next" title="5.6. HTML security" href="html_security.html"/>
        <link rel="prev" title="5.4. Scripting" href="scripting.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_html.html">5. HTML</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="standards.html">5.1. Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="http.html">5.2. HTTP(S) vs HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="parsing.html">5.3. Parsing &amp; Rendering HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripting.html">5.4. Scripting</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.5. Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cookies-data">5.5.1. Cookies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-a-cookie">5.5.1.1. What is a cookie?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cookie-creation">5.5.1.2. Cookie creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cookie-lifetime">5.5.1.3. Cookie lifetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cookie-use">5.5.1.4. Cookie use</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-cookie-sessions">5.5.1.5. Secure cookie sessions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#where-are-cookies-stored">5.5.1.6. Where are cookies stored?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cookie-handling-within-the-browser">5.5.1.7. Cookie handling within the browser</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tracking-users-across-the-internet">5.5.1.8. Tracking users across the Internet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id2">5.5.2. Microdata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">5.5.3. Web Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#web-sql">5.5.4. Web SQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indexeddb">5.5.5. IndexedDB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="html_security.html">5.6. HTML security</a></li>
<li class="toctree-l2"><a class="reference internal" href="messaging.html">5.7. HTML Web Messaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="html_exploits.html">5.8. HTML exploits</a></li>
<li class="toctree-l2"><a class="reference internal" href="hsts.html">5.9. HSTS Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="xss.html">5.10. XSS Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_html.html">5. HTML</a> &raquo;</li>
        
      <li>5.5. Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/html/data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data">
<h1>5.5. Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h1>
<p>This discusses not just cookies, but in general browser storage &amp; security.</p>
<div class="section" id="cookies-data">
<span id="id1"></span><h2>5.5.1. Cookies<a class="headerlink" href="#cookies-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-a-cookie">
<h3>5.5.1.1. What is a cookie?<a class="headerlink" href="#what-is-a-cookie" title="Permalink to this headline">¶</a></h3>
<p>Remember that HTTP is a stateless protocol but the HTTP servers often want to uniquely track a user across their web site. One way of doing that is cookies. The following is a summary of <a class="reference external" href="http://en.wikipedia.org/wiki/HTTP_cookie">HTTP cookie</a>:</p>
<blockquote>
<div>Browsers are expected to support cookies where each cookie has a size of 4KB, at least 50 cookies per domain, and at least 3000 cookies total. It consists of seven components:</div></blockquote>
<dl class="docutils">
<dt>name (required)</dt>
<dd>cookie name, returned to the server when domain, path, and secure connection matches</dd>
<dt>value (required)</dt>
<dd>cookie value, returned to the server when domain, path, and secure connection matches</dd>
<dt>expiration</dt>
<dd>cookie expiration, defaulting to session expiration (never returned to the server)</dd>
<dt>path</dt>
<dd>path the cookie matches (never returned to the server)</dd>
<dt>domain</dt>
<dd>domain the cookie matches (never returned to the server)</dd>
<dt>secure connection only</dt>
<dd>cookie only allowed on secure connections</dd>
<dt>http_only</dt>
<dd>cookie only accessible by http (i.e., not JavaScript, …)</dd>
</dl>
</div>
<div class="section" id="cookie-creation">
<h3>5.5.1.2. Cookie creation<a class="headerlink" href="#cookie-creation" title="Permalink to this headline">¶</a></h3>
<p>Cookies are created on the client when the server sends the HTTP “Set-Cookie:” directive; the client must return the cookie name &amp; value back to the server via the HTTP “Cookie:” directive when the domain &amp; path match the values in the cookie. Think about this security model: the server sends data to the client for storage, expecting that client (and only that client) to return the data back unaltered.</p>
<p>Here is some bash to show the cookie being sent by the server and stored in the file <code class="file docutils literal"><span class="pre">cookies.txt</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">UA</span><span class="o">=</span><span class="s2">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:31.0)\</span>
<span class="s2"> Gecko/20100101 Firefox/31.0 Iceweasel/31.4.0&quot;</span>

<span class="hll">curl -v --head --cookie-jar cookies.txt --user-agent <span class="s2">&quot;</span><span class="nv">$UA</span><span class="s2">&quot;</span> <span class="se">\</span>
</span>    http://www.google.com/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> <span class="se">\</span>
<span class="hll">    grep <span class="s2">&quot;^Set-Cookie:&quot;</span>
</span>
<span class="hll">cat cookies.txt
</span></pre></div>
</div>
<p>Running this gives:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> <span class="nv">UA</span><span class="o">=</span><span class="s2">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:31.0)\</span>
<span class="s2">&gt;  Gecko/20100101 Firefox/31.0 Iceweasel/31.4.0&quot;</span>
<span class="gp">hacker@kali:~$</span>
<span class="gp">hacker@kali:~$</span> curl -v --head --cookie-jar cookies.txt --user-agent <span class="s2">&quot;</span><span class="nv">$UA</span><span class="s2">&quot;</span> <span class="se">\</span>
&gt;     http://www.google.com/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> <span class="se">\</span>
&gt;     grep <span class="s2">&quot;^Set-Cookie:&quot;</span>
<span class="hll"><span class="go">Set-Cookie:</span>
</span><span class="hll"><span class="go">    PREF=</span>
</span><span class="hll"><span class="go">        ID=c7ff420bff37adf5:</span>
</span><span class="hll"><span class="go">        FF=0:</span>
</span><span class="hll"><span class="go">        TM=1424300122:</span>
</span><span class="hll"><span class="go">        LM=1424300122:</span>
</span><span class="hll"><span class="go">        S=H55eXGn_4gM0LpLp;</span>
</span><span class="hll"><span class="go">    expires=Fri, 17-Feb-2017 22:55:22 GMT;</span>
</span><span class="hll"><span class="go">    path=/;</span>
</span><span class="hll"><span class="go">    domain=.google.com</span>
</span><span class="hll"><span class="go">Set-Cookie:</span>
</span><span class="hll"><span class="go">    NID=</span>
</span><span class="hll"><span class="go">        67=dD8uoSCgZWb73LkLjaLKNF9LrvUzO9lshxI9J2Y1VmikCkWq2PY\</span>
</span><span class="hll"><span class="go">        aabYHs5AMCRO7iKqJ5YqNhRgGfnbUiTGf_5P34qqkzJlZIXJHDZ6W7\</span>
</span><span class="hll"><span class="go">        09Jn1YvU07ERxNPMfbaaW33;</span>
</span><span class="hll"><span class="go">    expires=Thu, 20-Aug-2015 22:55:22 GMT;</span>
</span><span class="hll"><span class="go">    path=/;</span>
</span><span class="hll"><span class="go">    domain=.google.com;</span>
</span><span class="hll"><span class="go">    HttpOnly</span>
</span><span class="gp">hacker@kali:~$</span>
<span class="hll"><span class="gp">hacker@kali:~$</span> cat cookies.txt
</span><span class="hll"><span class="gp">#</span> Netscape HTTP Cookie File
</span><span class="hll"><span class="gp">#</span> http://curl.haxx.se/rfc/cookie_spec.html
</span><span class="hll"><span class="gp">#</span> This file was generated by libcurl! Edit at your own risk.
</span><span class="hll">
</span><span class="hll"><span class="go">.google.com</span>
</span><span class="hll"><span class="go">    TRUE</span>
</span><span class="hll"><span class="go">    /</span>
</span><span class="hll"><span class="go">    FALSE</span>
</span><span class="hll"><span class="go">    1487372122</span>
</span><span class="hll"><span class="go">    PREF</span>
</span><span class="hll"><span class="go">        ID=c7ff420bff37adf5:</span>
</span><span class="hll"><span class="go">        FF=0:</span>
</span><span class="hll"><span class="go">        TM=1424300122:</span>
</span><span class="hll"><span class="go">        LM=1424300122:</span>
</span><span class="hll"><span class="go">        S=H55eXGn_4gM0LpLp</span>
</span><span class="hll"><span class="gp">#</span>HttpOnly_
</span><span class="hll"><span class="go">    .google.com</span>
</span><span class="hll"><span class="go">    TRUE</span>
</span><span class="hll"><span class="go">    /</span>
</span><span class="hll"><span class="go">    FALSE</span>
</span><span class="hll"><span class="go">    1440111322</span>
</span><span class="hll"><span class="go">    NID</span>
</span><span class="hll"><span class="go">        67=dD8uoSCgZWb73LkLjaLKNF9LrvUzO9lshxI9J2Y1VmikCkWq2PY\</span>
</span><span class="hll"><span class="go">        aabYHs5AMCRO7iKqJ5YqNhRgGfnbUiTGf_5P34qqkzJlZIXJHDZ6W7\</span>
</span><span class="hll"><span class="go">        09Jn1YvU07ERxNPMfbaaW33</span>
</span></pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">cookie.txt</span></code> follows the Netscape tab-separated format: domain (preceded by “$HttpOnly_” for http_only cookies), flag (T/F) indicating if all machines in a domain can access the cookie, path, secure (T/F), expiration (UNIX time which can be converted via <code class="docutils literal"><span class="pre">E=1519144083;</span> <span class="pre">date</span> <span class="pre">-d</span> <span class="pre">&#64;$E</span></code>), name, and value.
At this point the cookies PREF and NID are defined with PREF expiring in 2 years (!) and NID in 6 months. Both have path “/” and domain “.google.com” meaning that their name &amp; value should be sent to the good server when requesting “*.google.com/” via either http or https. NID is only accessible via http (and not via JavaScript). Neither is restricted to https.</p>
<p>It is up to the client to return the cookie’s name &amp; value to the server when the domain &amp; path match. For <code class="docutils literal"><span class="pre">curl</span></code> to use the <code class="file docutils literal"><span class="pre">cookies.txt</span></code> file later use the <code class="docutils literal"><span class="pre">--cookies</span></code> option (along with <code class="docutils literal"><span class="pre">--cookie-jar</span></code> option to receive any return cookies):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">UA</span><span class="o">=</span><span class="s2">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:31.0)\</span>
<span class="s2"> Gecko/20100101 Firefox/31.0 Iceweasel/31.4.0&quot;</span>

curl -v --user-agent <span class="s2">&quot;</span><span class="nv">$UA</span><span class="s2">&quot;</span> <span class="se">\</span>
<span class="hll">     --cookie cookies.txt --cookie-jar cookies.txt <span class="se">\</span>
</span>    https://www.google.com/?gws_rd<span class="o">=</span>ssl#q<span class="o">=</span>search+for+something <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> <span class="se">\</span>
<span class="hll">    egrep <span class="s2">&quot;(Set-Cookie:|Cookie:)&quot;</span>
</span></pre></div>
</div>
<p>Running this gives:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> curl -v --user-agent <span class="s2">&quot;</span><span class="nv">$UA</span><span class="s2">&quot;</span> <span class="se">\</span>
&gt;      --cookie cookies.txt --cookie-jar cookies.txt <span class="se">\</span>
&gt;     https://www.google.com/?gws_rd<span class="o">=</span>ssl#q<span class="o">=</span>search+for+something <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> <span class="se">\</span>
&gt;     egrep <span class="s2">&quot;(Set-Cookie:|Cookie:)&quot;</span>
<span class="hll"><span class="gp">&gt;</span> Cookie:
</span><span class="hll"><span class="go">    NID=</span>
</span><span class="hll"><span class="go">        67=dD8uoSCgZWb73LkLjaLKNF9LrvUzO9lshxI9J2Y1VmikCkWq2PY\</span>
</span><span class="hll"><span class="go">        aabYHs5AMCRO7iKqJ5YqNhRgGfnbUiTGf_5P34qqkzJlZIXJHDZ6W7\</span>
</span><span class="hll"><span class="go">        09Jn1YvU07ERxNPMfbaaW33;</span>
</span><span class="hll"><span class="go">    PREF=</span>
</span><span class="hll"><span class="go">        ID=c7ff420bff37adf5:</span>
</span><span class="hll"><span class="go">        FF=0:</span>
</span><span class="hll"><span class="go">        TM=1424300122:</span>
</span><span class="hll"><span class="go">        LM=1424300122:</span>
</span><span class="hll"><span class="go">        S=H55eXGn_4gM0LpLp</span>
</span><span class="hll"><span class="go">&lt; Set-Cookie:</span>
</span><span class="hll"><span class="go">     PREF=</span>
</span><span class="hll"><span class="go">         ID=c7ff420bff37adf5:</span>
</span><span class="hll"><span class="go">         U=42279cb0d37ac21e:</span>
</span><span class="hll"><span class="go">         FF=0:</span>
</span><span class="hll"><span class="go">         TM=1424300122:</span>
</span><span class="hll"><span class="go">         LM=1424300534:</span>
</span><span class="hll"><span class="go">         S=ZJhObjcMPBJ5byTr;</span>
</span><span class="hll"><span class="go">     expires=Fri, 17-Feb-2017 23:02:14 GMT;</span>
</span><span class="hll"><span class="go">     path=/;</span>
</span><span class="hll"><span class="go">     domain=.google.com</span>
</span><span class="hll"><span class="go">&lt; Set-Cookie:</span>
</span><span class="hll"><span class="go">     NID=</span>
</span><span class="hll"><span class="go">         67=sDvEPrthCRAEBl1Bc5mQv3_LBXLd4boLulRIxsIQ8FOMY5\</span>
</span><span class="hll"><span class="go">         AIYHVIdV5DTH0Q7nIuyL0QrQGkMVzxlUh6W-9KUE62Sek3JUK\</span>
</span><span class="hll"><span class="go">         d-1J_LXs33-4xhUpVWte7gVqyeP2sSMhg;</span>
</span><span class="hll"><span class="go">     expires=Thu, 20-Aug-2015 23:02:14 GMT;</span>
</span><span class="hll"><span class="go">     path=/;</span>
</span><span class="hll"><span class="go">     domain=.google.com;</span>
</span><span class="hll"><span class="go">     HttpOnly</span>
</span></pre></div>
</div>
</div>
<div class="section" id="cookie-lifetime">
<h3>5.5.1.3. Cookie lifetime<a class="headerlink" href="#cookie-lifetime" title="Permalink to this headline">¶</a></h3>
<p>Following <a class="reference external" href="https://tools.ietf.org/html/rfc6265">RFC 6265 HTTP State Management Mechanism</a>:</p>
<blockquote>
<div><p>If a cookie has neither the Max-Age nor the Expires attribute, the user agent will retain the cookie until “the current session is over” (as defined by the user agent).</p>
<p>If the server wishes the user agent to persist the cookie over multiple “sessions” (e.g., user agent restarts), the server can specify an expiration date in the Expires attribute.  Note that the user agent might delete the cookie before the expiration date if the user agent’s cookie store exceeds its quota or if the user manually deletes the server’s cookie.</p>
<p>Finally, to remove a cookie, the server returns a Set-Cookie header with an expiration date in the past.  The server will be successful in removing the cookie only if the Path and the Domain attribute in the Set-Cookie header match the values used when the cookie was created.</p>
</div></blockquote>
</div>
<div class="section" id="cookie-use">
<h3>5.5.1.4. Cookie use<a class="headerlink" href="#cookie-use" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/HTTP_cookie#Uses">Cookie Uses</a> lists: session management, personalization, and tracking. <a class="reference external" href="https://www.google.com/intl/en/policies/technologies/types/">Types of cookies used by Google</a> mentions even more:</p>
<blockquote>
<div><p>Preferences:</p>
<blockquote>
<div>Most Google users will have a preferences cookie called ‘PREF’ in their browsers. A browser sends this cookie with requests to Google’s sites. The PREF cookie may store your preferences and other information, in particular your preferred language (e.g. English), how many search results you wish to have shown per page (e.g. 10 or 20), and whether or not you wish to have Google’s SafeSearch filter turned on.</div></blockquote>
<p>Security:</p>
<blockquote>
<div>For example, we use cookies called ‘SID’ and ‘HSID’ which contain digitally signed and encrypted records of a user’s Google account ID and most recent sign-in time. The combination of these two cookies allows us to block many types of attack, such as attempts to steal the content of forms that you complete on web pages.</div></blockquote>
<p>Processes:</p>
<blockquote>
<div>For example, we use a cookie called ‘lbcs’ which makes it possible for Google Docs to open many Docs in one browser. Blocking this cookie would prevent Google Docs from operating correctly.</div></blockquote>
<p>Advertising:</p>
<blockquote>
<div><p>Google uses cookies, like the PREF, NID, and SID cookies, to help customize ads on Google properties, like Google Search.</p>
<p>Our main advertising cookie on non-Google sites is called ‘id’ and it is stored in browsers under the domain doubleclick.net. We use others with names such as _drt_, FLC, and exchange_uid.</p>
<p>Sometimes a cookie may be set on the domain of the site you are visiting. In the case of our DoubleClick product, a cookie called ‘__gads’ may be set on the domain of the site you are visiting.</p>
</div></blockquote>
<p>Session State:</p>
<blockquote>
<div>For example, we use a cookie called ‘recently_watched_video_id_list’ so that YouTube can record the videos most recently watched by a particular browser.</div></blockquote>
<p>Analytics:</p>
<blockquote>
<div>In addition to reporting website usage statistics, the Google Analytics pixel tag can also be used, together with some of the advertising cookies described above, to help show more relevant ads on Google properties (like Google Search) and across the web.</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="secure-cookie-sessions">
<h3>5.5.1.5. Secure cookie sessions<a class="headerlink" href="#secure-cookie-sessions" title="Permalink to this headline">¶</a></h3>
<p>How can cookies be used securely and what difficulties are encountered? An example is found in <a class="reference external" href="https://tools.ietf.org/html/rfc6896#section-3.2.4">SCS: KoanLogic’s Secure Cookie Sessions for HTTP</a> (RFC 6896), which “defines a generic URI and HTTP-header-friendly envelope for carrying symmetrically encrypted, authenticated, and origin-timestamped tokens.” It takes the generic approach of “encrypt-then-MAC” the cookie.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> Box<span class="o">()</span> <span class="o">=</span> append strings, separating with <span class="s2">&quot;|&quot;</span>
<span class="gp">#</span> Comp<span class="o">()</span> <span class="o">=</span> compress
<span class="gp">#</span> e<span class="o">()</span> <span class="o">=</span> encode <span class="o">(</span>base <span class="m">64</span><span class="o">)</span>
<span class="gp">#</span> Enc<span class="o">()</span> <span class="o">=</span> encrypt
<span class="gp">#</span> RAND<span class="o">()</span> <span class="o">=</span> random number generator
<span class="gp">#</span> <span class="nv">TID</span> <span class="o">=</span> trapdoor key <span class="o">(</span>used by encryption<span class="o">)</span>
<span class="go">IV = RAND()</span>
<span class="go">ATIME = NOW</span>
<span class="go">DATA = Enc(Comp(plain-text-cookie-value), IV)</span>
<span class="go">AUTHTAG = HMAC(Box(e(DATA), e(ATIME), e(TID), e(IV)))</span>

<span class="go">scs-cookie-value = Box(e(DATA), e(ATIME), e(TID), e(IV), e(AUTHTAG))</span>
</pre></div>
</div>
<p>SCS protects the cookie value which normally would be plain text and tamperable. And it avoids the server-side problem of session ID prediction or brute-forcing. However, like normal cookies it does suffer from these shortcomings:</p>
<ul>
<li><p class="first">Cookie Replay is not addressed. Additional steps needed might be:</p>
<ul>
<li><p class="first">Session inactivity timeout</p>
</li>
<li><p class="first">Session voidance</p>
<p>A list of possibly good cookies (using random values) is kept and deleted as cookies are used.</p>
</li>
<li><p class="first">TLS binding</p>
<p>Place data in the cookie tied to the current TLS session. This ties the client and server together and could affect scaling.</p>
</li>
</ul>
</li>
<li><p class="first">Cookie Deletion</p>
<p>A client could intentionally delete the cookie and therefore not use one. The application must be designed so there is no incentive to do so.</p>
</li>
<li><p class="first">Cookie Sharing or Theft</p>
<ul class="simple">
<li>TLS binding (see above)</li>
<li>Securing the transmission (HTTPS, …) reduces the chance of stolen cookies</li>
<li>Session cookies reduce the vulnerability window</li>
</ul>
</li>
<li><p class="first"><a class="reference external" href="https://www.owasp.org/index.php/Session_fixation">Session fixation</a> is not addressed:</p>
<blockquote>
<div><p>“The Session Fixation attack fixes an established session on the victim’s browser, so the attack starts before the user logs in.”</p>
</div></blockquote>
<p>Like session hijacking, but instead of letting the client create the session then hijacking it, the attacker creates a session and makes the client use it.</p>
</li>
</ul>
<p>Thankfully many web frameworks provide authentication and session management so web site authors don’t have to bake in their own user identification, authentication, and authorization.</p>
</div>
<div class="section" id="where-are-cookies-stored">
<h3>5.5.1.6. Where are cookies stored?<a class="headerlink" href="#where-are-cookies-stored" title="Permalink to this headline">¶</a></h3>
<p>Both <strong class="program">firefox</strong> and Google <strong class="program">chrome</strong> store cookies in a SQLite database:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$ #</span> -wal <span class="o">=</span> SQLite write-ahead-log
<span class="gp">hacker@kali:~$ #</span> -shm <span class="o">=</span> shared memory file associated with the database
<span class="gp">hacker@kali:~$ #</span>        used to access -wal
<span class="hll"><span class="gp">hacker@kali:~$ FF=$</span><span class="o">(</span>ls -1d <span class="nv">$HOME</span>/.mozilla/firefox/*.default<span class="o">)</span>
</span><span class="hll"><span class="gp">hacker@kali:~$ ls $</span>FF/cookies.sqlite*
</span><span class="hll"><span class="go">/home/hacker/.mozilla/firefox/rj9fngpa.default/cookies.sqlite</span>
</span><span class="go">/home/hacker/.mozilla/firefox/rj9fngpa.default/cookies.sqlite-shm</span>
<span class="go">/home/hacker/.mozilla/firefox/rj9fngpa.default/cookies.sqlite-wal</span>
<span class="gp">hacker@kali:~$</span>
<span class="hll"><span class="gp">hacker@kali:~$ GC=$</span>HOME/.config/chromium/Default
</span><span class="hll"><span class="gp">hacker@kali:~$ ls $</span>GC/Cookies*
</span><span class="hll"><span class="go">/home/hacker/.config/chromium/Default/Cookies</span>
</span><span class="hll"><span class="go">/home/hacker/.config/chromium/Default/Cookies-journal</span>
</span></pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">hacker@kali:~$ sqlite3 $</span>FF/cookies.sqlite
</span><span class="go">SQLite version 3.7.16.2 2013-04-12 11:52:43</span>
<span class="hll"><span class="go">Enter &quot;.help&quot; for instructions</span>
</span><span class="hll"><span class="go">Enter SQL statements terminated with a &quot;;&quot;</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; .databases</span>
</span><span class="hll"><span class="go">seq  name             file</span>
</span><span class="hll"><span class="go">---  ---------------  ----------------------------------------------------------</span>
</span><span class="hll"><span class="go">0    main             /home/hacker/.mozilla/firefox/rj9fngpa.default/cookies.sql</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; .tables</span>
</span><span class="hll"><span class="go">moz_cookies</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; .schema moz_cookies</span>
</span><span class="hll"><span class="go">CREATE TABLE moz_cookies (id INTEGER PRIMARY KEY, baseDomain TEXT,</span>
</span><span class="hll"><span class="go">    appId INTEGER DEFAULT 0, inBrowserElement INTEGER DEFAULT 0, name TEXT,</span>
</span><span class="hll"><span class="go">    value TEXT, host TEXT, path TEXT, expiry INTEGER, lastAccessed INTEGER,</span>
</span><span class="hll"><span class="go">    creationTime INTEGER, isSecure INTEGER, isHttpOnly INTEGER,</span>
</span><span class="hll"><span class="go">    CONSTRAINT moz_uniqueid UNIQUE (name, host, path, appId, inBrowserElement));</span>
</span><span class="hll"><span class="go">CREATE INDEX moz_basedomain ON moz_cookies (baseDomain, appId, inBrowserElement);</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; select * from moz_cookies;</span>
</span><span class="hll"><span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</span><span class="hll"><span class="go">sqlite&gt; .quit</span>
</span><span class="gp">hacker@kali:~$</span>
<span class="gp">hacker@kali:~$</span>
<span class="hll"><span class="gp">hacker@kali:~$ sqlite3 $</span>GC/Cookies
</span><span class="go">SQLite version 3.7.16.2 2013-04-12 11:52:43</span>
<span class="go">Enter &quot;.help&quot; for instructions</span>
<span class="go">Enter SQL statements terminated with a &quot;;&quot;</span>
<span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; .databases</span>
</span><span class="hll"><span class="go">seq  name             file</span>
</span><span class="hll"><span class="go">---  ---------------  ----------------------------------------------------------</span>
</span><span class="hll"><span class="go">0    main             /home/hacker/.config/chromium/Default/Cookies</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; .tables</span>
</span><span class="hll"><span class="go">cookies  meta</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; .schema meta</span>
</span><span class="hll"><span class="go">CREATE TABLE meta(key LONGVARCHAR NOT NULL UNIQUE PRIMARY KEY, value LONGVARCHAR);</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; .schema cookies</span>
</span><span class="hll"><span class="go">CREATE TABLE cookies (creation_utc INTEGER NOT NULL UNIQUE PRIMARY KEY,</span>
</span><span class="hll"><span class="go">    host_key TEXT NOT NULL,name TEXT NOT NULL,value TEXT NOT NULL,</span>
</span><span class="hll"><span class="go">    path TEXT NOT NULL,expires_utc INTEGER NOT NULL,</span>
</span><span class="hll"><span class="go">    secure INTEGER NOT NULL,httponly INTEGER NOT NULL,</span>
</span><span class="hll"><span class="go">    last_access_utc INTEGER NOT NULL, has_expires INTEGER NOT NULL DEFAULT 1,</span>
</span><span class="hll"><span class="go">    persistent INTEGER NOT NULL DEFAULT 1,priority INTEGER NOT NULL DEFAULT 1,</span>
</span><span class="hll"><span class="go">    encrypted_value BLOB DEFAULT &#39;&#39;);</span>
</span><span class="hll"><span class="go">CREATE INDEX domain ON cookies(host_key);</span>
</span><span class="go">sqlite&gt;</span>
<span class="go">sqlite&gt;</span>
<span class="hll"><span class="go">sqlite&gt; select * from cookies;</span>
</span><span class="hll"><span class="gp">#</span><span class="c1">##################### SNIP ######################</span>
</span><span class="hll"><span class="go">sqlite&gt; .quit</span>
</span><span class="gp">hacker@kali:~$</span>
</pre></div>
</div>
</div>
<div class="section" id="cookie-handling-within-the-browser">
<h3>5.5.1.7. Cookie handling within the browser<a class="headerlink" href="#cookie-handling-within-the-browser" title="Permalink to this headline">¶</a></h3>
<p>Within <strong class="program">chrome</strong>, <a class="reference external" href="http://www.chromium.org/developers/design-documents/network-stack/cookiemonster">CookieMonster</a>:</p>
<blockquote>
<div><p>The CookieMonster is the class in Chromium which handles in-browser storage, management, retrieval, expiration, and eviction of cookies. It does not handle interaction with the user or cookie policy (i.e. which cookies are accepted and which are not).  The code for the CookieMonster is contained in net/base/cookie_monster.{h,cc}.</p>
<p>…</p>
<p>The CookieMonster has the following responsibilities:</p>
<ul>
<li><p class="first">When a server response is received specifying a cookie, it confirms that the cookie is valid, and stores it if so.  Tests for validity include:</p>
<ul class="simple">
<li>The domain of the cookie must be .local or a subdomain of a public suffix (see <a class="reference external" href="http://publicsuffix.org/">http://publicsuffix.org/</a> - also known as an extended Top Level Domain).</li>
<li>The domain of the cookie must be a suffix of the domain from which the response was received.</li>
</ul>
<p>We do not enforce the RFC path or port restrictions</p>
</li>
<li><p class="first">When a client request is being generated, a cookie in the store is included in that request if:</p>
<ul class="simple">
<li>The cookie domain is a suffix of the server hostname.</li>
<li>The path of the cookie is a prefix of the request path.</li>
<li>The cookie must be unexpired.</li>
</ul>
</li>
<li><p class="first">It enforces limits (both per-origin and globally) on how many cookies will be stored.</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="tracking-users-across-the-internet">
<h3>5.5.1.8. Tracking users across the Internet<a class="headerlink" href="#tracking-users-across-the-internet" title="Permalink to this headline">¶</a></h3>
<p>Here are 3 examples of tracking users on the Internet:</p>
<ul>
<li><p class="first"><a class="reference external" href="http://motherboard.vice.com/read/looking-up-symptoms-online-these-companies-are-collecting-your-data">Looking Up Symptoms Online? these Companies Are Tracking You</a></p>
<blockquote>
<div><p>When you click that CDC link, you’re making a so-called “first party request.” That request goes to the CDC’s servers, and it returns the HTML file with the page you’re looking for. In this case, it’s “Genital Herpes - CDC Factsheet,” which is perhaps the page on the internet you’d least want anyone to know you’re looking at. But because the CDC has installed Google Analytics to measure its traffic stats, and has, for some reason, included AddThis code which allows Facebook and Twitter sharing (beckoning the question of who socializes disease pages), the CDC also sends a third party request to each of those companies. That request looks something like this—<a class="reference external" href="http://www.cdc.gov/std/herpes/STDFact-Herpes.htm">http://www.cdc.gov/std/herpes/STDFact-Herpes.htm</a>—and makes explicit to those third party corporations in its HTTP referrer string that your search was about herpes.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference external" href="http://arxiv.org/pdf/1108.5864.pdf">Show Me Your Cookie And I Will Tell You Who You Are</a></p>
<blockquote>
<div><p>We analyzed Google Web Search access mechanisms and found that the current policy applied to session cookies could be used to retrieve users’ personal data. We describe an attack scheme leveraging the search personalization (based on the same sid cookie) to retrieve a part of the victim’s click history and even some of her contacts. We implemented a proof of concept of this attack on Firefox and Chrome Web browsers and conducted an experiment with ten volunteers. Thanks to this prototype we were able to recover up to 80% of the user’s search click history.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference external" href="http://ashkansoltani.org/2012/02/25/cookies-from-nowhere/">Cookies from Nowhere</a></p>
<blockquote>
<div><p>The ‘.google.com’ PREF cookie enables cross-site tracking by Google’s +1 buttons. This button is similar in functionality to Facebook’s ‘Like button’ and other social widgets, which have been the subject of much attention for their ability to profile users across the web. As with the ‘Like button’, the PREF cookie and corresponding referer header (which reveals the page the user is browsing) is transmitted to Google anytime there is a +1 button present on a webpage (without the user taking any action).</p>
</div></blockquote>
</li>
</ul>
<p>And besides “normal” cookies, web sites have found additional ways to track user behavior across multiple web sites: third-party cookies, supercookies, zombie cookies, and tracking cookies:</p>
<dl class="docutils">
<dt>Third party cookies</dt>
<dd><p class="first">come from third-pary content (i.e. 1 pixel images) delivered from the original web site. Placed across a large number of popular web sites, they can track users daily activies via the allowed third-party cookies.</p>
<p>From <a class="reference external" href="http://cookiepedia.co.uk/website/independent.co.uk">Website Search Results: independent.co.uk</a> we see that site does plenty of third-party cookies and tracking. Using <code class="docutils literal"><span class="pre">curl</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">UA</span><span class="o">=</span><span class="s2">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:31.0)\</span>
<span class="s2"> Gecko/20100101 Firefox/31.0 Iceweasel/31.4.0&quot;</span>
curl -L -s  --user-agent <span class="s2">&quot;</span><span class="nv">$UA</span><span class="s2">&quot;</span> http://www.independent.co.uk/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> <span class="se">\</span>
<span class="hll">    egrep <span class="s1">&#39;height=&quot;(0|1)&quot;&#39;</span>
</span></pre></div>
</div>
<p>Running this shows an <a class="reference external" href="https://en.wikipedia.org/wiki/Omniture">Omniture</a> 1 pixel tracking “image” and a <a class="reference external" href="https://en.wikipedia.org/wiki/BlueKai">BlueKai</a> hidden 0x0 iframe (see <a class="reference external" href="http://blog.unmaskparasites.com/2009/10/28/evolution-of-hidden-iframes/">Evolution of Hidden Iframes</a>):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">hacker@kali:~$</span> <span class="nv">UA</span><span class="o">=</span><span class="s2">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:31.0)\</span>
<span class="s2">&gt;  Gecko/20100101 Firefox/31.0 Iceweasel/31.4.0&quot;</span>
<span class="gp">hacker@kali:~$</span> curl -L -s  --user-agent <span class="s2">&quot;</span><span class="nv">$UA</span><span class="s2">&quot;</span> http://www.independent.co.uk/ <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> <span class="se">\</span>
&gt;     egrep <span class="s1">&#39;height=&quot;(0|1)&quot;&#39;</span>
<span class="hll"><span class="go">&lt;noscript&gt;&lt;img src=&quot;http://independent.122.2o7.net/b/ss/indepdev/1/H.27.5--NS/0?[AQB]&amp;amp;cdp=3&amp;amp;[AQE]/7656218&quot; height=&quot;1&quot; width=&quot;1&quot; alt=&quot;&quot;&gt;&lt;/noscript&gt;</span>
</span><span class="hll"><span class="go">    &lt;iframe name=&quot;__bkframe&quot; height=&quot;0&quot; width=&quot;0&quot; frameborder=&quot;0&quot; style=&quot;display:none;position:absolute;clip:rect(0px 0px 0px 0px)&quot; src=&quot;about:blank&quot;&gt;&lt;/iframe&gt;</span>
</span></pre></div>
</div>
<p>From <a class="reference external" href="http://docs.oracle.com/cloud/latest/marketingcs_gs/OMCAA/Help/Apps/BlueKaiDataActivationApp/Tasks/ConfiguringIDSwapping.htm">Configuring Oracle Eloqua and BlueKai ID swapping</a>:</p>
<blockquote class="last">
<div>When an anonymous contact interacts with a marketing asset, BlueKai’s data management platform (DMP) can be leveraged to assign an email address to this contact, thus making this contact a known contact. … ID swapping occurs when a contact visits a site, opens an email (on email clients that support third-party cookies such as Outlook and Yahoo Mail), clicks within an email or landing page, or submits a form.</div></blockquote>
</dd>
<dt>Supercookie</dt>
<dd><p class="first">From <a class="reference external" href="http://en.wikipedia.org/wiki/HTTP_cookie#Supercookie">Supercookie</a>:</p>
<blockquote>
<div><p>A “supercookie” is a cookie with an origin of a Top-Level Domain (such as .com) or a Public Suffix (such as .co.uk). It is important that supercookies are blocked by browsers, due to the security holes they introduce. If unblocked, an attacker in control of a malicious website could set a supercookie and potentially disrupt or impersonate legitimate user requests to another website that shares the same Top-Level Domain or Public Suffix as the malicious website. For example, a supercookie with an origin of .com, could maliciously affect a request made to example.com, even if the cookie did not originate from example.com. This can be used to fake logins or change user information.</p>
<p>The Public Suffix List is a cross-vendor initiative to provide an accurate list of domain name suffixes changing. Older versions of browsers may not have the most up-to-date list, and will therefore be vulnerable to supercookies from certain domains.</p>
<p>Supercookie (other uses)</p>
<p>The term “supercookie” is sometimes used for tracking technologies that do not rely on HTTP cookies. Two such “supercookie” mechanisms were found on Microsoft websites: cookie syncing that respawned MUID (Machine Unique IDentifier) cookies, and ETag cookies. Due to media attention, Microsoft later disabled this code.</p>
</div></blockquote>
<p class="last">Note: ETag (entity tag) is used for web cache validation and is stored by the browsers and returned when requesting the same resource. Tracking servers can return ETags and thus persist them on the browser. ETags should be flushed when the browser cache is cleared.</p>
</dd>
<dt>Zombie cookie</dt>
<dd>a cookie automatically recreated by client-side scripts from other storage (flash storage or HTML5 local storage).</dd>
</dl>
</div>
</div>
<div class="section" id="id2">
<h2>5.5.2. Microdata<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://html.spec.whatwg.org/multipage/microdata.html">WHATWG Microdata</a> and <a class="reference external" href="http://www.w3.org/TR/microdata/">W3C HTML Microdata</a> define HTML5’s microdata. For gentler introductions see <a class="reference external" href="http://diveintohtml5.info/extensibility.html">“Distributed,” “Extensibility,” &amp; Other Fancy Words</a> or <a class="reference external" href="http://html5doctor.com/microdata/">Extending HTML5 — Microdata</a>.</p>
<p>From <a class="reference external" href="https://en.wikipedia.org/wiki/Microdata_(HTML)">Microdata</a>:</p>
<blockquote>
<div>Microdata is a WHATWG HTML specification used to nest metadata within existing content on web pages. Search engines, web crawlers, and browsers can extract and process Microdata from a web page and use it to provide a richer browsing experience for users. Search engines benefit greatly from direct access to this structured data because it allows search engines to understand the information on web pages and provide more relevant results to users. Microdata uses a supporting vocabulary to describe an item and name-value pairs to assign values to its properties. Microdata is an attempt to provide a simpler[citation needed] way of annotating HTML elements with machine-readable tags than the similar approaches of using RDFa and microformats.</div></blockquote>
<p>From <a class="reference external" href="https://en.wikipedia.org/wiki/Microdata_(HTML)">Microdata</a>, here is a before-microdata &amp; after-microdata example of data using schema.org’s <a class="reference external" href="http://schema.org/Person">Person</a>:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">section</span><span class="p">&gt;</span> Hello, my name is John Doe, I am a graduate research assistant at
the University of Dreams.
My friends call me Johnny.
You can visit my homepage at <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;http://www.JohnnyD.com&quot;</span><span class="p">&gt;</span>www.JohnnyD.com<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.
I live at 1234 Peach Drive, Warner Robins, Georgia.<span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>With microdata it might be:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="hll"><span class="p">&lt;</span><span class="nt">section</span> <span class="na">itemscope</span> <span class="na">itemtype</span><span class="o">=</span><span class="s">&quot;http://schema.org/Person&quot;</span><span class="p">&gt;</span>
</span>        Hello, my name is
<span class="hll">        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="p">&gt;</span>John Doe<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>,
</span>        I am a
<span class="hll">        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;jobTitle&quot;</span><span class="p">&gt;</span>graduate research assistant<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span>        at the
<span class="hll">        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;affiliation&quot;</span><span class="p">&gt;</span>University of Dreams<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>.
</span>        My friends call me
<span class="hll">        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;additionalName&quot;</span><span class="p">&gt;</span>Johnny<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>.
</span>        You can visit my homepage at
<span class="hll">        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;http://www.JohnnyD.com&quot;</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;url&quot;</span><span class="p">&gt;</span>www.JohnnyD.com<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.
</span><span class="hll">        <span class="p">&lt;</span><span class="nt">section</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;address&quot;</span> <span class="na">itemscope</span> <span class="na">itemtype</span><span class="o">=</span><span class="s">&quot;http://schema.org/PostalAddress&quot;</span><span class="p">&gt;</span>
</span>                I live at
<span class="hll">                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;streetAddress&quot;</span><span class="p">&gt;</span>1234 Peach Drive<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>,
</span><span class="hll">                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;addressLocality&quot;</span><span class="p">&gt;</span>Warner Robins<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>,
</span><span class="hll">                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">itemprop</span><span class="o">=</span><span class="s">&quot;addressRegion&quot;</span><span class="p">&gt;</span>Georgia<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>.
</span><span class="hll">        <span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span><span class="hll"><span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></pre></div>
</div>
<p>Extracting the microdata provides:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Item</span>
   <span class="n">Type</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">schema</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">Person</span>
   <span class="n">name</span> <span class="o">=</span> <span class="n">John</span> <span class="n">Doe</span>
   <span class="n">jobTitle</span> <span class="o">=</span> <span class="n">graduate</span> <span class="n">research</span> <span class="n">assistant</span>
   <span class="n">affiliation</span> <span class="o">=</span> <span class="n">University</span> <span class="n">of</span> <span class="n">Dreams</span>
   <span class="n">additionalName</span> <span class="o">=</span> <span class="n">Johnny</span>
   <span class="n">url</span> <span class="o">=</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">johnnyd</span><span class="o">.</span><span class="n">com</span><span class="o">/</span>
   <span class="n">address</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Item</span> <span class="mi">1</span>
   <span class="n">Type</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">schema</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">PostalAddress</span>
   <span class="n">streetAddress</span> <span class="o">=</span> <span class="mi">1234</span> <span class="n">Peach</span> <span class="n">Drive</span>
   <span class="n">addressLocality</span> <span class="o">=</span> <span class="n">Warner</span> <span class="n">Robins</span>
   <span class="n">addressRegion</span> <span class="o">=</span> <span class="n">Georgia</span>
</pre></div>
</div>
<p>By choosing schemas from <a class="reference external" href="http://schema.org/">schema.org</a> we take advantage of:</p>
<blockquote>
<div>This site provides a collection of schemas that webmasters can use to markup HTML pages in ways recognized by major search providers, and that can also be used for structured data interoperability (e.g. in JSON). Search engines including Bing, Google, Yahoo! and Yandex rely on this markup to improve the display of search results, making it easier for people to find the right Web pages.</div></blockquote>
<p>See <a class="reference external" href="http://schema.org/docs/gs.html">Getting started with schema.org using Microdata</a>.</p>
</div>
<div class="section" id="id3">
<h2>5.5.3. Web Storage<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>The closest to cookies is <a class="reference external" href="http://en.wikipedia.org/wiki/Web_storage">Web storage</a>, which was originally part of the HTML5 spec but now has it’s own <a class="reference external" href="http://www.w3.org/TR/webstorage/">W3C Web Storage</a> recommendation. The <a class="reference external" href="https://html.spec.whatwg.org/multipage/webstorage.html#webstorage">WHATWG Web storage</a> is a good introduction, as is <a class="reference external" href="http://diveintohtml5.info/storage.html">The Past, Present &amp; Future of Local Storage for Web Applications</a>.</p>
<p>Web storage is a hash of (string key, string value) pairs separated into localStorage (which persists and is available across multiple tabs) and sessionStorage (with a lifetime of the tab or window). Additionally, storage events can trigger callbacks to event listeners which can react to storage changes.</p>
<p>Each top-level browsing context has a unique set of session storage areas, one for each origin. The localStorage object provides a Storage object for an origin. Thus, web storage is protected by the same origin policy.</p>
<p>To see if the browser supports localStorage:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">supports_html5_storage</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;localStorage&#39;</span> <span class="k">in</span> <span class="nb">window</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">[</span><span class="s1">&#39;localStorage&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Or you can use the <a class="reference external" href="http://modernizr.com/">Modernizr</a> or <a class="reference external" href="http://www.jstorage.info/">jStorage - store data locally with JavaScript</a> libraries.</p>
<p>The localStorage interface is very simple:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">clear</span><span class="p">()</span>
<span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
<span class="nx">localStorage</span><span class="p">.</span><span class="nx">key</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
<span class="nx">localStorage</span><span class="p">.</span><span class="nx">length</span><span class="p">()</span>
</pre></div>
</div>
<p>A storage event listener can be added via:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;storage&quot;</span><span class="p">,</span> <span class="nx">handle_storage</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;onstorage&quot;</span><span class="p">,</span> <span class="nx">handle_storage</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The event can be coded like:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">handle_storage</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">e</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">event</span><span class="p">;</span> <span class="p">}</span>
  <span class="c1">// process the event</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The returned StorageEvent object has the key, oldvalue, newvalue, and url of the page that triggered the change.</p>
<p>localStorage has a default 5 MB per origin limit which can be disabled by a user or administrator. It works offline, can hook into browser events, has less overhead than cookies, with more space than cookies. Developers control when or if the data are sent to the server. The data doesn’t expire and might not be deleted when history is cleared.</p>
<p><a class="reference external" href="http://www.w3.org/TR/webstorage/#privacy">W3C Web Storage 6 Privacy</a> contains some optional suggestions for improving privacy.</p>
</div>
<div class="section" id="web-sql">
<h2>5.5.4. Web SQL<a class="headerlink" href="#web-sql" title="Permalink to this headline">¶</a></h2>
<p>From <a class="reference external" href="http://en.wikipedia.org/wiki/Web_SQL_Database">Web SQL Database</a>:</p>
<blockquote>
<div><p>The W3C Web Applications Working Group ceased working on the specification in November 2010, citing a lack of independent implementations (i.e., the use of a database system other than SQLite as the backend) as the reason the specification could not move forward to become a W3C Recommendation.</p>
<p>One potential alternative storage standard is IndexedDB.</p>
</div></blockquote>
</div>
<div class="section" id="indexeddb">
<h2>5.5.5. IndexedDB<a class="headerlink" href="#indexeddb" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.w3.org/TR/IndexedDB/">W3C Indexed Database API</a> is not part of HTML5 but is a separate W3C recommendation. From <a class="reference external" href="http://en.wikipedia.org/wiki/Indexed_Database_API">Wikipedia Indexed Database API</a>:</p>
<blockquote>
<div><p>The Indexed Database API, or IndexedDB (formerly WebSimpleDB), is a proposed web browser standard interface for a local database of records holding simple values and hierarchical objects. IndexedDB was initially proposed by Oracle in 2009.</p>
<p>IndexedDB could be used for browser implemented functions, such as bookmarks, as well as web applications, such as email. An open-source reference implementation of the Indexed Database API exists for testing and experimentation purposes.</p>
</div></blockquote>
<p>For an example of IndexedDB see <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB">Using IndexedDB</a> (with <a class="reference external" href="https://mdn.mozillademos.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB$samples/Full_IndexedDB_example?revision=723661">IndexedDB Demo: storing blobs, e-publication example</a>). Or if you like reference-like documentation, consult <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API">IndexedDB</a>.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="html_security.html" class="btn btn-neutral float-right" title="5.6. HTML security" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="scripting.html" class="btn btn-neutral" title="5.4. Scripting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>