

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="default-src 'none'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; form-action 'self'; frame-ancestors 'none'; base-uri 'self'" http-equiv="Content-Security-Policy" />
<meta content="nosniff" http-equiv="X-Content-Type-Options" />
<meta content="deny" http-equiv="X-Frame-Options" />
<meta content="1; mode=block" http-equiv="X-XSS-Protection" />
<meta content="strict-origin" http-equiv="Referrer-Policy" />
<meta content="max-age=31536000; includeSubDomains" http-equiv="Strict-Transport-Security" />
<meta content="'*'" http-equiv="Access-Control-Allow-Origin" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.8. HTML exploits &mdash; South Bay WASP 1.0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.9. HSTS Tutorial" href="hsts.html" />
    <link rel="prev" title="5.7. HTML Web Messaging" href="messaging.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> South Bay WASP
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pentest_intro.html">1. South Bay WASP Meetup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_kali.html">2. Kali Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_challenges.html">3. Pentest Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_encryption.html">4. Encryption</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pentest_html.html">5. HTML</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="standards.html">5.1. HTML Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="http.html">5.2. HTTP(S) vs HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="parsing.html">5.3. Parsing &amp; Rendering HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripting.html">5.4. Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">5.5. Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="html_security.html">5.6. HTML security</a></li>
<li class="toctree-l2"><a class="reference internal" href="messaging.html">5.7. HTML Web Messaging</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.8. HTML exploits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id21">5.8.1. Clickjacking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#csrf">5.8.2. CSRF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xss">5.8.3. XSS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#session-hijacking-attack">5.8.4. Session hijacking attack</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hsts.html">5.9. HSTS Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="xss.html">5.10. XSS Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_network_tools.html">6. Pentest Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_recon.html">7. Pentest Reconnaisance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_study.html">8. Pentest Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_buffer_overflow.html">9. Pentest Buffer Overflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_scripting.html">10. Pentest scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pentest_presentations.html">11. Pentest Presentations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">South Bay WASP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../pentest_html.html">5. HTML</a> &raquo;</li>
        
      <li>5.8. HTML exploits</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/html/html_exploits.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="html-exploits">
<h1>5.8. HTML exploits<a class="headerlink" href="#html-exploits" title="Permalink to this headline">¶</a></h1>
<p>Perhaps the biggest threat from stealing cookies is due to the fact that cookies are involved in authentication and authorization. Getting access to such cookies allows accessing web resources as that user.</p>
<div class="section" id="id21">
<h2>5.8.1. Clickjacking<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<p>From <a class="reference external" href="https://en.wikipedia.org/wiki/Clickjacking">Clickjacking</a>:</p>
<blockquote>
<div>A clickjacked page tricks a user into performing undesired actions by clicking on a concealed link. On a clickjacked page, the attackers load another page over it in a transparent layer. The users think that they are clicking visible buttons, while they are actually performing actions on the hidden page. The hidden page may be an authentic page; therefore, the attackers can trick users into performing actions which the users never intended. There is no way of tracing such actions to the attackers later, as the users would have been genuinely authenticated on the hidden page.</div></blockquote>
<p>For prevention, see <cite>OWASP Clickjacking Defense Cheat Sheet</cite> and <a class="reference external" href="https://en.wikipedia.org/wiki/Clickjacking#Prevention">Clickjacking prevention</a>.</p>
<p>Note that the server side the <code class="docutils literal notranslate"><span class="pre">X-Frame-Options</span></code> is deprecated in favor of <a class="reference internal" href="html_security.html#id25"><span class="std std-ref">Content Security Policy</span></a>. From <a class="reference external" href="https://en.wikipedia.org/wiki/Clickjacking">Clickjacking</a>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Disallow embedding. All iframes etc. will be blank, or contain a browser specific error page.
Content-Security-Policy: frame-ancestors &#39;none&#39;

# Allow embedding of [[same-origin policy|own content]] only.
Content-Security-Policy: frame-ancestors &#39;self&#39;

# Allow specific origins to embed this content
Content-Security-Policy: frame-ancestors example.com wikipedia.org
</pre></div>
</div>
</div>
<div class="section" id="csrf">
<h2>5.8.2. CSRF<a class="headerlink" href="#csrf" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross-site request forgery</a> involves two sites: the attacking site has a link or script to a victim site where the user already has been authenticated and/or authorized. From Wikipedia, suppose Alice is already logged into bank.example.com, then visits a chat site with the following posting.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>Mallory: Hello Alice! Look here:

<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;http://bank.example.com/withdraw?account=Alice&amp;amount=1000000&amp;for=Mallory&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Note the use of the &lt;img&gt; tag which is often allowed in Internet forums while JavaScript is not allowed. Depending on the configuration of bank.example.com and the browser, if Alice were to click on the “image” her cookies might be used to authenticate the bank transaction.</p>
<p>Another old &amp; real example is <a class="reference external" href="https://www.youtube.com/watch?v=h6Y0LXsQ8V8">Google YouTube crossdomain security flaw</a>. Although the video is a “little” fuzzy, the video starts with 4 browser tabs: (1) google.com not logged in, (2) youtube.com logged into the victim’s account, (3) youtube’s cross-domain policy showing google.com is allowed, and (4) the attackers site with a link to a SWF file on google.com. When the user clicks on the attackers site to run the video, the user is logged into google.com using the attacker’s credentials, runs the video from google.com, the SWF code connects to youtube.com and by policy is allowed to use the victim’s credentials. The victim’s user id and youtube viewing history are displayed. Finally, the first tab at google.com is refreshed to show that the user was logged in using the attacker’s credentials.</p>
<p>The above example illustrates <em>login CSRF</em>, where an attacker can login the victim to some sites using the attacker’s credentials. Later the attacker can login that same site using their credentials to view the victim’s activities.</p>
<p>For more CSRF attack examples see <a class="reference external" href="https://www.youtube.com/watch?v=5Np8PrSctuM">DEFCON 17: CSRF: Yeah, It Still Works</a>.</p>
<p>See <a class="reference external" href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">OWASP Cross-Site Request Forgery (CSRF) Prevention Cheat Sheet</a> for CSRF prevention.</p>
</div>
<div class="section" id="xss">
<h2>5.8.3. XSS<a class="headerlink" href="#xss" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_scripting">Cross-site scripting</a> is a large topic covered more in greater depth in <a class="reference internal" href="xss.html#xss-tutorial"><span class="std std-ref">XSS Tutorial</span></a>. For prevention see <a class="reference external" href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet</a> (which also recommends using <a class="reference external" href="http://en.wikipedia.org/wiki/Content_Security_Policy">Content Security Policy</a>.</p>
</div>
<div class="section" id="session-hijacking-attack">
<h2>5.8.4. Session hijacking attack<a class="headerlink" href="#session-hijacking-attack" title="Permalink to this headline">¶</a></h2>
<p>From <a class="reference external" href="https://www.owasp.org/index.php/Session_hijacking_attack">Session hijacking attack</a>:</p>
<blockquote>
<div><p>The Session Hijacking attack consists of the exploitation of the web session control mechanism, which is normally managed for a session token.</p>
<p>Because http communication uses many different TCP connections, the web server needs a method to recognize every user’s connections. The most useful method depends on a token that the Web Server sends to the client browser after a successful client authentication. A session token is normally composed of a string of variable width and it could be used in different ways, like in the URL, in the header of the http requisition as a cookie, in other parts of the header of the http request, or yet in the body of the http requisition.</p>
<p>The Session Hijacking attack compromises the session token by stealing or predicting a valid session token to gain unauthorized access to the Web Server.</p>
<p>The session token could be compromised in different ways; the most common are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Predictable</span> <span class="n">session</span> <span class="n">token</span><span class="p">;</span>
<span class="n">Session</span> <span class="n">Sniffing</span><span class="p">;</span>
<span class="n">Client</span><span class="o">-</span><span class="n">side</span> <span class="n">attacks</span> <span class="p">(</span><span class="n">XSS</span><span class="p">,</span> <span class="n">malicious</span> <span class="n">JavaScript</span> <span class="n">Codes</span><span class="p">,</span> <span class="n">Trojans</span><span class="p">,</span> <span class="n">etc</span><span class="p">);</span>
<span class="n">Man</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">middle</span> <span class="n">attack</span>
<span class="n">Man</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">browser</span> <span class="n">attack</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hsts.html" class="btn btn-neutral float-right" title="5.9. HSTS Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="messaging.html" class="btn btn-neutral" title="5.7. HTML Web Messaging" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, bitbender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>